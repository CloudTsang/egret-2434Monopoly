var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},__extends=function(e,t){function n(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;r>n;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},__rest=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},__decorate=function(e,t,n,r){var i,a=arguments.length,o=3>a?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(3>a?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},__param=function(e,t){return function(n,r){t(n,r,e)}},__metadata=function(e,t){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(e,t):void 0},__awaiter=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r["throw"](e))}catch(t){a(t)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},__generator=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a["return"]:n[0]?a["throw"]||((o=a["return"])&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(r){n=[6,r],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},__exportStar=function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||__createBinding(t,e,n)},__createBinding=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},__values=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-->0)&&!(r=a.next()).done;)o.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=a["return"])&&n.call(a)}finally{if(i)throw i.error}}return o},__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e},__spreadArrays=function(){for(var e=0,t=0,n=arguments.length;n>t;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;n>t;t++)for(var a=arguments[t],o=0,s=a.length;s>o;o++,i++)r[i]=a[o];return r},__await=function(e){return this instanceof __await?(this.v=e,this):new __await(e)},__asyncGenerator=function(e,t,n){function r(e){h[e]&&(l[e]=function(t){return new Promise(function(n,r){u.push([e,t,n,r])>1||i(e,t)})})}function i(e,t){try{a(h[e](t))}catch(n){c(u[0][3],n)}}function a(e){e.value instanceof __await?Promise.resolve(e.value.v).then(o,s):c(u[0][2],e)}function o(e){i("next",e)}function s(e){i("throw",e)}function c(e,t){e(t),u.shift(),u.length&&i(u[0][0],u[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l,h=n.apply(e,t||[]),u=[];return l={},r("next"),r("throw"),r("return"),l[Symbol.asyncIterator]=function(){return this},l},__asyncDelegator=function(e){function t(t,i){n[t]=e[t]?function(n){return(r=!r)?{value:__await(e[t](n)),done:"return"===t}:i?i(n):n}:i}var n,r;return n={},t("next"),t("throw",function(e){throw e}),t("return"),n[Symbol.iterator]=function(){return this},n},__asyncValues=function(e){function t(t){r[t]=e[t]&&function(r){return new Promise(function(i,a){r=e[t](r),n(i,a,r.done,r.value)})}}function n(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),r={},t("next"),t("throw"),t("return"),r[Symbol.asyncIterator]=function(){return this},r)},__makeTemplateObject=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__setModuleDefault=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t},__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&__createBinding(t,e,n);return __setModuleDefault(t,e),t},__importDefault=function(e){return e&&e.__esModule?e:{"default":e}},__classPrivateFieldGet=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},__reflect=function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n};!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(t){return e[t]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){n(1),n(2),n(3),n(4),n(0),n(5),n(6),n(7),n(8),n(9),n(10),n(11),n(12),n(13),n(14),n(15),n(16),n(17),n(18),n(19),n(20),n(21),n(22),n(23),n(24),n(25),n(26),n(27),n(28),n(29),n(30),n(31),n(32),n(33),n(34),n(35),n(36),n(37),n(38),n(39),n(40),n(41),n(42),n(43),n(44),n(45),n(46),n(47),n(48),n(49),n(50),n(51),n(52),n(53),n(54),n(55),n(56),n(57),n(58),n(59),n(60),n(61),n(62),n(63),n(64),n(65),n(66),n(67),n(68),n(69),n(70),n(71),n(72),n(73),n(74),n(75),n(76),n(77),n(78),n(79),n(80),n(81),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(89),n(90),n(91),n(92),n(93),n(94),n(95),n(96),n(97),n(98),n(99),n(100),n(101),n(102),n(103),n(104),n(105),n(106),n(107),n(108),n(109),n(110),n(111),n(112),n(113),n(114),n(115),n(116),n(117),n(118),n(119),n(120),n(121),n(122),n(123),n(124),n(125),n(126),n(127),n(128),n(129),n(130),n(131),n(132),n(133),n(134),n(135),n(136),n(137),n(138),n(139),n(140),n(141),n(142),n(143),n(144),n(145),n(146),n(147),n(148),n(149),n(150),n(151),n(152),n(153),n(154),n(155),n(156),n(157),n(158),n(159),n(160),n(161);var r=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){}}),LifecycleCallback.addFunc("ticker",function(){egret.ticker.pause()},function(){egret.ticker.resume()});var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return[4,this.loadResource()];case 1:return n.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=n.sent(),[4,platform.login()];case 3:return n.sent(),[4,platform.getUserInfo()];case 4:return t=n.sent(),console.log(t),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,this.loadTheme()];case 2:return n.sent(),[4,RES.loadGroup("preload",0,e)];case 3:return n.sent(),this.stage.removeChild(e),[3,5];case 4:return t=n.sent(),console.error(t),[3,5];case 5:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var r=new eui.Theme("resource/default.thm.json",e.stage);r.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){LifecycleCallback.regist(),WorldData.STAGE_W=this.stage.stageWidth,WorldData.STAGE_H=this.stage.stageHeight;var e=new egret.Shape;e.graphics.beginFill(12303291),e.graphics.drawRect(0,0,WorldData.STAGE_W,WorldData.STAGE_H),e.graphics.endFill(),this.addChild(e),this.toTitle(null)},t.prototype.toTitle=function(e){SoundManager.instance.stop(),this.currentScene&&this.removeChild(this.currentScene);var t=new TitlePage;t.width=WorldData.STAGE_W,t.height=WorldData.STAGE_H,this.currentScene=t,this.addChild(t),t.once(GameEvents.TO_PLAYER_SELECT,this.toPlayerSelect,this)},t.prototype.toPlayerSelect=function(e){this.removeChild(this.currentScene);var t=new StartSelectPanel;t.width=WorldData.STAGE_W,t.height=WorldData.STAGE_H,t.once(GameEvents.GAME_START,this.toWorld,this),this.currentScene=t,this.addChild(t)},t.prototype.toWorld=function(e){this.currentScene&&this.removeChild(this.currentScene);var t=e.data.livers;e.data.turn;if(t){var n=new WorldController(this.stage);n.initMap(),n.initPlayer(t),n.initUI(),n.once(GameEvents.GAME_FINISH,this.toScore,this),this.world=n}},t.prototype.toScore=function(e){this.world&&this.world.dispose();var t=new ScorePanel(e.data.score);this.currentScene=t,this.addChild(t),t.once(GameEvents.BACK2TITLE,this.toTitle,this)},t}(egret.DisplayObjectContainer);window.Main=r,__reflect(r.prototype,"Main",[])},function(e,t){var n=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function r(r){t.call(n,r,e)}if(RES.hasRes(e)){var i=RES.getRes(e);i?r(i):RES.getResAsync(e,r,this)}else RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_IMAGE)},e}();window.AssetAdapter=n,__reflect(n.prototype,"AssetAdapter",["eui.IAssetAdapter"])},function(e,t){var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(egret.EventDispatcher);window.BaseObj=n,__reflect(n.prototype,"BaseObj",[])},function(e,t){var n=function(){function e(){}return e.TO_PLAYER_SELECT="TO_PLAYER_SELECT",e.GAME_START="GAME_START",e.GAME_FINISH="GAME_FINISH",e.BACK2TITLE="BACK2TITLE",e.VR_SWITCH="VR_SWITCH",e.START_ROLL="START_ROLL",e.ACTION_CONFIRM="ACTION_CONFIRM",e.SHOW_LIVER_DETAIL="SHOW_LIVER_DETAIL",e.SHOW_NETA_BAG="SHOW_NETA_BAG",e.FOCUS2LIVER="FOCUS2LIVER",e.PLAYER_READY="PLAYER_READY",e.GAME="GAME",e.SING="SING",e.STUDY="STUDY",e.WORK="WORK",e.HANGOUT="HANGOUT",e.REST="REST",e.GAME_STREAM="GAME_STREAM",e.SING_STREAM="SING_STREAM",e.TALK_STREAM="TALK_STREAM",e.PRESENT_STREAM="PRESENT_STREAM",e.STREAM_PREPARE="STREAM_PREPARE",e.STREAM_START="STREAM_START",e.STREAM_END="STREAM_END",e.WATCH="WATCH",e.MENU_CANCEL="MENU_CANCEL",e.STAT_CHANGE="STAT_CHANGE",e.SKILL_TRIGGERED="SKILL_TRIGGERED",e.EVENT_START="EVENT_START",e.EVENT_FINISH="EVENT_FINISH",e.NETA_INFO_FINISH="NETA_INFO_FINISH",e.NETA_CONFIRM="NETA_CONFIRM",e.DEVICE_FINISH="DEVICE_FINISH",e.PLAYER_SELECTED="PLAYER_SELECTED",e.PLAYER_SELECT_CANCEL="PLAYER_SELECT_CANCEL",e.STREAM_ENJO="STREAM_ENJO",e.STREAM_ACCIDENT="STREAM_ACCIDENT",e}();window.GameEvents=n,__reflect(n.prototype,"GameEvents",[]);var r=function(){function e(){}return e.TURN_START="TURN_START",e.TURN_END="TURN_END",e.DICE_ROLL="DICE_ROLL",e.USE_ITEM="USE_ITEM",e.GET_NETA="GET_NETA",e.BEFORE_SELECT="BEFORE_SELECT",e.AFTER_SELECT="AFTER_SELECT",e.BEFORE_ACTION="BEFORE_ACTION",e.IN_ACTION="IN_ACTION",e.AFTER_ACTION="AFTER_ACTION",e.BEFORE_STREAM="BEFORE_STREAM",e.IN_STREAM="IN_STREAM",e.USE_NETA="USE_NETA",e.IN_STREAM_COLLABO="IN_STREAM_COLLABO",e.IN_STREAM_SOLO="IN_STREAM_SOLO",e.AFTER_STREAM="AFTER_STREAM",e.STREAM_ACCIDENT="STREAM_ACCIDENT",e.STREAM_ENJO="STREAM_ENJO",e.NPC_UP="NPC_UP",e.NPC_DOWN="NPC_DOWN",e.GO_SHOPPING="GO_SHOPPING",e.ROLL_RESULT="ROLL_RESULT",e}();window.GamePhrase=r,__reflect(r.prototype,"GamePhrase",[]);var i=function(){function e(){}return e.GET_NETA="GET_NETA",e.LOSE_NETA="LOSE_NETA",e.GET_BUFF="GET_BUFF",e.REMOVE_BUFF="REMOVE_BUFF",e.STAT_CHANGE="STAT_CHANGE",e.TEMP_STAT_CHANGE="TEMP_STAT_CHANGE",e.SHOW_MENU="SHOW_MENU",e.SHOW_LOG="SHOW_LOG",e.SUBS_TRAN="SUBS_TRAN",e.PLAY_BGS="PLAY_BGS",e}();window.EffectType=i,__reflect(i.prototype,"EffectType",[]);var a;!function(e){e[e.NORMAL=0]="NORMAL",e[e.FIRE=1]="FIRE",e[e.BAN=2]="BAN"}(a||(a={})),window.LiverStat=a;var o;!function(e){e[e.TALK=0]="TALK",e[e.GAME=1]="GAME",e[e.SONG=2]="SONG",e[e.SPEC=3]="SPEC",e[e.PRESENT=4]="PRESENT",e[e.DEVICE=5]="DEVICE"}(o||(o={})),window.NetaType=o;var s;!function(e){e[e.STREAM=0]="STREAM",e[e.SHOP=1]="SHOP",e[e.SHOP2=2]="SHOP2",e[e.NORMAL=3]="NORMAL"}(s||(s={})),window.PanelType=s;var c=function(){function e(){}return e.POSITIVE="POSITIVE",e.NEGATIVE="NEGATIVE",e.HIDDEN="HIDDEN",e}();window.SkillType=c,__reflect(c.prototype,"SkillType",[]);var l=function(){function e(){}return e.BIG_SUCCESS="BIG_SUCCESS",e.SUCCESS="SUCCESS",e.NORMAL="NORMAL",e.FAIL="FAIL",e.BIG_FAIL="BIG_FAIL",e}();window.RollResult=l,__reflect(l.prototype,"RollResult",[]);var h=function(){function e(){}return e.SING="SING",e.GAME="GAME",e.TALK="TALK",e.PRESENT="PRESENT",e}();window.StreamType=h,__reflect(h.prototype,"StreamType",[]);var u=function(){function e(){}return e.SELF="SELF",e.SELF_ROLL="SELF_ROLL",e.ALL="ALL",e.SELECT_ONE="SELECT_ONE",e.ALL_SELECT_ONE="ALL_SELECT_ONE",e.OTHER_ALL="OTHER_ALL",e.RANDOM_ONE="RANDOM_ONE",e.OTHER_RANDOM_ONE="OTHER_RANDOM_ONE",e.SELECT_ONE_NPC="SELECT_ONE_NPC",e.RANDOM_ONE_NPC="RANDOM_ONE_NPC",e.ALL_NPC="ALL_NPC",e}();window.EffectTarget=u,__reflect(u.prototype,"EffectTarget",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){var n=Math.floor(e/t*100);this.textField.text="Loading..."+n+"%"},t}(egret.Sprite);window.LoadingUI=n,__reflect(n.prototype,"LoadingUI",["RES.PromiseTaskReporter"])},function(e,t){var n=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();window.DebugPlatform=n,__reflect(n.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new n)},function(e,t){var n=function(){function e(){}return e.prototype.getTheme=function(e,t,n,r){function i(e){t.call(r,e)}function a(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),n.call(r))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){t.call(r,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(e,n){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(r,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(e.indexOf(".exml")>-1){var s=e.replace(".exml","_EUI.json");generateJSON.paths[e]?egret.callLater(function(){t.call(r,generateJSON.paths[e])},this):RES.getResByUrl(s,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){t.call(r,generateJSON.paths[e])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){t.call(r,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,a,null),RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_TEXT)},e}();window.ThemeAdapter=n,__reflect(n.prototype,"ThemeAdapter",["eui.IThemeAdapter"])},function(e,t){var n=function(){function e(e,t){if(void 0===e&&(e=null),void 0===t&&(t=!1),this.allLock=!1,this._money=0,this.moneyLock=!1,this._strength=0,this.strengthLock=!1,this._luck=0,this.luckLock=!1,this._sense=0,this.senseLock=!1,this._commu=0,this.commuLock=!1,this._game=0,this.gameLock=!1,this._sing=0,this.singLock=!1,this._talk=0,this.talkLock=!1,this._tech=0,this.techLock=!1,this._minusLock=t,e)for(var n in e)this[n]=e[n]}return Object.defineProperty(e.prototype,"commu",{get:function(){return this._commu},set:function(e){0>e&&this._minusLock||this.commuLock||this.allLock||(this._commu=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"game",{get:function(){return this._game},set:function(e){0>e&&this._minusLock||this.gameLock||this.allLock||(this._game=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"luck",{get:function(){return this._luck},set:function(e){0>e&&this._minusLock||this.luckLock||this.allLock||(this._luck=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"money",{get:function(){return this._money},set:function(e){0>e&&(e=0),this.moneyLock||this.allLock||(this._money=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sense",{get:function(){return this._sense},set:function(e){0>e&&this._minusLock||this.senseLock||this.allLock||(this._sense=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sing",{get:function(){return this._sing},set:function(e){0>e&&this._minusLock||this.singLock||this.allLock||(this._sing=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"strength",{get:function(){return this._strength},set:function(e){0>e&&this._minusLock||this.strengthLock||this.allLock||(this._strength=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"talk",{get:function(){return this._talk},set:function(e){0>e&&this._minusLock||this.talkLock||this.allLock||(this._talk=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tech",{get:function(){return this._tech},set:function(e){0>e&&this._minusLock||this.techLock||this.allLock||(this._tech=e)},enumerable:!1,configurable:!0}),e}();window.CData=n,__reflect(n.prototype,"CData",[])},function(e,t){var n=function(){function e(){this.devil=0,this.has3_0=!1,this.has3D=!1,this.major=!1,this.aegis13=0,this.hasAegis13=!1,this.xb2=0,this.hasXB2Ch78=!1}return e.prototype.checkHasNewNeta=function(){return this.aegis13>=2&&!this.hasAegis13?"aegis13":this.xb2>=2&&!this.hasXB2Ch78?"xb2":null},e}();window.EventData=n,__reflect(n.prototype,"EventData",[])},function(e,t){var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.init=function(e){var n=RES.getRes("alllivers_json");n=n.filter(function(t){return e.indexOf(t.ID)<0}),t.allLivers=n},t}(BaseObj);window.Liver=n,__reflect(n.prototype,"Liver",[])},function(e,t){var n=function(e){function t(t,n){var r=e.call(this)||this;r.index=n,r.ID=t.id,r.name=t.name,r.data=new CData(t.data,!0),r.ddata=new CData,r.edata=new EventData,r.iconUrl=t.iconUrl,r.dispObj=new Chess(t.chessV,t.chessR),r.npc=new NpcFavour,r._current=!0;for(var i=[],a=0,o=t.skill;a<o.length;a++){var s=o[a],c=Skill;s["class"]&&(c=egret.getDefinitionByName(s["class"]),c||(c=Skill));var l=new c(r,s);l.addEventListener(GameEvents.STAT_CHANGE,r.onSkillTriggered,r),i.push(l)}return r.skills=i,r.subscribe=0,r.increase=0,r._anti=0,r.income=5e4,r.stream=[],r.buffs=[],r.netaBag=new NetaBag(r),r.antiLock=!1,r}return __extends(t,e),t.prototype.testPlay=function(){this.netaBag.test()},t.prototype.checkIfSkillsTriggered=function(e,t,n){void 0===t&&(t=0);for(var r=new SkillsTrigger,i=this.skills,a=0;a<i.length;a++){var o=i[a],s=n?n():t;o.shouldTrigger(e,s)&&r.add(o)}return r},t.prototype.onSkillTriggered=function(e){this.dispatchEvent(e)},t.prototype.getBuff=function(e){("Stop"==e.ID||"Sleep"==e.ID)&&this.dispatchEvent(new SkipEvent);for(var t=0,n=this.buffs;t<n.length;t++){var r=n[t];if(r.name==e.name)return void r.add(e)}this.buffs.push(e),e.on()},t.prototype.removeBuff=function(e){for(var t=this.buffs,n=0;n<t.length;n++){var r=t[n];if(r.ID==e)return r.off(),void t.splice(n,1)}},t.prototype.checkStepNum=function(){for(var e=0,t=this.buffs;e<t.length;e++){var n=t[e];if("Lunpapa"==n.ID)return 1}return 0},t.prototype.onTurnStart=function(){var e=this;this.ddata=new CData;var t=!0,n=this.increase-this._anti;0>n&&(n=0);var r=this.checkIfSkillsTriggered(GamePhrase.TURN_START,Roll.random3());r.trigger();for(var i=0,a=this.skills;i<a.length;i++){var o=a[i];o.cd()}for(var s=0;s<this.buffs.length;){var c=this.buffs[s];c.time[0]>=1&&(("Stop"==c.ID||"Sleep"==c.ID)&&(t=!1),"Enjo"==c.ID&&(n=Math.min(0,this.increase-this._anti))),c.turnCD(),c.overed?this.buffs.splice(s,1):(c.on(),s++)}for(var l=0,h=this.netaBag.song;l<h.length;l++){var u=h[l];u.onCD()}this.netaBag.checkDeviceChange(),this.subscribe+=n;var p=new egret.Event(GameEvents.PLAYER_READY);p.data={moveable:t};var d;if(this.subscribe>=1e5&&!this.edata.has3D){this.edata.has3D=!0;var f=NetaFactory.getPresentNeta("3D披露");this.netaBag.modifyNeta(f,"get"),d=NetaGetPanel.addNetaToShow(f)}var v=this.edata.checkHasNewNeta();if(v){var m=NetaFactory.getEvtNeta(v);m&&(this.netaBag.modifyNeta(m,"get"),d=NetaGetPanel.addNetaToShow(m))}var _=this.npc.checkHasGift();if(_){var g=NetaFactory.getGiftNeta(_);g&&(this.npc.getGift(_),this.netaBag.modifyNeta(g,"get"),d=NetaGetPanel.addNetaToShow(g))}d?(this.dispatchEvent(new ShowEvent(d,"top")),d.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,function(t){e.dispatchEvent(p)},this)):this.dispatchEvent(p)},t.prototype.onTurnEnd=function(){},t.prototype.setMode=function(e){return this.dispObj.lock?!1:(this._current=e,this.dispObj.setMode(this._current,!0),!0)},Object.defineProperty(t.prototype,"currentMode",{get:function(){return this._current},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"game",{get:function(){var e=this.data.game+this.ddata.game;return 0>=e?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"commu",{get:function(){var e=this.data.commu+this.ddata.commu;return 0>=e?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"luck",{get:function(){var e=this.data.luck+this.ddata.luck;return 0>=e?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sense",{get:function(){var e=this.data.sense+this.ddata.sense;return 0>=e?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sing",{get:function(){var e=this.data.sing+this.ddata.sing;return 0>=e?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strength",{get:function(){var e=this.data.strength+this.ddata.strength;return e>10?e=10:0>=e&&(e=0),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"talk",{get:function(){var e=this.data.talk+this.ddata.talk;return 0>=e?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tech",{get:function(){var e=this.data.tech+this.ddata.tech;return 0>=e?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"money",{get:function(){return this.data.money},set:function(e){this.data.money=e,this.dispatchEvent(new MoneyEvent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"subscribe",{get:function(){return this._subscribe},set:function(e){0>e&&(e=0),this._subscribe=e,this.dispatchEvent(new SubscribeEvent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anti",{get:function(){return this._anti},set:function(e){this.antiLock&&e>this._anti||(0>e&&(e=0),console.log(this.name+" 的anti变化至 "+e),this._anti=e)},enumerable:!1,configurable:!0}),t}(Liver);window.MainCharacter=n,__reflect(n.prototype,"MainCharacter",[])},function(e,t){var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(egret.EventDispatcher);window.Reality=n,__reflect(n.prototype,"Reality",[])},function(e,t){var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(egret.EventDispatcher);window.Virutal=n,__reflect(n.prototype,"Virutal",[])},function(e,t){var n=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.data.niceClip=0,r}return __extends(t,e),t}(MainCharacter);window.Rion=n,__reflect(n.prototype,"Rion",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.fan=[1,1,1,1],t}return __extends(t,e),t}(Liver);window.Npc=n,__reflect(n.prototype,"Npc",[])},function(e,t){var n=function(){function e(){this.lock=!1,this.gift={},this.keyArr=[];for(var e=0,t=Liver.allLivers;e<t.length;e++){var n=t[e];this[n.ID]=1,this.keyArr.push(n.ID),this.gift[n.ID]=0}}return e.prototype.modify=function(e,t){var n=this[e];return this.lock||0/0==n||void 0==n||(n+=t,0>n&&(n=0)),this[e]=n,n},e.prototype.getF=function(e){return this[e]},Object.defineProperty(e.prototype,"IDs",{get:function(){return this.keyArr},enumerable:!1,configurable:!0}),e.prototype.getGift=function(e){this.gift[e]=1},e.prototype.checkHasGift=function(){for(var e=0,t=this.keyArr;e<t.length;e++){var n=t[e];if(0==this.gift[n]&&this[n]>=3)return n}return null},Object.defineProperty(e.prototype,"all",{get:function(){return 0},set:function(e){for(var t=0,n=this.keyArr;t<n.length;t++){var r=n[t],i=this[r],a=i+e;0>a&&(a=0),this[r]=a}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"random",{get:function(){return 0},set:function(e){var t=Math.floor(Math.random()*this.keyArr.length),n=this.keyArr[t],r=this[n],i=r+e;0>i&&(i=0),this[n]=i},enumerable:!1,configurable:!0}),e}();window.NpcFavour=n,__reflect(n.prototype,"NpcFavour",[])},function(e,t){},function(e,t){var n=function(e){function t(t,n,r){void 0===r&&(r=0);var i=e.call(this)||this;return i.width=t,i.height=n,i.alpha=0,i.graphics.beginFill(r),i.graphics.drawRect(0,0,t,n),i.graphics.endFill(),i}return __extends(t,e),t.prototype.fadeIn=function(e,t){return void 0===e&&(e=.6),void 0===t&&(t=500),egret.Tween.get(this).to({alpha:e},t)},t.prototype.fadeOut=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=500),e||(e=egret.Tween.get(this)),e.to({alpha:0},t)},t}(egret.Sprite);window.BlackBack=n,__reflect(n.prototype,"BlackBack",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this,n=new BlackBack(WorldData.STAGE_W,WorldData.STAGE_W),r=new CurseDoll;return r.x=WorldData.STAGE_W/2,r.y=WorldData.STAGE_H/2,t.blackBack=n,t.doll=r,t.addChild(n),t.addChild(r),t}return __extends(t,e),t.prototype.play=function(e,t,n){void 0===n&&(n=null);var r=this.doll,i=this.blackBack;SoundManager.instance.pause(),SoundManager.instance.playBgs("horror_mp3"),i.fadeIn();var a=r.fadeIn();a=e.index==t.index?a.wait(500):a.call(function(){WorldMap.focusToPlayer(t)}),a.wait(1e3),r.fadeOut(a).call(function(){i.fadeOut(),t.dispObj.showAttacked()}).wait(500).call(function(){WorldMap.focusToPlayer(e),SoundManager.instance.resume(),n&&n()})},t}(egret.Sprite);window.Curse=n,__reflect(n.prototype,"Curse",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this,n=new egret.Bitmap;return n.texture=RES.getRes("icons_json#curseidol"),n.x=-n.width/2,n.y=-n.height/2,t.addChild(n),t.alpha=0,t}return __extends(t,e),t.prototype.fadeIn=function(e){return void 0===e&&(e=500),this.oriY=this.y,egret.Tween.get(this).to({y:this.oriY-this.height,alpha:1},e)},t.prototype.fadeOut=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=200),e||(e=egret.Tween.get(this)),e.to({y:this.oriY,alpha:0},t)},t}(egret.Sprite);window.CurseDoll=n,__reflect(n.prototype,"CurseDoll",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this)||this;n._w=t/2;var r=new particle.GravityParticleSystem(RES.getRes("firep1_png"),n.mountData(RES.getRes("firep1_json"))),i=new particle.GravityParticleSystem(RES.getRes("firep2_png"),n.mountData(RES.getRes("firep2_json"))),a=new particle.GravityParticleSystem(RES.getRes("firep3_png"),n.mountData(RES.getRes("firep3_json")));return r.start(),i.start(),a.start(),n.addChild(a),n.addChild(i),n.addChild(r),n._p1=r,n._p2=i,n._p3=a,n}return __extends(t,e),t.prototype.dispose=function(){var e=this;e._p1.stop(),e._p2.stop(),e._p3.stop(),e.removeChildren(),e.parent&&e.parent.removeChild(e)},t.prototype.mountData=function(e){return e.emitterVariance.x=this._w,e.maxParticles/=2,e},t}(egret.Sprite);window.EnjoFire=n,__reflect(n.prototype,"EnjoFire",["IDisposable"])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=80);var r=e.call(this)||this;return r.jumpH=20,r.createIcon(t,n),r.startJump(100*Roll.random2(10)),r}return __extends(t,e),t.prototype.dispose=function(){this.tw&&(this.tw.pause(),this.tw=null),this.removeChildren(),this.maskSP=null,this.coverSP=null,this.bmp=null},t.prototype.startJump=function(e){void 0===e&&(e=0);var t=this.y;this.tw=egret.Tween.get(this,{loop:!0}).wait(e).set({iconState:!1}).to({y:t-this.jumpH},150).to({y:t},150).to({y:t-this.jumpH},150).to({y:t},150).set({iconState:!0}).wait(e)},Object.defineProperty(t.prototype,"iconState",{get:function(){return this.coverSP.visible},set:function(e){this.coverSP.visible=e},enumerable:!1,configurable:!0}),t.prototype.createIcon=function(e,t){var n=new egret.Bitmap;n.texture=RES.getRes(e),n.width=t,n.height=t,this.addChild(n),this.bmp=n;var r=new egret.Shape;r.graphics.beginFill(0,.5),r.graphics.drawRoundRect(0,0,t,t,t),r.graphics.endFill(),this.addChild(r),this.coverSP=r;var i=new egret.Shape;i.graphics.beginFill(0),i.graphics.drawRoundRect(0,0,t,t,t),i.graphics.endFill(),this.addChild(i),n.mask=i,this.maskSP=i},t}(egret.Sprite);window.CollaboIcon=n,__reflect(n.prototype,"CollaboIcon",[])},function(e,t){var n=function(e){function t(t,n,r){void 0===n&&(n=""),void 0===r&&(r=null);var i=e.call(this)||this;return i.des=t,i.url=n,i.cb=r,i.addEventListener(eui.UIEvent.ADDED_TO_STAGE,i.onAdded,i),i.skinName="resource/eui_skins/logpanel.exml",i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.scaleX=0,this.scaleY=0},t.prototype.dispose=function(){var e=this;egret.Tween.get(this).to({scaleX:0,scaleY:0},200).call(function(){e.cb&&e.cb(null)})},t.prototype.onAdded=function(e){void 0===e&&(e=null);var t=this;t.x=(WorldData.STAGE_W-t.width)/2,t.y=(WorldData.STAGE_H-t.height)/2,t.touchEnabled=!0,t.touchChildren=!0,t.txtDes.text=t.des,t.removeEventListener(eui.UIEvent.ADDED_TO_STAGE,t.onAdded,t),egret.Tween.get(t).set({scaleX:0,scaleY:0}).to({scaleX:1,scaleY:1},200)},t.prototype.onClick=function(e){},t}(eui.Component);window.EvtLog=n,__reflect(n.prototype,"EvtLog",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;
return t.addEventListener(eui.UIEvent.COMPLETE,t.onComplete,t),t.skinName="resource/eui_skins/liverinfobtn.exml",t}return __extends(t,e),t.prototype.dispose=function(){this.removeEventListener("touchBegin",this.onTouch,this),this.removeEventListener("touchEnd",this.onRelease,this)},t.prototype.onComplete=function(e){this.removeEventListener(eui.UIEvent.COMPLETE,this.onComplete,this),this.addEventListener("touchBegin",this.onTouch,this),this.addEventListener("touchEnd",this.onRelease,this),this._shadow=new egret.DropShadowFilter(2),this.filters=[this._shadow]},t.prototype.onTouch=function(e){this._pressed=!0,this.filters=[]},t.prototype.onRelease=function(e){this._pressed&&(this._pressed=!1,this.filters=[this._shadow])},t}(eui.Component);window.LiverInfoBtn=n,__reflect(n.prototype,"LiverInfoBtn",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/money.exml",t}return __extends(t,e),t.prototype.setNum=function(e){this._tw&&(this._tw.setPaused(!0),this._tw=null),this.txtMoney.text=""+e,this._num=e},t.prototype.setTween2Num=function(e,t){void 0===t&&(t=null),this._tw=egret.Tween.get(this).to({num:e},1e3).call(function(){t&&t()})},Object.defineProperty(t.prototype,"num",{get:function(){return this._num},set:function(e){e=Math.floor(e),this.txtMoney.text=""+e,this._num=e},enumerable:!1,configurable:!0}),t}(eui.Component);window.Money=n,__reflect(n.prototype,"Money",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.$addListener(eui.UIEvent.COMPLETE,t.onComplete,t),t.skinName="resource/eui_skins/rollbtn.exml",t}return __extends(t,e),t.prototype.addEventListener=function(e,t,n,r,i){e==egret.TouchEvent.TOUCH_TAP&&this.btn.addEventListener(e,t,n,r,i)},t.prototype.onComplete=function(e){this.removeEventListener(eui.UIEvent.COMPLETE,this.onComplete,this),this.result.touchEnabled=!1,this.txtRollNum.touchEnabled=!0},t.prototype.showRolledNum=function(e,t){var n=this,r=this.txtRollNum;this.result.currentState=t,t==RollResult.BIG_SUCCESS?SoundManager.instance.playBgs("success_mp3"):t==RollResult.BIG_FAIL,this._tw&&(this._tw.pause(),this._tw=null),this._tw=egret.Tween.get(r).set({bottom:-100,text:""+e}).to({bottom:this.height},200).wait(1e3).set({bottom:-100}).call(function(){n.result.currentState=RollResult.NORMAL})},t}(eui.Component);window.RollBtn=n,__reflect(n.prototype,"RollBtn",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/rollresult.exml",t.touchEnabled=!1,t}return __extends(t,e),t.prototype.showState=function(e){this.currentState=e},t}(eui.Component);window.RollResultLabel=n,__reflect(n.prototype,"RollResultLabel",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this)||this;return n.name=t.name,n.addEventListener(eui.UIEvent.ADDED_TO_STAGE,n.onAdded,n),t.type==SkillType.POSITIVE?n.type="positive":t.type==SkillType.NEGATIVE?n.type="negative":t.type==SkillType.HIDDEN&&(n.type="hidden"),n.stayTime=1e3,n.skinName="resource/eui_skins/positiveskill.exml",n}return __extends(t,e),t.prototype.onAdded=function(e){var t=this,n=this.x;this.removeEventListener(eui.UIEvent.ADDED_TO_STAGE,this.onAdded,this),egret.Tween.get(this).to({x:n-this.width},200).wait(this.stayTime).to({x:n},200).call(function(){t.parent&&t.parent.removeChild(t)})},t.prototype.createChildren=function(){e.prototype.createChildren.call(this);var t=this.name;t.length>20&&(this.txtskillname.size=20,this.stayTime=2500),this.txtskillname.text=t,this.width=this.txtskillname.textWidth+80,this.currentState=this.type},t}(eui.Component);window.SkillBar=n,__reflect(n.prototype,"SkillBar",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/subscribe.exml",t}return __extends(t,e),t.prototype.setNum=function(e){this._num=e,this.txtSubscribe.text=""+e},t.prototype.setTween2Num=function(e,t){void 0===t&&(t=null),egret.Tween.get(this).to({num:e},1500).wait(500).call(function(){t&&t()})},Object.defineProperty(t.prototype,"num",{get:function(){return this._num},set:function(e){e=Math.floor(e),this.txtSubscribe.text=""+e,this._num=e},enumerable:!1,configurable:!0}),t}(eui.Component);window.Subscribe=n,__reflect(n.prototype,"Subscribe",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t._lock=!1,t.skinName="resource/eui_skins/vrbtn.exml",t.addEventListener("touchTap",t.onClick,t),t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t}return __extends(t,e),t.prototype.onClick=function(e){this._lock||(this._lock=!0,this.dispatchEvent(new egret.Event(GameEvents.VR_SWITCH)),egret.Tween.get(this).to({scaleX:1.2,scaleY:1.2},100).to({scaleX:1,scaleY:1},100).set({_lock:!1}))},t}(eui.Component);window.VRBtn=n,__reflect(n.prototype,"VRBtn",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this)||this;return n.data=t,n.skinName="resource/eui_skins/scorePanel.exml",n.once(eui.UIEvent.ADDED_TO_STAGE,n.onAdded,n),n}return __extends(t,e),t.prototype.onAdded=function(e){for(var t=this,n=this.data,r=0;r<n.length;r++){var i=t["img"+r];i.source=n[r].iconUrl;var a=t["txtStream"+r];a.text=n[r].stream+" 次";var o=t["txtSub"+r];o.text=n[r].sub+" 人"}t.btnTitle.once(egret.TouchEvent.TOUCH_TAP,t.onBtnClicked,t),SoundManager.instance.play("vtl3_mp3",!0)},t.prototype.onBtnClicked=function(e){this.dispatchEvent(new egret.Event(GameEvents.BACK2TITLE))},t}(eui.Component);window.ScorePanel=n,__reflect(n.prototype,"ScorePanel",[])},function(e,t){var n=function(){function e(){}return e}();window.gamestart=n,__reflect(n.prototype,"gamestart",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/playerstartselect.exml",t}return __extends(t,e),t.prototype.setPlayer=function(e,t,n){var r=this;return r.url=e,r.useable=t,r.img.source=e,r.currentState=t?"normal":"disable",r.touchEnabled=t,r._index=n,new Promise(function(e,t){egret.Tween.get(r.img).set({alpha:0,scaleX:1.2,scaleY:1.2}).to({alpha:1,scaleX:1,scaleY:1},200).call(e)})},t.prototype.setP=function(e){var t=this._btn;return this._btn=e,e&&this.pcontainer.addChild(e),t},Object.defineProperty(t.prototype,"useAble",{get:function(){return this.useable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),t}(eui.Component);window.PlayerIcon=n,__reflect(n.prototype,"PlayerIcon",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.TURNS=[10,20,30,50,100],t.livers=["mito_json","toya_json","rion_json","sasaki_json","lize_json","chaika_json","umeo_json","siina_json"],t.curTurn=t.TURNS[0],t.skinName="resource/eui_skins/gameStartSetting.exml",t.once(eui.UIEvent.ADDED_TO_STAGE,t.onAdded,t),t}return __extends(t,e),t.prototype.onAdded=function(e){return __awaiter(this,void 0,void 0,function(){var e,t,n,r,i,a,o,s,r,c;return __generator(this,function(l){switch(l.label){case 0:e=this,t=e.livers,e.btnStart.visible=!1,e.cpn2Hide0.visible=!1,e.cpn2Hide1.visible=!1,n=[],r=0,l.label=1;case 1:return r<t.length?(i=RES.getRes(t[r]),a=e["liver"+r],o=1!=i.disable,[4,a.setPlayer(i.iconUrl,o,r)]):[3,4];case 2:l.sent(),a.touchEnabled=!0,a.touchChildren=!0,o&&n.push(a),l.label=3;case 3:return r++,[3,1];case 4:for(e.useLivers=n,s=[],r=0;4>r;r++)c=new eui.Button,c.label=r+1+"P",s.push(c),n[r].setP(c),c.addEventListener("touchBegin",e.onStartDrag,e);return e.tagBtns=s,e.btnStart.addEventListener("touchTap",e.onStartClick,e),e.tslider.addEventListener(egret.Event.CHANGE,e.onTurnSliderChange,e),e.btnStart.visible=!0,e.cpn2Hide0.visible=!0,e.cpn2Hide1.visible=!0,[2]}})})},t.prototype.onStartDrag=function(e){if(!this.dragging){var t=e.currentTarget;this.dragging=t,this.oriIcon=t.parent.parent,t.parent.removeChild(t),t.x=e.stageX-t.width/2,t.y=e.stageY-t.height/2,this.addChild(t),this.addEventListener("touchMove",this.onDragging,this),this.addEventListener("touchEnd",this.onCancelDrag,this)}},t.prototype.onDragging=function(e){var t=this.dragging;t&&(t.x=e.stageX-t.width/2,t.y=e.stageY-t.height/2)},t.prototype.onCancelDrag=function(e){var t=this.dragging;if(t){this.removeEventListener("touchMove",this.onDragging,this),this.removeEventListener("touchEnd",this.onCancelDrag,this);for(var n,r=0,i=this.useLivers;r<i.length;r++){var a=i[r];if(a.useAble&&a.hitTestPoint(e.stageX,e.stageY)){n=a;break}}if(n){var o=n.setP(this.dragging);o&&this.oriIcon&&this.oriIcon.setP(o)}else this.oriIcon&&this.oriIcon.setP(this.dragging);this.oriIcon=null,this.dragging=null}},t.prototype.onStartClick=function(e){for(var t=[],n=this.livers,r=0,i=this.tagBtns;r<i.length;r++){var a=i[r],o=a.parent.parent;t.push(n[o.index])}var s=new egret.Event(GameEvents.GAME_START);s.data={livers:t,turn:this.curTurn},this.dispatchEvent(s)},t.prototype.onTurnSliderChange=function(e){var t=this.tslider.value;this.curTurn=this.TURNS[t],this.txtTurn.text=""+this.curTurn},t}(eui.Component);window.StartSelectPanel=n,__reflect(n.prototype,"StartSelectPanel",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.touchChildren=!0,t.skinName="resource/eui_skins/actmenu.exml",t.addEventListener("touchTap",t.onClick,t),t}return __extends(t,e),t.prototype.dispose=function(){this.removeEventListener("touchTap",this.onClick,this),this.parent&&this.parent.removeChild(this)},t.prototype.onClick=function(e){var t=e.target,n=this,r={};switch(t){case n.btnGameStream:r={ty:GameEvents.STREAM_PREPARE,ty2:StreamType.GAME,index:0};break;case n.btnSingStream:r={ty:GameEvents.STREAM_PREPARE,ty2:StreamType.SING,index:1};break;case n.btnTalkStream:r={ty:GameEvents.STREAM_PREPARE,ty2:StreamType.TALK,index:2};break;case n.btnPresentStream:r={ty:GameEvents.STREAM_PREPARE,ty2:StreamType.PRESENT,index:3};break;case n.btnWatch:r={ty:GameEvents.WATCH,index:4};break;case n.btnRest2:r={ty:GameEvents.REST,index:5};break;default:return}var i=new egret.Event(GameEvents.ACTION_CONFIRM);i.data=r,this.dispatchEvent(i)},t}(eui.Component);window.ActMenu=n,__reflect(n.prototype,"ActMenu",["IDisposable"])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/actmenur.exml",t.addEventListener("touchTap",t.onClick,t),t}return __extends(t,e),t.prototype.dispose=function(){this.removeEventListener("touchTap",this.onClick,this),this.parent&&this.parent.removeChild(this)},t.prototype.onClick=function(e){var t=e.target,n=this,r={};switch(t){case n.btnGame:r={ty:GameEvents.GAME};break;case n.btnSing:r={ty:GameEvents.SING};break;case n.btnStudy:r={ty:GameEvents.STUDY};break;case n.btnWork:r={ty:GameEvents.WORK};break;case n.btnHangout:r={ty:GameEvents.HANGOUT};break;case n.btnRest:r={ty:GameEvents.REST};break;default:return}var i=new egret.Event(GameEvents.ACTION_CONFIRM);i.data=r,this.dispatchEvent(i)},t}(eui.Component);window.ActMenuR=n,__reflect(n.prototype,"ActMenuR",["IDisposable"])},function(e,t){var n=function(e){function t(t){var n=e.call(this)||this;return n.addEventListener(eui.UIEvent.COMPLETE,n.onComplete,n),n.selections=t,n.touchEnabled=!1,n.skinName="resource/eui_skins/custommenu.exml",n}return __extends(t,e),t.prototype.dispose=function(){this.removeEventListener("touchTap",this.onClick,this),this.parent&&this.parent.removeChild(this)},t.prototype.onComplete=function(e){void 0===e&&(e=null),this.removeEventListener(eui.UIEvent.COMPLETE,this.onComplete,this);var t=this;t.items=[];for(var n=0,r=0,i=0,a=t.selections;i<a.length;i++){var o=a[i],s=new MenuItem(o.selection,t,o.sub);n=Math.max(n,s.height),r=Math.max(r,s.textWidth),t.selContainer.addChild(s),t.items.push(s)}var c=1.2*r;300>c&&(c=300),t.width=c,t.height=t.selections.length*(n+20)+40,this.addEventListener("touchTap",t.onClick,t)},t.prototype.setItemsDisable=function(e,t){this.items[e].disable=t},t.prototype.onClick=function(e){var t=this.items.indexOf(e.target),n=new egret.Event(GameEvents.ACTION_CONFIRM);n.data={ty:GameEvents.ACTION_CONFIRM,index:t},this.dispatchEvent(n)},t}(eui.Component);window.CustomMenu=n,__reflect(n.prototype,"CustomMenu",["IDisposable"])},function(e,t){var n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(eui.Component);window.EnkrMenu=n,__reflect(n.prototype,"EnkrMenu",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this)||this;return n.skinName="resource/eui_skins/liversmenu.exml",n}return __extends(t,e),t.prototype.setPlayers=function(e){this.iconUrls=[];for(var t=0,n=e;t<n.length;t++){var r=n[t];this.iconUrls.push(r.iconUrl)}this._current=0,this.onComplete()},Object.defineProperty(t.prototype,"current",{set:function(e){this.covers[this._current].visible=!0,this.covers[e].visible=!1,this._current=e},enumerable:!1,configurable:!0}),t.prototype.onComplete=function(e){void 0===e&&(e=null);var t=this;t.iconContainers=[t.iconContainer0,t.iconContainer1,t.iconContainer2,t.iconContainer3],t.icons=[],t.covers=[];for(var n=0;n<t.iconUrls.length;n++){var r=t.createIcon(t.iconUrls[n],t.width,t.iconContainers[n]),i=r[0],a=r[1];t.iconContainers[n].addEventListener("touchTap",this.onClick,this),t.icons.push(i),t.covers.push(a)}this.current=0},t.prototype.onClick=function(e){void 0===e&&(e=null);var t=new egret.Event(GameEvents.FOCUS2LIVER);t.data=this.iconContainers.indexOf(e.target),this.dispatchEvent(t)},t.prototype.createIcon=function(e,t,n){var r=new egret.Bitmap;r.texture=RES.getRes(e),r.width=t,r.height=t,n.addChild(r);var i=new egret.Shape;i.graphics.beginFill(0,.5),i.graphics.drawRoundRect(0,0,t,t,t),i.graphics.endFill(),n.addChild(i);var a=new egret.Shape;return a.graphics.beginFill(0),a.graphics.drawRoundRect(0,0,t,t,t),a.graphics.endFill(),n.addChild(a),r.mask=a,[r,i]},t}(eui.Component);window.LiversMenu=n,__reflect(n.prototype,"LiversMenu",[])},function(e,t){var n=function(e){function t(t,n,r,i){void 0===r&&(r=""),void 0===i&&(i=!1);var a=e.call(this)||this;return a.addEventListener(eui.UIEvent.ADDED_TO_STAGE,a.onComplete,a),a.skinName="resource/eui_skins/menuitem.exml",a._t=t,a._t2=r,a.bg=n,a}return __extends(t,e),Object.defineProperty(t.prototype,"disable",{set:function(e){e?(this.enabled=!1,this.touchEnabled=!1,this.touchChildren=!1):(this.enabled=!0,this.touchChildren=!1,this.touchEnabled=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textWidth",{get:function(){return this.labelDisplay.size*(this._t.length+4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textHeight",{get:function(){return this.labelDisplay.textHeight},enumerable:!1,configurable:!0}),t.prototype.onComplete=function(e){void 0===e&&(e=null),this.removeEventListener(eui.UIEvent.ADDED_TO_STAGE,this.onComplete,this),this.labelDisplay.text=this._t,this._t2&&""!=this._t2&&(this.labelDisplay.textAlign=egret.HorizontalAlign.LEFT,this.labelSub.text=this._t2),this.percentWidth=80},t}(eui.Button);window.MenuItem=n,__reflect(n.prototype,"MenuItem",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this)||this;return n._itemHeight=-1,n.touchEnabled=!0,n._mulSel=!0,n._ty=t,n.addEventListener(eui.UIEvent.COMPLETE,n.onComplete,n),n.skinName="resource/eui_skins/itemlist.exml",n}return __extends(t,e),t.prototype.setMultiSelection=function(e){this._mulSel=e},t.prototype.setData=function(e,t){return void 0===t&&(t=!0),this.rawdata=e,t?this.refreshList():this.collectdata.replaceAll(e),this.itemListContainer.selectedItem},t.prototype.selectItem=function(e){var t=this.itemListContainer,n=t.selectedIndex+e;if(-1>=n)return null;if(n>=this.collectdata.length)return null;if(-1==this._itemHeight){var r=t.getChildAt(0);r&&(this._itemHeight=r.height)}t.selectedIndex=n;var i=t.numChildren;return 1==e?n+1>t.getChildAt(i-1).itemIndex&&(t.scrollV+=this._itemHeight):0==n?t.scrollV=0:t.scrollV>0&&n-1<t.getChildAt(0).itemIndex&&(t.scrollV-=this._itemHeight),this.rawdata[n]},t.prototype.onComplete=function(e){this.itemListContainer&&(this.removeEventListener(eui.UIEvent.COMPLETE,this.onComplete,this),this.refreshList(),this.itemListContainer.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onItemSelected,this),this.itemListContainer.useVirtualLayout=!0)},t.prototype.refreshList=function(){var e=this.itemListContainer;if(e){switch(this.collectdata=new eui.ArrayCollection(this.rawdata),e.dataProvider=this.collectdata,this._ty){case PanelType.SHOP:case PanelType.SHOP2:e.itemRenderer=ItemListBuyObj;break;case PanelType.NORMAL:e.itemRenderer=ItemListNormalObj;break;default:e.itemRenderer=ItemListObj}e.selectedIndex=-1}},t.prototype.refreshItem=function(e){this.collectdata&&this.collectdata.itemUpdated(e)},t.prototype.onItemSelected=function(e){var n=this.itemListContainer.selectedItem;if(!this._mulSel)for(var r=0,i=this.rawdata;r<i.length;r++){var a=i[r];if(a.selected&&a!=n){a.selected=!1;break}}var o=new egret.Event(t.ITEM_SELECTED);o.data=n,this.dispatchEvent(o)},t.ITEM_SELECTED="ITEM_SELECTED",t}(eui.Component);window.ItemList=n,__reflect(n.prototype,"ItemList",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.touchEnabled=!0,t.skinName="resource/eui_skins/itemListObj.exml",t}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),"-1"==this.txtNum.text&&(this.txtNum.text="∞");var t=this.data.neta;t.type==NetaType.SONG?t.usable?(this.currentState="up",this.checkbox.enabled=!0):(this.currentState="disabled",this.checkbox.enabled=!1):this.enabled=0!=t.times},t}(eui.ItemRenderer);window.ItemListObj=n,__reflect(n.prototype,"ItemListObj",[]);var r=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.checkboxContainer.removeChild(this.checkbox),this.checkboxContainer.percentWidth=3},t}(n);window.ItemListNormalObj=r,__reflect(r.prototype,"ItemListNormalObj",[]);var i=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this),this.txtNum.text="$"+this.data.neta.value;var t=this.data.holded&&-1==this.data.neta.times||0==this.data.neta.times||this.data.valueLock;this.currentState=t?"disabled":"up"},t}(r);window.ItemListBuyObj=i,__reflect(i.prototype,"ItemListBuyObj",[])},function(e,t){var n=function(e){function t(t,n,r,i,a,o){void 0===o&&(o=null);var s=e.call(this)||this;s._width=i,s._height=a,s._ty=n,s._ty2=r,s._store=t,s._store2=o,s.touchEnabled=!0,s.tmpNetasList=[];var c=s.createTabs();c=s.createPanel(c),s.createList();var l=s._tabs[s._curTab].type,h=s.getList(l);s._list.setMultiSelection(!(l==NetaType.GAME||l==NetaType.PRESENT)),s._list.setData(h);var u=new egret.Bitmap;return u.texture=RES.getRes("icons_json#close"),u.width=60,u.height=60,u.x=s._width-u.width,u.touchEnabled=!0,u.addEventListener("touchTap",s.onCancel,s),s.addChild(u),s._closebtn=u,s}return __extends(t,e),t.prototype.createTabs=function(e){void 0===e&&(e=0);var t;switch(this._ty){case PanelType.STREAM:switch(this._ty2){case StreamType.GAME:t=[NetaType.GAME,NetaType.TALK,NetaType.SPEC];break;case StreamType.SING:t=[NetaType.SONG,NetaType.SPEC];break;case StreamType.TALK:t=[NetaType.TALK,NetaType.SPEC];break;case StreamType.PRESENT:t=[NetaType.PRESENT,NetaType.SPEC]}break;case PanelType.SHOP:t=[NetaType.GAME,NetaType.SONG,NetaType.DEVICE];break;case PanelType.SHOP2:t=[NetaType.DEVICE];break;case PanelType.NORMAL:t=[NetaType.TALK,NetaType.GAME,NetaType.SONG,NetaType.PRESENT,NetaType.SPEC,NetaType.DEVICE]}for(var n=this._width/t.length,r=[],i=0;i<t.length;i++){var a=void 0;a=new Tab(n,i,t[i]),a.x=i*a.width,a.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTabSelected,this),this.addChild(a),r.push(a)}return this._tabs=r,this._tabWidth=r[0].width,this._curTab=0,r[0].setSelected(!0),r[0].width},t.prototype.createPanel=function(e){void 0===e&&(e=0);var t=new egret.Sprite;return t.graphics.beginFill(0,.9),t.graphics.drawRoundRect(0,e,this._width,this._height-e,50),t.graphics.endFill(),this._panel=t,this.addChild(this._panel),this._height},t.prototype.createList=function(){var e=this._width,t=new ItemList(this._ty);t.width=e,t.height=this._height-this._tabWidth,t.y=this._tabWidth,this.addChild(t),this._list=t},t.prototype.onTabSelected=function(e){var t=e.currentTarget;this.switchTab(t)},t.prototype.switchTab=function(e){var t=this._tabs[this._curTab];if(t!=e){t&&t.setSelected(!1),this._curTab=e.index,e.setSelected(!0);var n=this._tabs[this._curTab].type,r=this.getList(n);this._list.setMultiSelection(!(n==NetaType.GAME||n==NetaType.PRESENT)),this._list.setData(r)}},t.prototype.refresh=function(e){var t=this._tabs[this._curTab].type;if(e.neta.type==t){for(var n=this.tmpNetasList[t],r=0;r<n.length;r++)if(n[r].neta.name==e.neta.name){n[r]=e;break}this._list.refreshItem(e)}},t.prototype.getList=function(e,t){if(void 0===t&&(t=!1),this.tmpNetasList[e]&&!t)return this.tmpNetasList[e];var n=void 0;return n=this._ty==PanelType.SHOP||this._ty==PanelType.SHOP2?this._store.filterNeta2Shop(e,this._store2):this._store.filterNetas2Select(e),this.tmpNetasList[e]=n,n},t.prototype.addEventListener=function(t,n,r,i,a){t==ItemList.ITEM_SELECTED?this._list.addEventListener(t,n,r,i,a):e.prototype.$addListener.call(this,t,n,r,i,a)},t.prototype.dispose=function(){for(var e=0,t=this._tabs;e<t.length;e++){var n=t[e];n.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTabSelected,this)}this._closebtn.removeEventListener("touchTap",this.onCancel,this)},t.prototype.onCancel=function(e){this.dispatchEvent(new egret.Event(GameEvents.MENU_CANCEL))},t}(egret.Sprite);window.NetaSelectPanel=n,__reflect(n.prototype,"NetaSelectPanel",[])},function(e,t){var n=function(e){function t(t,n,r){var i=e.call(this)||this;return i.touchEnabled=!0,i.index=n,i._ty=r,t=t>60?60:t,i._w=t,i.width=t,i.createIcon(),i.createTab(),i}return __extends(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._ty},enumerable:!1,configurable:!0}),t.prototype.setSelected=function(e){e!=this.selected&&(this.selected=e,e?this.removeChild(this._mask):this.addChild(this._mask))},t.prototype.createTab=function(){var e=this._w,t=1.5*e;this.graphics.beginFill(0,.75),this.graphics.drawRoundRect(0,0,e,t,30),this.graphics.endFill();var n=new egret.Shape;n.graphics.beginFill(0,.5),n.graphics.drawRoundRect(0,0,e,t,30),n.graphics.endFill(),this.addChild(n),this._mask=n},t.prototype.createIcon=function(){var e=.8*this._w,t=.1*this._w,n=new egret.Bitmap,r=RES.getRes(this.iconUrl);n.texture=r,n.x=t,n.y=t,n.width=e,n.height=e,this.addChild(n)},Object.defineProperty(t.prototype,"iconUrl",{get:function(){switch(this._ty){case NetaType.GAME:return"icons_json#game";case NetaType.SONG:return"icons_json#song";case NetaType.TALK:return"icons_json#daily";case NetaType.PRESENT:return"icons_json#present";case NetaType.SPEC:return"icons_json#spec";case NetaType.DEVICE:return"icons_json#device"}},enumerable:!1,configurable:!0}),t}(egret.Sprite);window.Tab=n,__reflect(n.prototype,"Tab",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this)||this;return n.touchEnabled=!0,n._mc=t,n.addEventListener(eui.UIEvent.COMPLETE,n.onComplete,n),n.skinName="resource/eui_skins/maincharacter.exml",n.tips=RES.getRes("liver_readme_json"),n}return __extends(t,e),t.prototype.dispose=function(){this.removeEventListener("touchTap",this.onClick,this),this.btnClose.removeEventListener("touchTap",this.onClose,this),this.parent&&this.parent.removeChild(this)},t.prototype.refresh=function(){var e=this,t=e._mc;e.img.texture=RES.getRes(t.iconUrl),e.txtName.text=t.name,e.txtSubs.text=""+t.subscribe,e.txtIncrease.text=""+t.increase,e.txtStream.text=""+t.stream.length,0==t.stream.length?e.txtPrevStream.text="--":e.txtPrevStream.text=t.stream[t.stream.length-1].startTurn+"T",e.txtMoney.text=""+t.money,e.txts1.text=t.skills[0].name,e.txts2.text=t.skills[1].name,e.txts3.text=t.skills[2].name,e.txts4.text=t.skills[3].name,e.txtluck.text=""+Math.floor(t.luck),e.txtSense.text=""+Math.floor(t.sense),e.txtCommu.text=""+Math.floor(t.commu),e.txtStrength.text=""+Math.floor(t.strength),e.txtTalk.text=""+Math.floor(t.talk),e.txtGame.text=""+Math.floor(t.game),e.txtSing.text=""+Math.floor(t.sing),e.txtTech.text=""+Math.floor(t.tech),e.setTextColor(e.txtluck,"luck"),e.setTextColor(e.txtSense,"sense"),e.setTextColor(e.txtCommu,"commu"),e.setTextColor(e.txtStrength,"strength"),e.setTextColor(e.txtTalk,"talk"),e.setTextColor(e.txtGame,"game"),e.setTextColor(e.txtSing,"game"),e.setTextColor(e.txtTech,"tech");for(var n=0,r=0;r<t.buffs.length;r++){var i=t.buffs[r];i.iconUrl&&""!=i.iconUrl&&(n=e.buffIcon(i.iconUrl,r,n))}},t.prototype.setTextColor=function(e,t){var n=this._mc.ddata[t];n>0?e.textColor=58999:0==n?e.textColor=16777215:0>n&&(e.textColor=14494720)},t.prototype.onComplete=function(e){void 0===e&&(e=null);var t=this;t.removeEventListener(eui.UIEvent.COMPLETE,t.onComplete,t),t.btnClose.addEventListener("touchTap",t.onClose,t),t.addEventListener("touchTap",t.onClick,t),t.refresh()},t.prototype.onClick=function(e){var t=this,n=e.target,r="";switch(n.name){case"containers1":r=t._mc.skills[0].des;break;case"containers2":r=t._mc.skills[1].des;break;case"containers3":r=t._mc.skills[2].des;break;case"containers4":r=t._mc.skills[3].des;break;case"container0":r=t.tips.luck;break;case"container1":r=t.tips.sense;break;case"container2":r=t.tips.commu;break;case"container3":r=t.tips.strength;break;case"container4":r=t.tips.talk;break;case"container5":r=t.tips.game;break;case"container6":r=t.tips.sing;break;case"container7":r=t.tips.tech;break;default:if(n.name.indexOf("buff_")>=0){var i=n.name.split("_"),a=parseInt(i[1]);r=t._mc.buffs[a].desStr;break}return void(t.containerTips.visible=!1)}t.txtTips.text=r,t.containerTips.visible=!0,t.containerTips.x=e.stageX-this.x,t.containerTips.y=e.stageY-this.y},t.prototype.buffIcon=function(e,t,n){void 0===n&&(n=0);var r=new egret.Bitmap;r.texture=RES.getRes(e),r.name="buff_"+t,this.buffContainer.addChild(r);var i=this.height*(this.buffContainer.percentHeight/100),a=r.height/r.width;return r.height=i,r.width=r.height/a,r.x=n+10,r.y=(i-r.height)/2,r.touchEnabled=!0,r.x+r.width},t.prototype.onClose=function(e){void 0===e&&(e=null),this.dispatchEvent(new egret.Event(GameEvents.MENU_CANCEL)),this.dispose()},t}(eui.Component);window.CharaterPanel=n,__reflect(n.prototype,"CharaterPanel",["IDisposable"])},function(e,t){var n=function(e){function t(t){var n=e.call(this)||this;return n.icons=[],n.urls=t,n.addEventListener(eui.UIEvent.ADDED_TO_STAGE,n.onAdded,n),n.skinName="resource/eui_skins/collabopanel.exml",n}return __extends(t,e),t.prototype.dispose=function(){this.tw&&(this.tw.pause(),this.tw=null);for(var e=0,t=this.icons;e<t.length;e++){var n=t[e];n.dispose()}this.icons=null},t.prototype.onAdded=function(e){var t=this;this.removeEventListener(eui.UIEvent.ADDED_TO_STAGE,this.onAdded,this);this.width,this.height;egret.Tween.get(this).set({tipVisible:!0}).call(function(){t.initIcons()})},t.prototype.initIcons=function(){for(var e=0,t=0,n=this.urls;t<n.length;t++){var r=n[t],i=new CollaboIcon(r);i.x=e,this.iconContainer.addChild(i),e+=i.width+15,this.icons.push(i)}},Object.defineProperty(t.prototype,"tipVisible",{get:function(){return this.txtTip.visible},set:function(e){this.txtTip.visible=e},enumerable:!1,configurable:!0}),t}(eui.Component);window.CollaboPanel=n,__reflect(n.prototype,"CollaboPanel",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/comment.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this);var t=this.data;t.indexOf("{fire}")>=0?this.currentState="fire":this.currentState="normal",t=t.replace("{fire}",""),this.txt.text=t},t}(eui.ItemRenderer);window.CommentListObj=n,__reflect(n.prototype,"CommentListObj",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.stats=["p1","p2","p3","p4"],t.cur=0,t.skinName="resource/eui_skins/descriptPanel.exml",t.once(eui.UIEvent.ADDED_TO_STAGE,t.onAdded,t),t}return __extends(t,e),t.prototype.onAdded=function(){this.btnCancel.once("touchTap",this.onCancel,this),this.contents.addEventListener("touchTap",this.onNextPage,this)},t.prototype.onNextPage=function(e){void 0===e&&(e=null),this.cur++,this.cur==this.stats.length&&(this.cur=0),this.currentState=this.stats[this.cur]},t.prototype.onCancel=function(){this.dispatchEvent(new egret.Event(GameEvents.MENU_CANCEL))},t}(eui.Component);window.DescriptPanel=n,__reflect(n.prototype,"DescriptPanel",[])},function(e,t){var n=function(e){function t(t,n,r,i){void 0===i&&(i=null);var a=e.call(this)||this;return a.sW=egret.MainContext.instance.stage.stageWidth,a.sH=egret.MainContext.instance.stage.stageHeight,a.menu=t,a.ename=n,a.des=r,a.skinName="resource/eui_skins/evtpanel.exml",a.width=a.sW,a.height=a.sH,a.npcs=i,a.createTween(),a}return __extends(t,e),t.prototype.addEventListener=function(e,t,n,r,i){this.menu.addEventListener(e,t,n,r,i)},t.prototype.dispose=function(){this.parent&&this.parent.removeChild(this)},t.prototype.modiflyContents=function(e,t){var n=this;n.ename=e,n.des=t,n.txtEvtName.text=n.ename,n.txtDes.text=n.des},Object.defineProperty(t.prototype,"customMenu",{get:function(){return"CustomMenu"==egret.getQualifiedClassName(this.menu)?this.menu:null},enumerable:!1,configurable:!0}),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this);var t=this;t.txtEvtName.text=t.ename,t.txtDes.text=t.des,t.menuContainer.addChild(t.menu),0==t.npcs.length?t.npcPanel.visible=!1:t.npcPanel.setNpcs(t.npcs)},t.prototype.createTween=function(){var e=this;e._oriLogBottom=e.logContainer.bottom,e._oriMenuLeft=e.menuContainer.left,e.alpha=0,e.menuContainerLeft=e._oriMenuLeft-100,e.logContainerBottom=e._oriLogBottom-100,egret.Tween.get(e).to({alpha:1,menuContainerLeft:e._oriMenuLeft,logContainerBottom:e._oriLogBottom},200)},Object.defineProperty(t.prototype,"menuContainerLeft",{get:function(){return this.menuContainer.left},set:function(e){this.menuContainer.left=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"logContainerBottom",{get:function(){return this.logContainer.bottom},set:function(e){this.npcPanel.bottom=e,this.logContainer.bottom=e},enumerable:!1,configurable:!0}),t}(eui.Component);window.EvtPanel=n,__reflect(n.prototype,"EvtPanel",["IDisposable"])},function(e,t){var n=function(e){function t(t,n,r,i,a){var o=e.call(this)||this;return o.sW=egret.MainContext.instance.stage.stageWidth,o.sH=egret.MainContext.instance.stage.stageHeight,o.ename=n,o.des=r,o.ty=a,o.store=i,o.mc=t,o.width=o.sW,o.height=o.sH,o.addEventListener(eui.UIEvent.ADDED_TO_STAGE,o.onAdded,o),o.skinName="resource/eui_skins/evtpanel_shop.exml",o}return __extends(t,e),t.prototype.dispose=function(){this.parent&&this.parent.removeChild(this)},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this);var t=this;t.txtEvtName.text=t.ename,t.txtDes.text=t.des},t.prototype.onAdded=function(e){var t=this;t.netaPanel.setType(!0),t.netaPanel.addEventListener(GameEvents.NETA_CONFIRM,t.onEvent,t);var n=.7*t.width-t.netaPanel.width-50,r=new NetaSelectPanel(t.store,t.ty,"",n,t.netaPanel.height,t.mc.netaBag);r.y=t.netaPanel.top,t.baseContainer.addChild(r),t.netaSelectPanel=r,r.addEventListener(ItemList.ITEM_SELECTED,t.onSelected,t),r.addEventListener(GameEvents.MENU_CANCEL,t.onEvent,t)},t.prototype.refresh=function(e){this.netaSelectPanel.refresh(e),this.onSelected({data:e})},t.prototype.onSelected=function(e){for(var t=e.data,n=t.neta,r=this.mc,i=r.money>=n.value,a=r.netaBag.filterNetas0(n.type),o=0,s=0,c=a;s<c.length;s++){var l=c[s];if(l.name==n.name){o=-1==l.times?-1:l.times;break}}this.netaPanel.setNeta(t.neta),this.netaPanel.setBtnEnable(i&&-1!=o),this.netaPanel.setHold(o)},t.prototype.onEvent=function(e){this.dispatchEvent(e)},t}(eui.Component);window.EvtPanelShop=n,__reflect(n.prototype,"EvtPanelShop",["IDisposable"])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;
return t.skinName="resource/eui_skins/netapanel.exml",t.once(eui.UIEvent.ADDED,t.onAdded,t),t}return __extends(t,e),t.addNetaToShow=function(e){t.netas.push(e);var n=t.panel;return null==n&&(n=new t,n.x=WorldData.STAGE_W,n.y=(WorldData.STAGE_H-n.height)/2,t.panel=n),n},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.oriX=this.x},t.prototype.dispose=function(){t.panel=null,this.parent&&this.parent.removeChild(this),this.dispatchEvent(new egret.Event(GameEvents.NETA_INFO_FINISH))},t.prototype.onAdded=function(e){void 0===e&&(e=null),this.onShowNeta()},t.prototype.onShowNeta=function(){var e=this,n=this;if(0==t.netas.length)return void this.dispose();var r=t.netas[0];n.txtName.text=r.name,n.txtDes.text=r.des,n.iconGift.visible=null!=r.owner,n.imgType.source=RES.getRes(n.getTypeIcon(r.type)),r.iconUrl&&""!=r.iconUrl&&(n.img.source=RES.getRes(r.iconUrl));var i=n.oriX;egret.Tween.get(n).set({x:i}).to({x:(i-n.width)/2},200).wait(2e3).to({x:-n.width},200).set({x:i}).call(function(){t.netas.shift(),e.onShowNeta()})},t.prototype.getTypeIcon=function(e){switch(e){case NetaType.GAME:return"icons_json#game";case NetaType.TALK:return"icons_json#daily";case NetaType.SONG:return"icons_json#song";case NetaType.SPEC:return"icons_json#spec";case NetaType.DEVICE:return"icons_json#device";case NetaType.PRESENT:return"icons_json#present"}},t.netas=[],t}(eui.Component);window.NetaGetPanel=n,__reflect(n.prototype,"NetaGetPanel",["IDisposable"])},function(e,t){var n=function(e){function t(t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.call(this)||this;return r._shop=n,r.skinName="resource/eui_skins/netapanel2.exml",r}return __extends(t,e),t.prototype.setType=function(e){this._shop=e,this.btn.labelDisplay.text=this._shop?"购买":"使用"},t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this._neta||(this.visible=!1),this.btn.labelDisplay.text=this._shop?"购买":"使用"},t.prototype.dispose=function(){this.btn.addEventListener("touchTap",this.onBtnClicked,this),this.parent&&this.parent.removeChild(this)},t.prototype.setNeta=function(e){var t=this;t.visible=!0,t._neta=e,t.txtName.text=e.name,e.name.length>=9?t.txtName.size=24:t.txtName.size=30,t.txtDes.text=e.des,e.type==NetaType.DEVICE?t.statContainer.visible=!1:(t.statContainer.visible=!0,t.txtPop.text=""+e.pop,t.txtSafe.text=""+(-1==e.safe?"--":e.safe),t.txtMeme.text=""+e.meme),t.imgType.source=RES.getRes(t.getTypeIcon(e.type)),e.iconUrl&&""!=e.iconUrl&&(t.img.source=RES.getRes(e.iconUrl)),e.type==NetaType.SONG?t.txtSongTip.visible=!e.usable:t.txtSongTip.visible=!1,t._shop?(t.btn.visible=!0,t.txtHold.visible=!0):(e.type==NetaType.DEVICE?(t.btn.visible=e.useable,t.btn.enabled=e.times>0):t.btn.visible=!1,t.txtHold.visible=!1),t.btn.addEventListener("touchTap",t.onBtnClicked,t)},t.prototype.onBtnClicked=function(e){var t=new egret.Event(GameEvents.NETA_CONFIRM);t.data={neta:this._neta},this.dispatchEvent(t)},t.prototype.setBtnEnable=function(e){e?this.btn.enabled=!0:this.btn.enabled=!1},t.prototype.setHold=function(e){0==e?this.txtHold.visible=!1:-1==e?(this.txtHold.visible=!0,this.txtHold.text="已持有"):(this.txtHold.visible=!0,this.txtHold.text="持有数\n"+e)},t.prototype.getTypeIcon=function(e){switch(e){case NetaType.GAME:return"icons_json#game";case NetaType.TALK:return"icons_json#daily";case NetaType.SONG:return"icons_json#song";case NetaType.SPEC:return"icons_json#spec";case NetaType.DEVICE:return"icons_json#device";case NetaType.PRESENT:return"icons_json#present"}},t}(eui.Component);window.NetaPanel=n,__reflect(n.prototype,"NetaPanel",["IDisposable"])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/npcpanel.exml",t}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.currentState="default"},t.prototype.setNpcs=function(e){var t=this;t._npc=e;for(var n=0;n<e.length;n++){var r=e[n];t["icon"+n].texture=RES.getRes(r.iconUrl),t["txt"+n].text=r.name,t["heart"+n].texture=RES.getRes(this.heartUrl(r))}},t.prototype.heartUrl=function(e){switch(Math.floor(e.favor)){case 0:return"icons_json#heart0";case 1:return"icons_json#heart1";case 2:return"icons_json#heart2";case 3:return"icons_json#heart3";default:return"icons_json#heart4"}},t}(eui.Component);window.NpcPanel=n,__reflect(n.prototype,"NpcPanel",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this)||this;return n._npc=t,n.addEventListener(eui.UIEvent.ADDED_TO_STAGE,n.onAdded,n),n.skinName="resource/eui_skins/npcpanel.exml",n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.currentState="change",this.alpha=0},t.prototype.dispose=function(){this.parent&&this.parent.removeChild(this)},t.prototype.onAdded=function(e){var t=this;this.removeEventListener(eui.UIEvent.ADDED_TO_STAGE,this.onAdded,this);var n=this;n.x=WorldData.STAGE_W,n.y=WorldData.STAGE_H/2;for(var r=0;r<n._npc.length;r++){var i=n._npc[r];n["icon"+r].texture=RES.getRes(i.iconUrl),n["txt"+r].text=i.name,n["heart"+r].texture=RES.getRes(this.heartUrl(i))}var a=n.x-n.width,o=n.x;egret.Tween.get(this).to({alpha:1,x:a},200).wait(2e3).to({x:o,alpha:0},200).call(function(){t.dispose()})},t.prototype.heartUrl=function(e){switch(Math.floor(e.favor)){case 0:return"icons_json#heart0";case 1:return"icons_json#heart1";case 2:return"icons_json#heart2";case 3:return"icons_json#heart3";default:return"icons_json#heart4"}},t}(eui.Component);window.NpcPanel2=n,__reflect(n.prototype,"NpcPanel2",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=null);var r=e.call(this)||this;return r.addEventListener(eui.UIEvent.ADDED_TO_STAGE,r.onAdded,r),r.n=t,r.cb=n,r.skinName="resource/eui_skins/paygainpanel.exml",r}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.scaleX=0,this.scaleY=0},t.prototype.dispose=function(){egret.Tween.get(this).to({scaleX:0,scaleY:0},200),this.parent&&this.parent.removeChild(this)},t.prototype.onTouched=function(e){this.cb&&this.cb()},t.prototype.onAdded=function(e){void 0===e&&(e=null);var t=this;t.touchEnabled=!0,t.touchChildren=!0,t.removeEventListener(eui.UIEvent.ADDED_TO_STAGE,t.onAdded,t),t.once(egret.TouchEvent.TOUCH_TAP,t.onTouched,t),t.x=(WorldData.STAGE_W-t.width)/2,t.y=(WorldData.STAGE_H-t.height)/2,t.n<0?t.currentState="lose":t.currentState="win",t.txtNum.text=""+t.n,egret.Tween.get(t).set({scaleX:0,scaleY:0}).to({scaleX:1,scaleY:1},200)},t}(eui.Component);window.PayGainPanel=n,__reflect(n.prototype,"PayGainPanel",[])},function(e,t){var n=function(e){function t(t,n){var r=e.call(this)||this;return r.touchEnabled=!0,r.addEventListener(eui.UIEvent.ADDED_TO_STAGE,r.onAdded,r),r._iconUrls=t,r._cur=n,r.skinName="resource/eui_skins/playerselectpanel.exml",r}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.scaleX=0,this.scaleY=0,-1==this._cur?this.currentState="allplayer":this.currentState="other"},t.prototype.dispose=function(){var e=this;this.btnCancel.removeEventListener("touchTap",this.onCancel,this);for(var t=0,n=this._imgs;t<n.length;t++){var r=n[t];r&&(r.texture=null,r.removeEventListener("touchTap",this.onClick,this))}egret.Tween.get(this).to({scaleX:0,scaleY:0},200).call(function(){e.parent&&e.parent.removeChild(e)})},t.prototype.onAdded=function(e){var t=this;t.removeEventListener(eui.UIEvent.ADDED_TO_STAGE,t.onAdded,t),t.btnCancel.addEventListener("touchTap",t.onCancel,t),egret.Tween.get(t).to({scaleX:1,scaleY:1},200);for(var n=[],r=0,i=0;4>r;)if(r!=t._cur){var a=t._iconUrls[r];if(a){var o=t["img"+i];o.texture=RES.getRes(a),o.addEventListener("touchTap",t.onClick,t),n.push(o),r++,i++}else r++,n.push(null)}else r++,n.push(null);t._imgs=n},t.prototype.onClick=function(e){var t=e.target,n=this._imgs.indexOf(t),r=new egret.Event(GameEvents.PLAYER_SELECTED);r.data={index:n},this.dispatchEvent(r)},t.prototype.onCancel=function(e){this.dispatchEvent(new egret.Event(GameEvents.PLAYER_SELECT_CANCEL))},t}(eui.Component);window.PlayerSelectPanel=n,__reflect(n.prototype,"PlayerSelectPanel",["IDisposable"])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/streamlistobj.exml",t}return __extends(t,e),t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this)},t.prototype.dataChanged=function(){e.prototype.dataChanged.call(this)},t.prototype.setIconScale=function(e){this.scaleX=e,this.scaleY=e},t.prototype.getIconScale=function(){return this.scaleX},t}(eui.ItemRenderer);window.StreamNetaListObj=n,__reflect(n.prototype,"StreamNetaListObj",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this)||this;return n._ty=t,n._urls=[],n.addEventListener(eui.UIEvent.COMPLETE,n.onComplete,n),n.skinName="resource/eui_skins/livenetapanel.exml",n}return __extends(t,e),t.prototype.dispose=function(){this.parent&&this.parent.removeChild(this)},t.prototype.setStreamData=function(e,t,n,r,i){var a=this;a.txtPop.text=""+t,a.txtSafe.text=""+n,a.txtMeme.text=""+r,a.txtNeta.text=""+e.length,a.btnConfirm.currentState=i?"up":"disabled",a.rawdata=e,a.collectdata=new eui.ArrayCollection(e),a.itemContainer.dataProvider=a.collectdata},t.prototype.startStream=function(e){var t=this;t.currentState="onstream",t.commentList.itemRenderer=CommentListObj,t.commentTimer=new egret.Timer(200),t.commentTimer.addEventListener(egret.TimerEvent.TIMER,t.omCommentRoll,t),t.commentIndex=0,t.commentTimer.start()},t.prototype.finishStream=function(){this.commentTimer.stop(),this.commentTimer.removeEventListener(egret.TimerEvent.TIMER,this.omCommentRoll,this)},t.prototype.setTotSub=function(e){this.txtSubAdd.text=""+e},t.prototype.setSubSpd=function(e){this.txtSubSpd.text=""+e},t.prototype.useNeta=function(e,t,n,r,i,a,o,s,c){var l=this,h=this;h._curNeta=h.itemContainer.getChildAt(0);var u=0;a?(h._curNeta.currentState="accident",u=1):o&&(h._curNeta.currentState="fire",u=1),h.txtSubAdd.text=""+t,h.txtSubSpd.text=""+r,h.txtDAdd.text="+"+n,h.txtDSpd.text="+"+i,h.txtTip.text="";var p=h._oritxtDY-30;egret.Tween.get(h).set({txtDAlpha:0,txtDY:h._oritxtDY}).to({txtDAlpha:1,txtDY:p,curNetaScale:u},400).to({txtDAlpha:0},100).call(function(){h.collectdata=new eui.ArrayCollection(l.rawdata.slice(e+1)),l.itemContainer.dataProvider=l.collectdata}).call(s,c)},t.prototype.showComment=function(e){this.commentRawdata||(this.commentRawdata=[]),this.commentRawdata=this.commentRawdata.concat(e)},t.prototype.omCommentRoll=function(e){var t=this;if(t.commentRawdata){var n=t.commentIndex;if(!(n+10>t.commentRawdata.length)){var r=n+10,i=t.commentRawdata.slice(n,r);t.commentCollectdata=new eui.ArrayCollection(i),t.commentList.dataProvider=t.commentCollectdata,t.commentIndex++}}},t.prototype.onComplete=function(e){this.removeEventListener(eui.UIEvent.COMPLETE,this.onComplete,this),this.btnCancel.addEventListener("touchTap",this.onCancel,this),this.btnConfirm.addEventListener("touchTap",this.onConfirm,this),this.txtTip.text=this.getTip(this._ty),this.itemContainer.itemRenderer=StreamNetaListObj,this._oritxtDY=this.txtDAdd.y},t.prototype.onConfirm=function(e){void 0===e&&(e=null),this.dispatchEvent(new egret.Event(GameEvents.STREAM_START))},t.prototype.onCancel=function(e){void 0===e&&(e=null),this.dispatchEvent(new egret.Event(GameEvents.MENU_CANCEL))},t.prototype.getTip=function(e){switch(e){case StreamType.TALK:return"杂谈直播需要选择至少3个杂谈或特殊neta";case StreamType.SING:return"歌回直播需要选择至少3个歌曲neta";case StreamType.GAME:return"游戏直播需要选择1个游戏neta";case StreamType.PRESENT:return"披露直播需要选择1个披露neta"}},Object.defineProperty(t.prototype,"curNetaScale",{get:function(){return this._curNeta.getIconScale()},set:function(e){this._curNeta.setIconScale(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"txtDAlpha",{get:function(){return this.txtDAdd.alpha},set:function(e){this.txtDAdd.alpha=e,this.txtDSpd.alpha=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"txtDY",{get:function(){return this.txtDAdd.y},set:function(e){this.txtDAdd.y=e,this.txtDSpd.y=e},enumerable:!1,configurable:!0}),t}(eui.Component);window.StreamNetaPanel=n,__reflect(n.prototype,"StreamNetaPanel",["IDisposable"])},function(e,t){var n=function(e){function t(t,n,r){void 0===r&&(r=PanelType.STREAM);var i=e.call(this)||this,a=egret.MainContext.instance.stage.stageHeight,o=egret.MainContext.instance.stage.stageWidth;i.store=t,i.prepare=""!=n;var s=800,c=(o-s)/2;if(i.prepare){var l=new StreamNetaPanel(n);l.x=(o-l.width)/2,l.y=a-l.height-20,i.addChild(l),i.streamPanel=l,s=l.width,c=l.x}var h=new NetaPanel(!0);h.x=c+(s-h.width),h.y=30,i.addChild(h),i.netaPanel=h;var u=new NetaSelectPanel(i.store,r,n,s-h.width-30,h.height);return u.x=c,u.y=30,i.addChild(u),i.netaSelectPanel=u,i.prepare||i.addEventListener(ItemList.ITEM_SELECTED,i.onItemClick,i),i.createTween(),i}return __extends(t,e),t.prototype.addEventListener=function(e,t,n,r,i){e==GameEvents.MENU_CANCEL||e==GameEvents.STREAM_START?(this.streamPanel&&this.streamPanel.addEventListener(e,t,n,r,i),this.netaSelectPanel&&this.netaSelectPanel.addEventListener(e,t,n,r,i)):e==ItemList.ITEM_SELECTED?this.netaSelectPanel.addEventListener(e,t,n,r,i):e==GameEvents.NETA_CONFIRM&&this.netaPanel.addEventListener(e,t,n,r,i)},t.prototype.setNeta=function(e){this.netaPanel.setNeta(e)},t.prototype.setStreamData=function(e,t,n,r,i){this.streamPanel.setStreamData(e,t,n,r,i)},t.prototype.startStream=function(e){this.createTween2(),this.streamPanel.startStream(e)},t.prototype.setCollabo=function(e){var t=new CollaboPanel(e);this.collaboPanel=t},t.prototype.finishStream=function(){this.streamPanel.finishStream()},t.prototype.showComment=function(e){this.streamPanel.showComment(e)},t.prototype.dispose=function(){this.parent&&this.parent.removeChild(this)},t.prototype.onItemClick=function(e){var t=e.data;this.setNeta(t.neta)},t.prototype.createTween=function(){var e=this;e._oriNetaPanelX=e.netaPanel.x,e._oriSelPanelX=e.netaSelectPanel.x,e._oriStreamPanelY=e.prepare?e.streamPanel.y:0,e.alpha=0,e.NetaPanelX=e._oriNetaPanelX+100,e.SelPanelX=e._oriSelPanelX-100,e.StreamPanelY=e._oriStreamPanelY+100,egret.Tween.get(this).to({alpha:1,NetaPanelX:e._oriNetaPanelX,SelPanelX:e._oriSelPanelX,StreamPanelY:e._oriStreamPanelY},200)},t.prototype.createTween2=function(){var e=this,t=this;egret.Tween.get(this).to({NetaPanelAlpha:0,NetaPanelX:t._oriNetaPanelX+100,SelPanelX:t._oriSelPanelX-100,StreamPanelY:200},200).call(function(){var t=e.collaboPanel,n=e.streamPanel;t&&(t.x=n.x,t.y=n.y-t.height,e.addChild(t))})},Object.defineProperty(t.prototype,"NetaPanelAlpha",{get:function(){return this.netaPanel.alpha},set:function(e){this.netaPanel.alpha=e,this.netaSelectPanel.alpha=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NetaPanelX",{get:function(){return this.netaPanel.x},set:function(e){this.netaPanel.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SelPanelX",{get:function(){return this.netaSelectPanel.x},set:function(e){this.netaSelectPanel.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"StreamPanelY",{get:function(){return this.prepare?this.streamPanel.y:0},set:function(e){this.prepare&&(this.streamPanel.y=e)},enumerable:!1,configurable:!0}),t}(egret.Sprite);window.StreamPreparePanel=n,__reflect(n.prototype,"StreamPreparePanel",["IDisposable"])},function(e,t){var n=function(e){function t(t,n,r,i){void 0===r&&(r=240),void 0===i&&(i=240);var a=e.call(this)||this;return a.vUrl=t,a.rUrl=n,a.width=r,a.height=i,a._switchJumpH=i/10,a._moveJumpH=i/3,a._cellSize=WorldData.cellSize,a.anchorOffsetY=i,a.loadPic(),a}return __extends(t,e),t.prototype.dispose=function(){var e=this;RES.destroyRes(e.vUrl),RES.destroyRes(e.rUrl),e.removeChildren(),e.parent&&e.parent.removeChildren()},t.prototype.setMode=function(e,t){void 0===t&&(t=!1);var n=this;if(!n._lock){n._lock=!0;var r,i;if(e?(r=n.rBmp,i=n.vBmp):(r=n.vBmp,i=n.rBmp),!t)return r.parent&&n.removeChild(r),n.addChildAt(i,0),void(n._lock=!1);var a=n.y;egret.Tween.get(n).to({y:n.y-n._switchJumpH},100).call(function(){r.parent&&n.removeChild(r),n.addChildAt(i,0)}).to({y:a},100).set({_lock:!1})}},Object.defineProperty(t.prototype,"lock",{get:function(){return this._lock},enumerable:!1,configurable:!0}),t.prototype.showFire=function(e){if(e&&!this.fireBmp){SoundManager.instance.playBgs("fire_mp3");var t=new EnjoFire(this.vBmp.width);t.y=this.height-t.height,this.addChild(t),this.fireBmp=t}else!e&&this.fireBmp&&(this.fireBmp.dispose(),this.fireBmp=null)},t.prototype.showLight=function(e){if(e){var t=new egret.GlowFilter(16777215,.7,200,200,5);this.filters=[t]}else this.filters=[]},t.prototype.showSleep=function(e){if(e&&!this.fireBmp){var t=new egret.Bitmap;t.texture=RES.getRes("icons_json#sleep"),this.addChild(t),this.sleepBmp=t,t.y=t.height/2,t.x=-t.width}else!e&&this.sleepBmp&&(this.sleepBmp.parent&&this.sleepBmp.parent.removeChild(this.sleepBmp),this.sleepBmp=null)},t.prototype.showAttacked=function(){var e=this.x;this.y;return egret.Tween.get(this,{loop:!1}).to({x:e-20},50).to({x:e+20},100).to({x:e},400,egret.Ease.elasticOut)},t.prototype.loadPic=function(){var e=this,t=new egret.Bitmap;t.texture=RES.getRes(e.vUrl);var n=t.width/t.height;t.height=e.height/1.5,t.width=t.height*n,t.x=-t.width/2,t.y=e.height-t.height,e.vBmp=t;var r=new egret.Bitmap;r.texture=RES.getRes(e.rUrl);var i=r.width/r.height;r.height=e.height/1.5,r.width=r.height*i,r.x=-r.width/2,r.y=e.height-r.height,e.rBmp=r,e.setMode(!0)},Object.defineProperty(t.prototype,"jumpHeight",{get:function(){return this._moveJumpH},enumerable:!1,configurable:!0}),t.prototype.startWalk=function(e,t){void 0===e&&(e=1),void 0===t&&(t=null),this._lock=!0,this._curMove=0,this._totMove=e,this._callBack=t,this.onStep()},t.prototype.onStep=function(){if(this._curMove>=this._totMove)return this._lock=!1,void(this._callBack&&this._callBack());this._curMove++;var e=this;e._moveArr=[e.x,e.y,e.x+e._cellSize/2,e.y-e._moveJumpH,e.x+e._cellSize,e.y],egret.Tween.get(e).to({factor:1},500).call(this.onStep,this)},Object.defineProperty(t.prototype,"factor",{get:function(){return 0},set:function(e){var t=this._moveArr;this.x=(1-e)*(1-e)*t[0]+2*e*(1-e)*t[2]+e*e*t[4],this.y=(1-e)*(1-e)*t[1]+2*e*(1-e)*t[3]+e*e*t[5]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vurl",{get:function(){return this.vUrl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rurl",{get:function(){return this.rUrl},enumerable:!1,configurable:!0}),t}(egret.Sprite);window.Chess=n,__reflect(n.prototype,"Chess",[])},function(e,t){var n=function(e){function t(t,n){void 0===t&&(t=""),void 0===n&&(n="");var r=e.call(this)||this,i=WorldData.cellSize;return r._cellSize=i,r.width=i,r.height=i,r.loadPic(t,n),r}return __extends(t,e),t.prototype.loadPic=function(e,t){void 0===e&&(e=""),void 0===t&&(t="");var n=8,r=this._cellSize-2*n,i=new egret.Sprite;if(i.graphics.lineStyle(n,0),i.graphics.beginFill(16534867),i.graphics.drawRect(n,n,r,r),i.graphics.endFill(),""!=e){var a=new egret.Bitmap;a.texture=RES.getRes(e),a.x=n,a.y=n,a.width=r,a.height=r,i.addChild(a)}this.v=i;var o=new egret.Sprite;if(o.graphics.lineStyle(n,0),o.graphics.beginFill(5136882),o.graphics.drawRect(n,n,r,r),o.graphics.endFill(),""!=t){var s=new egret.Bitmap;s.texture=RES.getRes(t),s.x=n,s.y=n,s.width=r,s.height=r,o.addChild(s)}this.r=o,this.setMode(!0)},t.prototype.setMode=function(e,t){void 0===t&&(t=!1);var n,r;e?(n=this.r,r=this.v):(n=this.v,r=this.r),n.parent&&this.removeChild(n),this.addChild(r)},t}(egret.Sprite);window.MapCell=n,__reflect(n.prototype,"MapCell",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/eui_skins/titlePage.exml",t.once(eui.UIEvent.ADDED_TO_STAGE,t.onAdded,t),t}return __extends(t,e),t.prototype.onAdded=function(e){egret.Tween.get(this).set({imgScale:0}).to({imgScale:1},500,egret.Ease.elasticOut),this.btnDes.addEventListener("touchTap",this.onDesClick,this),this.btnStart.addEventListener("touchTap",this.onStartClick,this)},t.prototype.onStartClick=function(e){void 0===e&&(e=null),this.dispatchEvent(new egret.Event(GameEvents.TO_PLAYER_SELECT))},t.prototype.onDesClick=function(e){if(!this.dp){var t=new DescriptPanel;t.x=(this.width-t.width)/2,t.y=(this.height-t.height)/2,t.addEventListener(GameEvents.MENU_CANCEL,this.onDesCancel,this),this.dp=t,this.addChild(t)}},t.prototype.onDesCancel=function(e){this.dp&&(this.dp.removeEventListener(GameEvents.MENU_CANCEL,this.onDesCancel,this),this.removeChild(this.dp),this.dp=null)},Object.defineProperty(t.prototype,"imgScale",{get:function(){return this.img1.scaleX},set:function(e){this.img1.scaleX=e,this.img2.scaleX=e,this.img1.scaleY=e,this.img2.scaleY=e},enumerable:!1,configurable:!0}),t}(eui.Component);window.TitlePage=n,__reflect(n.prototype,"TitlePage",[])},function(e,t){var n=function(){function e(e,t){void 0===t&&(t=null),this.stageW=egret.MainContext.instance.stage.stageWidth,this.stageH=egret.MainContext.instance.stage.stageHeight,this.wm=e,this.lastX=-1,this.lastY=-1,this.dragcb=t,e.addEventListener("touchBegin",this.onDragStart,this)}return e.prototype.onDragStart=function(e){var t=this;t.wm.addEventListener("touchMove",t.onDragging,t),t.wm.addEventListener("touchEnd",t.onDragEnd,t),t.lastX=e.stageX,t.lastY=e.stageY,t.dragcb&&t.dragcb(!0)},e.prototype.onDragging=function(e){var t=this;if(-1!=t.lastX){var n=this.wm,r=e.stageX-t.lastX,i=e.stageY-t.lastY,a=n.x+r,o=n.y+i;n.x=a,n.y=o,t.lastX=e.stageX,t.lastY=e.stageY}},e.prototype.onDragEnd=function(e){var t=this.wm,n=this;t.removeEventListener("touchMove",n.onDragging,n),t.removeEventListener("touchEnd",n.onDragEnd,n),t.addEventListener("touchBegin",n.onDragStart,n),n.lastX=-1,n.lastY=-1,n.dragcb&&n.dragcb(!1)},e}();window.DragController=n,__reflect(n.prototype,"DragController",[])},function(e,t){var n=function(e){function t(n){var r=e.call(this)||this;return r.addEventListener(eui.UIEvent.COMPLETE,r.onComplete,r),r.touchChildren=!0,r.touchEnabled=!0,r.width=egret.MainContext.instance.stage.stageWidth,r.height=egret.MainContext.instance.stage.stageHeight,r.chesses=[],r.skillBars=[],r.data=n,window.map=r,t.instance=r,r.skinName="resource/eui_skins/mainstage.exml",r}return __extends(t,e),t.prototype.addMenu=function(e){this.menuContainer.addChild(e)},t.prototype.removeMenu=function(e){e.parent&&e.parent.removeChild(e)},t.prototype.setMenuLayerVisible=function(e){this.menuContainer.visible=e},t.prototype.addChess=function(e,t,n,r){void 0===n&&(n=0),void 0===r&&(r=!0);var i=this.cellsArr[n],a=i.width/8,o=[];0==t?o=[1,3]:1==t?o=[5,3]:2==t?o=[3,7]:3==t&&(o=[7,7]),e.x=i.x+a*o[0],e.y=i.y+a*o[1],r&&this.chesses.push(e),this.chessArr[t]=n;var s=this.chesses.filter(function(t){return t.y>e.y}),c=this.chesses.length-s.length;this.mapContainer.addChildAt(e,c)},t.prototype.showRollNum=function(e,t){this.rollbtn.showRolledNum(e,t)},t.prototype.setTurnNum=function(e,t){void 0===t&&(t=!1),t?this.txtTurn.text="LAST TURN":this.txtTurn.text="TURN "+e},t.prototype.setMode=function(e){for(var t=0,n=this.cellsArr;t<n.length;t++){var r=n[t];r.setMode(e)}},t.prototype.walkChess=function(e,t,n,r){var i=this;if(void 0===r&&(r=!0),!this._lock){this._lock=!0;var a=this,o=a.chesses[e],s=a.chessArr[e],c=s+t,l=c>s?1:-1;c>=this.cellsArr.length&&(c-=this.cellsArr.length),a.focusTo(s,!0,200).call(function(){var t=a.mapContainer.x+o.x,h=a.mapContainer.y+o.y;a.tmpContainer.addChild(o),o.x=t,o.y=h;var u=o.y,p=o.y-o.jumpHeight;i._moveChess=o,i.stepObj={moveChessIndex:e,landY:u,jumpY:p,targetIndex:c,curIndex:s,direction:l},i.stepCallback=n,a.onStep(r,i)})}},Object.defineProperty(t.prototype,"moveChessY",{get:function(){return this._moveChess.y},set:function(e){this._moveChess&&(this._moveChess.y=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"moveMapX",{get:function(){return this.mapContainer.x},set:function(e){this.mapContainer.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"moveMapY",{get:function(){return this.mapContainer.y},set:function(e){this.mapContainer.y=e},enumerable:!1,configurable:!0}),t.prototype.onStep=function(e,t){var n=t.stepObj,r=n.moveChessIndex,i=n.landY,a=n.jumpY,o=n.targetIndex,s=n.curIndex,c=n.direction;if(s==o)return console.log("step finish"),t.addChess(t.chesses[r],r,o,!1),t._moveChess=null,t.stepObj=null,void(t._lock=!1);if(e){var l=s+c;l>=t.cellsArr.length&&(l-=t.cellsArr.length);var h=t.getPositionWhileFocus(l);egret.Tween.get(t).to({moveChessY:a,moveMapX:h.x,moveMapY:h.y},200).to({moveChessY:i},100).call(function(){t.stepObj.curIndex=l,t.stepCallback&&t.stepCallback(l,l==o)})}else{var h=t.getPositionWhileFocus(o);egret.Tween.get(t).to({moveChessY:a,moveMapX:h.x,moveMapY:h.y},200).to({moveChessY:i},100).call(function(){t.addChess(t.chesses[r],r,o,!1),t._moveChess=null,t.stepObj=null,t._lock=!1})}},t.prototype.unlock=function(){this._lock=!1},t.prototype.focusToLiver=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=200);var r=this.chessArr[e];return this.focusTo(r,t,n)},t.prototype.focusToLiverAsync=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=200);var r=this.chessArr[e];return this.focusToAsync(r,t,n)},t.prototype.focusTo=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=200);var r=this.cellsArr[e],i=this.mapContainer;return t?egret.Tween.get(i).to({x:this.width/2-r.x-r.width/2,y:this.height/2-r.y-r.height/2},n):egret.Tween.get(i).set({x:this.width/2-r.x-r.width/2,y:this.height/2-r.y-r.height/2})},t.prototype.focusToAsync=function(e,t,n){var r=this;return void 0===t&&(t=!1),void 0===n&&(n=200),new Promise(function(i,a){var o=r.cellsArr[e],s=r.mapContainer;t?egret.Tween.get(s).to({x:r.width/2-o.x-o.width/2,y:r.height/2-o.y-o.height/2},n).call(i):egret.Tween.get(s).set({x:r.width/2-o.x-o.width/2,y:r.height/2-o.y-o.height/2}).call(i)})},t.prototype.getPositionWhileFocus=function(e){var t=this.cellsArr[e],n=this.width/2-t.x-t.width/2,r=this.height/2-t.y-t.height/2;return new egret.Point(n,r)},t.prototype.dispose=function(){this.rollbtn.removeEventListener("touchTap",this.onRollBtnClicked,this),this.vrbtn.removeEventListener("touchTap",this.onVRBtnClicked,this),this.removeChildren()},t.prototype.showSkillBar=function(e){var t=new SkillBar(e);switch(e.type){case SkillType.POSITIVE:break;case SkillType.NEGATIVE:break;case SkillType.HIDDEN:SoundManager.instance.playBgs("success_mp3")}for(var n=this.skillBars,r=n.length,i=0;i<n.length;i++)if(null==n[i]){r=i;break}return t.x=this.width,t.y=100+r*(t.height+10),n[r]=t,this.topContainer.addChild(t),t.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onSkillBarRemoved,this),t},t.prototype.onSkillBarRemoved=function(e){var t=e.target,n=this.skillBars,r=n.indexOf(t);n[r]=null;for(var i=0,a=n;i<a.length;i++){var o=a[i];if(o)return}this.skillBars=[]},t.prototype.showNpcPanel=function(e){var t=new NpcPanel2(e);return t.x=this.width,t.y=this.height/2,this.topContainer.addChild(t),t},t.prototype.showGetNeta=function(e){var t=NetaGetPanel.addNetaToShow(e);return this.topContainer.addChild(t),t},t.prototype.showPlayerSelect=function(e,t){for(var n=[],r=0,i=e;r<i.length;r++){var a=i[r];n.push(a.iconUrl)}var o=new PlayerSelectPanel(n,t);return o.x=(this.width-o.width)/2,o.y=(this.height-o.height)/2,this.menuContainer.addChild(o),o},t.prototype.showEvtLog=function(e,t,n){void 0===t&&(t=""),void 0===n&&(n=null);var r=new EvtLog(e,t,n);return this.menuContainer.addChild(r),r},t.prototype.addCompenent=function(e,t){return"menu"==t?this.menuContainer.addChild(e):"top"==t&&this.topContainer.addChild(e),e},t.prototype.onComplete=function(e){var t=this;void 0===e&&(e=null);var n=this;n.removeEventListener(eui.UIEvent.COMPLETE,n.onComplete,n),n.rollbtn.addEventListener("touchTap",n.onRollBtnClicked,n),n.vrbtn.addEventListener("touchTap",n.onVRBtnClicked,n),n.infobtn.addEventListener("touchTap",n.onInfoBtnClick,n),n.bagbtn.addEventListener("touchTap",n.onBagBtnClicked,n),n.liverMenu.addEventListener(GameEvents.FOCUS2LIVER,n.onFocus2Liver,n);var r=WorldData.cellNum,i=WorldData.cellSize;n.mapContainer.width=r*i,n.mapContainer.height=r*i,n._dragController=new DragController(n.mapContainer,function(e){t.setIsDragging(e)});for(var a=4*r-4,o=[],s={},c=0;a>c;c++){var l=n.data.getCell(c),h=new MapCell(l.v.iconUrl,l.r.iconUrl),u=0,p=0;r>c?(u=c,p=0):2*r-1>c?(u=r-1,p=c-(r-1)):3*r-2>c?(u=3*r-3-c,p=r-1):4*r-3>c&&(u=0,p=4*r-4-c),h.x=u*i,h.y=p*i,h.cx=u,h.cy=p,o.push(h),s[u+"_"+p]=c,n.cellContainer.addChild(h)}n.cellsArr=o,n.cellsMap=s,n.chessArr=[0,0,0,0]},t.prototype.setIsDragging=function(e){this.bottomBar.touchEnabled=!e,this.bottomBar.touchChildren=!e},t.prototype.onFocus2Liver=function(e){if(!this._lock){var t=e.data,n=this.chessArr[t];this.focusTo(n,!0)}},t.prototype.onRollBtnClicked=function(e){this.dispatchEvent(new egret.Event(GameEvents.START_ROLL))},t.prototype.onVRBtnClicked=function(e){this.dispatchEvent(new egret.Event(GameEvents.VR_SWITCH))},t.prototype.onInfoBtnClick=function(e){this.dispatchEvent(new egret.Event(GameEvents.SHOW_LIVER_DETAIL))},t.prototype.onBagBtnClicked=function(e){this.dispatchEvent(new egret.Event(GameEvents.SHOW_NETA_BAG))},t.focusToPlayer=function(e){return t.instance?t.instance.focusToLiver(e.index,!0):null},t}(eui.Component);window.WorldMap=n,__reflect(n.prototype,"WorldMap",[])},function(e,t){var n=function(e){function t(t){return e.call(this)||this}return __extends(t,e),t}(BaseObj);window.BaseEvent=n,__reflect(n.prototype,"BaseEvent",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this)||this;if(n.name=t.name,n.des=t.des,n.iconUrl=t.iconUrl,n.netas=[],t.evt)for(var r=0,i=t.evt;r<i.length;r++){var a=i[r],o=a.type;switch(o){case EffectType.SHOW_MENU:n.getSelections(a.data),a["class"]?n.className=a["class"]:n.className="CustomMenu";break;case EffectType.GET_BUFF:n.buffName=a.data;break;case EffectType.GET_NETA:n.netas.push(a.data);break;case EffectType.SHOW_LOG:n.log=a.data}}return n}return __extends(t,e),t.prototype.trigger=function(e,t){if(this._mc=e,e&&this.buffName){var n=egret.getDefinitionByName(this.buffName);if(n){var r=new n(e);e.getBuff(r)}}if(this.className){var i=egret.getDefinitionByName(this.className),a=void 0;return a=this.selections?new EvtPanel(new i(this.selections),this.name,this.des,t.getNpc(e.npc)):new EvtPanel(new i,this.name,this.des,t.getNpc(e.npc)),a.addEventListener(GameEvents.ACTION_CONFIRM,this.onSelected,this),a}if(this.log){var o=new EvtLog(this.log);this.dispatchEvent(new ShowEvent(o,"menu")),o.once("touchTap",this.onLogTap,this)}return null},t.prototype.onSelected=function(e){},t.prototype.onLogTap=function(e){var t=this,n=e.currentTarget;n.removeEventListener("touchTap",this.onLogTap,this),n.dispose(),setTimeout(function(){t.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},200)},t.prototype.getSelections=function(e){if(!e)return void(this.selections=[]);for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];t.push(i)}this.selections=t},t.prototype.dipose=function(){},t}(BaseObj);window.MapEvent=n,__reflect(n.prototype,"MapEvent",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSelected=function(e){var t=e.data.index;switch(t){case 0:this.onFire();break;case 1:this.onDonguri();break;case 2:this._mc.npc.modify("elu",-.5),this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))}},t.prototype.onFire=function(){var e=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var t=this._mc,n=this.selections[0].data[0].data,r=NetaFactory.getNetaFromObj(n);t.npc.modify("elu",-2);var i=t.netaBag.modifyNeta(r,"get",!0);i.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,function(t){e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},this)},t.prototype.onDonguri=function(){var e=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var t=this._mc,n=this.selections[1].data[0].data,r=NetaFactory.getNetaFromObj(n),i=t.netaBag.modifyNeta(r,"get",!0);i.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,function(t){e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))
},this)},t}(MapEvent);window.ElfMori=n,__reflect(n.prototype,"ElfMori",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onLogTap=function(e){var t=e.currentTarget;t.dispose();var n=NetaFactory.getNeta(NetaType.TALK),r=this._mc.netaBag.modifyNeta(n,"get",!0);r.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onNetaRemoved,this)},t.prototype.onNetaRemoved=function(e){this._mc=null;var t=e.currentTarget;t.removeEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onNetaRemoved,this),this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},t}(MapEvent);window.EventGetNeta=n,__reflect(n.prototype,"EventGetNeta",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.trigger=function(t,n){return this._cell=n,e.prototype.trigger.call(this,t,n)},t.prototype.onLogTap=function(e){var t=this,n=e.currentTarget;n.removeEventListener("touchTap",this.onLogTap,this),n.dispose();var r=this._cell.npcs;if(0==r.length)return void this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH));for(var i=0,a=r;i<a.length;i++){var o=a[i];this._mc.npc.modify(Liver.allLivers[o].ID,1)}var s=this._cell.getNpc(this._mc.npc),c=new NpcPanel2(s);this.dispatchEvent(new ShowEvent(c,"top")),c.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,function(e){t.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},this)},t}(MapEvent);window.EventOffline=n,__reflect(n.prototype,"EventOffline",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onLogTap=function(e){var t=this,n=e.currentTarget;n.removeEventListener("touchTap",this.onLogTap,this),n.dispose();var r=this._mc,i=2,a=[];r.npc.modify("run",1),r.npc.modify("ib",1);for(var o=0,s=Liver.allLivers;o<s.length;o++){var c=s[o];if(("run"==c.ID||"ib"==c.ID)&&a.push(__assign(__assign({},c),{favor:r.npc.getF(c.ID)})),a.length==i)break}this.dispatchEvent(new NpcEvent(a));var l=this.netas[0],h=NetaFactory.getNetaFromObj(l),u=this._mc.netaBag.modifyNeta(h,"get",!0);u.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,function(e){t.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},this)},t}(MapEvent);window.EventRealBQ=n,__reflect(n.prototype,"EventRealBQ",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSelected=function(e){var t=e.data.index;switch(t){case 0:this.wishHandler();break;case 1:this.confessHandler();break;case 2:this.donateHandler();break;case 3:this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))}},t.prototype.wishHandler=function(){var e=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var t=Roll.random2(6)+1,n=this.selections[0].log;egret.Tween.get(this).wait(200).call(function(){e.dispatchEvent(new RollEvent(t,""))}).wait(1e3).call(function(){var r=new EvtLog(n);e.dispatchEvent(new ShowEvent(r,"menu"));var i=new LuckWish(e._mc,t);e._mc.getBuff(i),r.addEventListener("touchTap",function(t){r.dispose(),e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)})},t.prototype.confessHandler=function(){var e=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var t=this.selections[2].log;egret.Tween.get(this).wait(200).call(function(){var n=new EnjoGuard(e._mc);e._mc.removeBuff("Enjo"),e._mc.getBuff(n);var r=new EvtLog(t);e.dispatchEvent(new ShowEvent(r,"menu")),r.addEventListener("touchTap",function(t){r.dispose(),e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)})},t.prototype.donateHandler=function(){var e=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var t=this.selections[2].log,n=this._mc,r=n.money>1e4?1e4:n.money;egret.Tween.get(this).wait(200).call(function(){var i=new EvtLog(t);e.dispatchEvent(new ShowEvent(i,"menu")),i.addEventListener("touchTap",function(t){n.anti-=100,n.money-=r,i.dispose();for(var a=["sister","myzm","kanae"],o=[],s=0,c=a;s<c.length;s++){var l=c[s];n.npc.modify(l,1);for(var h=0,u=Liver.allLivers;h<u.length;h++){var p=u[h];p.ID==l&&o.push(__assign(__assign({},p),{favor:n.npc.getF(p.ID)}))}}var d=new NpcPanel2(o);d.once(eui.UIEvent.REMOVED_FROM_STAGE,function(t){e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e),e.dispatchEvent(new ShowEvent(d,"top"))},e)})},t}(MapEvent);window.EventRealChurch=n,__reflect(n.prototype,"EventRealChurch",[])},function(e,t){var n=function(e){function t(t){for(var n=e.call(this,t)||this,r=[],i=0,a=t.evt;i<a.length;i++){var o=a[i];r.push(o.data)}return n.logs=r,n}return __extends(t,e),t.prototype.trigger=function(e,t){this._mc=e,this.usedNeta=null;var n;"sasaki"==e.ID||"yashiro"==e.ID?(n=this.logs[0],this.usedNeta=NetaFactory.getNetaFromObj(this.netas[0])):e.edata.has3D?(n=this.logs[1],this.usedNeta=NetaFactory.getNetaFromObj(this.netas[0])):n=this.logs[2];var r=new EvtLog(n);return this.dispatchEvent(new ShowEvent(r,"menu")),r.once("touchTap",this.onLogTap,this),null},t.prototype.onLogTap=function(e){var t=this,n=e.currentTarget;n.dispose();var r=this._mc,i=this.usedNeta,a=0,o=[];void 0!=r.npc.modify("sasaki",1)&&a++,r.npc.modify("yashiro",1),a++;for(var s=0,c=Liver.allLivers;s<c.length;s++){var l=c[s];if(("sasaki"==l.ID||"yashiro"==l.ID)&&o.push(__assign(__assign({},l),{favor:r.npc.getF(l.ID)})),o.length==a)break}var h=new NpcPanel2(o);if(this.dispatchEvent(new ShowEvent(h,"top")),i){var u=r.netaBag.modifyNeta(i,"get",!0);u.once(eui.UIEvent.REMOVED_FROM_STAGE,function(e){t.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},this)}else h.once(eui.UIEvent.REMOVED_FROM_STAGE,function(e){t.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},this)},t}(MapEvent);window.EventRealDaipan=n,__reflect(n.prototype,"EventRealDaipan",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.trigger=function(t,n){var r=e.prototype.trigger.call(this,t,n),i=r.customMenu;return(t.money<2e5||!this._mc.edata.has3D)&&i.setItemsDisable(0,!0),t.money<5e4&&i.setItemsDisable(1,!0),this._mc.edata.has3_0&&i.setItemsDisable(2,!0),r},t.prototype.onSelected=function(e){var t=e.data.index;switch(t){case 0:this.getPresentHandler(this.selections[0].data,2e5);break;case 1:this.getPresentHandler(this.selections[1].data,5e4);break;case 2:this.get3_0Handler();break;case 3:this.rikuHandler();break;case 4:this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))}},t.prototype.getPresentHandler=function(e,t){var n=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var r=NetaFactory.getPresentNeta(e);setTimeout(function(){n._mc.money-=t;var e=n._mc.netaBag.modifyNeta(r,"get",!0);e.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,function(e){n.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},n)},200)},t.prototype.get3_0Handler=function(){var e=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var t=Roll.random(this._mc,"",!0),n=t.n,r=t.r,i="";r==RollResult.BIG_SUCCESS?i=this.selections[2].evt[1]:(i=this.selections[2].evt[0],r=""),egret.Tween.get(this).wait(200).call(function(){e.dispatchEvent(new RollEvent(n,r))}).wait(1e3).call(function(){var t=new EvtLog(i);e.dispatchEvent(new ShowEvent(t,"menu")),t.addEventListener("touchTap",function(n){t.dispose(),r==RollResult.BIG_SUCCESS?(e._mc.edata.has3_0=!0,e.getPresentHandler(e.selections[2].data,0)):e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)})},t.prototype.rikuHandler=function(){var e=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var t,n,r=Roll.random(this._mc,"commu",!0),i=r.n,a=r.r,o=this.selections[3].roll.evt;switch(a){case RollResult.BIG_SUCCESS:this._mc.edata.major?(n=o[0].log2,t=function(t){var n=t.currentTarget;n.dispose();var r=e.netas[1],i=NetaFactory.getNetaFromObj(r),a=e._mc.netaBag.modifyNeta(i,"get",!0);a.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,function(t){e._mc=null,e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)}):(n=o[0].log,t=function(t){var n=t.currentTarget;n.dispose();var r=e.netas[0],i=NetaFactory.getNetaFromObj(r),a=e._mc.netaBag.modifyNeta(i,"get",!0);e._mc.edata.major=!0,a.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,function(t){e._mc=null,e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)});break;case RollResult.SUCCESS:n=o[1].log,t=function(t){var n=t.currentTarget;n.dispose();var r=new SpeedyRaise(e._mc,5);e._mc.getBuff(r),e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))};break;case RollResult.NORMAL:n=o[2].log,t=function(t){var n=t.currentTarget;n.dispose(),e._mc.money+=2e4,setTimeout(function(){e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},2e3)};break;case RollResult.FAIL:n=o[3].log,t=function(t){var n=t.currentTarget;n.dispose(),e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))};break;case RollResult.BIG_FAIL:n=o[4].log,t=function(t){var n=t.currentTarget;n.dispose(),e._mc.npc.all-=.5,e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))}}egret.Tween.get(this).wait(200).call(function(){e.dispatchEvent(new RollEvent(i,a))}).wait(1500).call(function(){var r=new EvtLog(n);e.dispatchEvent(new ShowEvent(r,"menu")),r.addEventListener("touchTap",t,e)})},t}(MapEvent);window.EventRealEnkr=n,__reflect(n.prototype,"EventRealEnkr",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.trigger=function(t,n){var r=e.prototype.trigger.call(this,t,n),i=this;i._ep=r,i._gachaCounter=0,i._rate=5,i._successed=-1,i._devilSuccessed=-1,i._isdevil=!1;var a=r.customMenu;return a&&i._mc.money<1e4&&(a.setItemsDisable(0,!0),a.setItemsDisable(1,!1)),r},t.prototype.onSelected=function(e){var t=e.data.index;switch(t){case 0:this.gachaHandler();break;case 1:this.onLeave()}},t.prototype.gachaHandler=function(){var e=this,t=this;t._gachaCounter++,t._rate<10&&(t._rate+=1),egret.Tween.get(this).set({panelVisible:!1}).call(function(){var n,r,i=t.selections[0].roll,a=i.evt,o=Roll.random2(i.range);o<t._rate?(-1==t._successed&&(t._successed=t._gachaCounter),t._isdevil&&-1==t._devilSuccessed&&(t._devilSuccessed=t._gachaCounter),n=a[1].data,r=a[1].log):(n=a[0].data,r=a[0].log);var s=t._ep.customMenu;s&&t._mc.money<1e4?(s.setItemsDisable(0,!0),s.setItemsDisable(1,!1),r=a[3].log,t._ep.modiflyContents(t.name,r)):t._isdevil?(t._gachaCounter>=10||-1!=t._devilSuccessed)&&(s.setItemsDisable(0,!1),s.setItemsDisable(1,!1)):t._ep.modiflyContents(t.name,r),e.dispatchEvent(new RollEvent(o,n))}).wait(500).set({panelVisible:!0})},t.prototype.onLeave=function(){var e=this,t=e._gachaCounter>=10||-1!=e._devilSuccessed;if(e._mc.edata.devil>=3&&e._gachaCounter>=1&&e._mc.money>=1e4&&!t)return e._isdevil=!0,void egret.Tween.get(e).to({panelVisible:!1}).wait(200).call(function(){var t=e._ep.customMenu,n=e.selections[0].roll.evt[2].log;e._ep.modiflyContents(e.name,n),t&&(t.setItemsDisable(0,!1),t.setItemsDisable(1,!0))}).set({panelVisible:!0});var n=e.getGachaNeta();n?egret.Tween.get(e).set({panelVisible:!1}).wait(200).call(function(){e._mc.netaBag.modifyNeta(n,"get",!0)}).wait(1e3).call(function(){e._ep.dispose(),e._ep=null,e._mc=null,e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))}):(e._ep.dispose(),e._ep=null,e._mc=null,e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH)))},t.prototype.getGachaNeta=function(){var e=this;return 0==e._gachaCounter?null:e._gachaCounter>=10?new Neta(e.netas[3]):1==e._successed&&1==e._gachaCounter?new Neta(e.netas[0]):-1!=e._successed&&e._gachaCounter<5?new Neta(e.netas[1]):-1==e._successed&&e._gachaCounter<10?new Neta(e.netas[2]):-1!=e._successed&&e._gachaCounter>=5?new Neta(e.netas[2]):void 0},Object.defineProperty(t.prototype,"panelVisible",{get:function(){return this._ep&&this._ep.visible},set:function(e){this._ep&&(this._ep.visible=e)},enumerable:!1,configurable:!0}),t}(MapEvent);window.EventRealGacha=n,__reflect(n.prototype,"EventRealGacha",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.trigger=function(t,n){this._cell=n;var r=e.prototype.trigger.call(this,t,n),i=r.customMenu;return(t.money<5e4||0==n.npcs.length)&&i.setItemsDisable(1,!0),t.money<1e4&&i.setItemsDisable(0,!0),r},t.prototype.onSelected=function(e){var t=e.data.index;switch(t){case 0:this.soloHandler();break;case 1:this.collaboHandler();break;case 2:this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))}},t.prototype.soloHandler=function(){var e=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var t=this._mc,n=Roll.random(t,"",!0),r=n.n,i=n.r;i!=RollResult.BIG_SUCCESS&&(t.money-=1e4);var a=this.getRollData(i),o=a[0],s=a[1],c=a[2],l=(a[3],this.selections[0].roll.data[o].log),h=-1!=s?this.netas[s]:null;egret.Tween.get(this).wait(100).call(function(){e.dispatchEvent(new RollEvent(r,i));var n=new StomachFull(t,c);t.getBuff(n)}).wait(500).call(function(){var n=new EvtLog(l);e.dispatchEvent(new ShowEvent(n,"menu")),n.addEventListener("touchTap",function(r){if(n.dispose(),h){var i=NetaFactory.getNetaFromObj(h),a=t.netaBag.modifyNeta(i,"get",!0);a.addEventListener(GameEvents.NETA_INFO_FINISH,function(t){e._mc=null,e._cell=null,e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)}else e._mc=null,e._cell=null,e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)})},t.prototype.collaboHandler=function(){var e=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var t=this._mc,n=Roll.random(t,"",!0),r=n.n,i=n.r;i!=RollResult.BIG_SUCCESS&&(t.money-=5e4);var a=this.getRollData(i),o=a[0],s=a[1],c=a[2],l=a[3],h=this.selections[1].roll.data[o].log,u=this.netas[s];egret.Tween.get(this).wait(100).call(function(){e.dispatchEvent(new RollEvent(r,i));var n=new StomachFull(t,c);t.getBuff(n);for(var a=0,o=e._cell.npcs;a<o.length;a++){var s=o[a];t.npc.modify(Liver.allLivers[s].ID,l)}var h=e._cell.getNpc(e._mc.npc);e.dispatchEvent(new NpcEvent(h))}).wait(500).call(function(){var n=new EvtLog(h);e.dispatchEvent(new ShowEvent(n,"menu")),n.addEventListener("touchTap",function(r){n.dispose();var i=NetaFactory.getNetaFromObj(u),a=t.netaBag.modifyNeta(i,"get",!0);a.addEventListener(GameEvents.NETA_INFO_FINISH,function(t){e._mc=null,e._cell=null,e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)},e)})},t.prototype.getRollData=function(e){var t,n,r,i;switch(e){case RollResult.BIG_SUCCESS:t=0,n=0,r=10,i=1;break;case RollResult.SUCCESS:t=1,n=1,r=8,i=1;break;case RollResult.NORMAL:t=2,n=-1,r=5,i=1;break;case RollResult.FAIL:t=3,n=2,r=3,i=.5;break;case RollResult.BIG_FAIL:t=4,n=3,r=1,i=.5}return[t,n,r,i]},t}(MapEvent);window.EventRealJojoen=n,__reflect(n.prototype,"EventRealJojoen",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.trigger=function(t,n){var r=e.prototype.trigger.call(this,t,n),i=r.customMenu;return i&&t.money<100&&i.setItemsDisable(0,!0),r},t.prototype.onSelected=function(e){var t=e.data.index;switch(t){case 0:this.buyHandler();break;case 1:this.kickHandler();break;case 2:this.bottomHandler();break;case 3:this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))}},t.prototype.buyHandler=function(){var e=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var t=NetaFactory.getNetaFromObj(this.netas[0]);egret.Tween.get(this).wait(200).call(function(){e._mc.money-=100;var n=e._mc.netaBag.modifyNeta(t,"get",!0);n&&n.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,function(t){e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)})},t.prototype.kickHandler=function(){var e=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var t,n,r=Roll.random(this._mc,"strength",!0),i=r.n,a=r.r;switch(a){case RollResult.BIG_SUCCESS:n=this.selections[1].roll.evt[0].log,t=function(t){var n=t.currentTarget;n.dispose();var r=NetaFactory.getNetaFromObj(e.netas[0]),i=e._mc.netaBag.modifyNeta(r,"get",!0);i&&i.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,function(t){e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)};break;case RollResult.SUCCESS:n=this.selections[1].roll.evt[1].log,t=function(t){var n=t.currentTarget;n.dispose(),e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))};break;case RollResult.NORMAL:n=this.selections[1].roll.evt[2].log,t=function(t){var n=t.currentTarget;n.dispose();var r=new Stop(e._mc,1);e._mc.getBuff(r),e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))};break;case RollResult.FAIL:n=this.selections[1].roll.evt[3].log,t=function(t){var n=t.currentTarget;n.dispose(),e._mc.money-=3e4,setTimeout(function(){e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},1500)};break;case RollResult.BIG_FAIL:n=this.selections[1].roll.evt[4].log,t=function(t){var n=t.currentTarget;n.dispose(),e._mc.money-=2e4,e._mc.data.strength-=1,setTimeout(function(){e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},1500)}}egret.Tween.get(this).wait(500).call(function(){e.dispatchEvent(new RollEvent(i,a))}).wait(1e3).call(function(){var r=new EvtLog(n);e.dispatchEvent(new ShowEvent(r,"menu")),r.addEventListener("touchTap",t,e)})},t.prototype.bottomHandler=function(){var e=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var t,n,r=Roll.random(this._mc,"",!0),i=r.n,a=r.r;switch(a){case RollResult.BIG_SUCCESS:n=this.selections[2].roll.evt[0].log,t=function(t){var n=t.currentTarget;n.dispose();var r=NetaFactory.getNetaFromObj(e.netas[1]),i=e._mc.netaBag.modifyNeta(r,"get",!0);e._mc.money-=1e4,i&&i.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,function(t){e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)};break;case RollResult.SUCCESS:n=this.selections[2].roll.evt[1].log,this._mc.money+=100,t=function(t){var n=t.currentTarget;n.dispose(),e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))};break;case RollResult.NORMAL:n=this.selections[2].roll.evt[2].log,this._mc.money+=10,t=function(t){var n=t.currentTarget;n.dispose(),e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))};break;case RollResult.FAIL:n=this.selections[2].roll.evt[3].log,this._mc.data.sense-=1,t=function(t){var n=t.currentTarget;n.dispose(),e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))};break;case RollResult.BIG_FAIL:n=this.selections[2].roll.evt[4].log,this._mc.netaBag.lostNeta(NetaType.TALK),t=function(t){var n=t.currentTarget;n.dispose(),e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))}}egret.Tween.get(this).wait(500).call(function(){e.dispatchEvent(new RollEvent(i,a))}).wait(1e3).call(function(){var r=new EvtLog(n);e.dispatchEvent(new ShowEvent(r,"menu")),r.addEventListener("touchTap",t,e)})},t}(MapEvent);window.EventRealMachine=n,__reflect(n.prototype,"EventRealMachine",[])},function(e,t){var n=function(e){function t(t){for(var n=e.call(this,t)||this,r=[],i=0,a=t.evt;i<a.length;i++){var o=a[i];r.push(o.data)}return n.logs=r,n}return __extends(t,e),t.prototype.trigger=function(e,t){var n,r,i=this;e.edata.major?(n=this.logs[0],r=NetaFactory.getNetaFromObj(this.netas[1])):e.subscribe>=3e5&&e.sing>=8?(n=this.logs[1],r=NetaFactory.getNetaFromObj(this.netas[0]),e.edata.major=!0):n=e.subscribe>=2e5&&e.sing>=6?this.logs[2]:e.subscribe>=1e5&&e.sing>=4?this.logs[3]:this.logs[4];var a=new EvtLog(n);return this.dispatchEvent(new ShowEvent(a,"menu")),a.once("touchTap",function(t){if(a.dispose(),r){var n=e.netaBag.modifyNeta(r,"get",!0);n.once(eui.UIEvent.REMOVED_FROM_STAGE,function(e){i.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},i)}else i.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},this),null},t}(MapEvent);window.EventRealMajor=n,__reflect(n.prototype,"EventRealMajor",[])},function(e,t){var n=function(e){function t(t){for(var n=e.call(this,t)||this,r=[],i=0,a=t.evt;i<a.length;i++){var o=a[i];r.push(o.data)}return n.logs=r,n}return __extends(t,e),t.prototype.trigger=function(e,t){for(var n,r,i=this,a=0,o=0,s=0,c=e.npc.IDs;s<c.length;s++){var l=c[s],h=e.npc.getF(l);if(h>=3&&o++,o>=2)break;if(h>=4){a++;break}}a>=2||o>=2?(n=this.logs[1],r=NetaFactory.getNetaFromObj(this.netas[0])):n=this.logs[0];var u=new EvtLog(n);return this.dispatchEvent(new ShowEvent(u,"menu")),u.once("touchTap",function(t){if(u.dispose(),r){var n=e.netaBag.modifyNeta(r,"get",!0);n.once(eui.UIEvent.REMOVED_FROM_STAGE,function(e){i.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},i)}else i.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},this),null},t}(MapEvent);window.EventRealNJU=n,__reflect(n.prototype,"EventRealNJU",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.trigger=function(t,n){this._cell=n;var r=e.prototype.trigger.call(this,t,n),i=r.customMenu;return t.money<1e4&&i.setItemsDisable(0,!0),t.money<1e5&&i.setItemsDisable(1,!0),r},t.prototype.onSelected=function(e){var t=e.data.index;switch(t){case 0:this.pachinkoHandler(1e4);break;case 1:this.pachinkoHandler(1e5);break;case 2:this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))}},t.prototype.pachinkoHandler=function(e){var t=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var n=this._mc,r=Roll.random(n,"",!0),i=r.n,a=r.r,o=0;switch(a){case RollResult.BIG_SUCCESS:o=e+10*e;break;case RollResult.SUCCESS:o=e+2*e;break;case RollResult.NORMAL:o=e+e+(Roll.random2(2e3)-1e3);break;case RollResult.FAIL:o=-e/2;break;case RollResult.BIG_FAIL:o=-e}this._mc.money-=e,egret.Tween.get(this).wait(500).call(function(){t.dispatchEvent(new RollEvent(i,a))}).wait(1e3).call(function(){t._mc.money+=o;var e=new PayGainPanel(o);e.addEventListener("touchTap",function(n){t._mc=null,e.dispose(),t.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},t),t.dispatchEvent(new ShowEvent(e,"menu"))})},Object.defineProperty(t.prototype,"mcMoney",{get:function(){return this._mc?this._mc.money:0},set:function(e){this._mc&&(this._mc.money=e)},enumerable:!1,configurable:!0}),t}(MapEvent);window.EventRealPachinko=n,__reflect(n.prototype,"EventRealPachinko",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onLogTap=function(e){var t=e.currentTarget;t.dispose();var n=NetaFactory.getNetaFromObj(this.netas[0]),r=this._mc.netaBag.modifyNeta(n,"get",!0);r.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onNetaRemoved,this)},t.prototype.onNetaRemoved=function(e){this._mc=null;var t=e.currentTarget;t.removeEventListener(eui.UIEvent.REMOVED_FROM_STAGE,this.onNetaRemoved,this),this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},t}(MapEvent);window.EventRealGetSpecNeta=n,__reflect(n.prototype,"EventRealGetSpecNeta",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.trigger=function(e,t){this._mc=e,this.createStore();var n=e.checkIfSkillsTriggered(GamePhrase.GO_SHOPPING,Roll.random3());n.triggerBag(this.store);var r=new EvtPanelShop(this._mc,this.name,this.des,this.store,PanelType.SHOP);return r.addEventListener(GameEvents.MENU_CANCEL,this.onCancel,this),r.addEventListener(GameEvents.NETA_CONFIRM,this.onBuy,this),this.panel=r,r},t.prototype.onBuy=function(e){var t=e.data.neta;if(t){this._mc.netaBag.modifyNeta(t,"get");var n={neta:t,selected:!1,holded:!0};this._mc.money-=t.value,this.panel.refresh(n)}},t.prototype.createStore=function(){for(var e=new NetaBag,t=["netas_game_1_json","netas_song_1_json","device_1_json"],n=0,r=t;n<r.length;n++){var i=r[n],a=RES.getRes(i);if(a)for(var o=0,s=a;o<s.length;o++){var c=s[o],l=NetaFactory.getNetaFromObj(c);e.modifyNeta(l,"get",!1,1,!1)}}this.store=e},t.prototype.onCancel=function(e){this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},t}(MapEvent);window.EventShop=n,__reflect(n.prototype,"EventShop",[]);var r=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.createStore=function(){for(var e=new NetaBag,t=["device_2_json"],n=0,r=t;n<r.length;n++){var i=r[n],a=RES.getRes(i);if(a)for(var o=0,s=a;o<s.length;o++){var c=s[o],l=NetaFactory.getNetaFromObj(c);e.modifyNeta(l,"get",!1,1,!1)}}this.store=e},t.prototype.trigger=function(e,t){this._mc=e,this.createStore();var n=new EvtPanelShop(this._mc,this.name,this.des,this.store,PanelType.SHOP);return n.addEventListener(GameEvents.MENU_CANCEL,this.onCancel,this),n.addEventListener(GameEvents.NETA_CONFIRM,this.onBuy,this),this.panel=n,n},t}(n);window.EventShop2=r,__reflect(r.prototype,"EventShop2",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.cleanCurEvent=function(){this._curEvent&&(this._curEvent.removeEventListener(GameEvents.EVENT_START,this.onEvent,this),this._curEvent.removeEventListener(GameEvents.EVENT_FINISH,this.onEvent,this),this._curEvent.dipose(),this._curEvent=null)},t.prototype.trigger=function(e,t){this.cleanCurEvent();var n=["events_real_2_json"],r=Math.floor(Math.random()*n.length),i=RES.getRes(n[r]);r=Math.floor(Math.random()*i.length);var a=i[r],o=MapEvent;a["class"]&&(o=egret.getDefinitionByName(a["class"])),o||(o=MapEvent);var s=new o(a);return this._curEvent=s,s.addEventListener(GameEvents.EVENT_START,this.onEvent,this),s.addEventListener(GameEvents.STAT_CHANGE,this.onEvent,this),s.addEventListener(GameEvents.EVENT_FINISH,this.onEvent,this),s.trigger(e,t)},t.prototype.onEvent=function(e){this.dispatchEvent(e)},t}(MapEvent);window.EventSpecial=n,__reflect(n.prototype,"EventSpecial",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSelected=function(e){var t=e.data.index;switch(t){case 0:this.dispatchEvent(new egret.Event(GameEvents.EVENT_START)),this.onSummon();break;case 1:this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))}},t.prototype.onSummon=function(){var e=this,t=this.selections[0].roll,n=Roll.random2(t.range);0==n&&(n=1),egret.Tween.get(this).wait(200).call(function(){e.dispatchEvent(new RollEvent(n,""))}).wait(500).call(function(){switch(n){case 1:e.debiHandler();break;case 2:e.inuiHandler();break;case 3:e.roaHandler();break;case 4:e.maimotoHandler();break;case 5:e.luluHandler();break;case 6:e.maoHandler()}})},t.prototype.debiHandler=function(){for(var e=this._mc,t=this.selections[0].roll.evt[0],n=e.netaBag.device,r=0,i=0;i<n.length;){var a=n[i];if("unchi"==a.ID)r+=.5*a.times;else{if("unchi2"!=a.ID){i++;continue}r+=.1*a.times}e.netaBag.modifyNeta(a,"use",!1,a.times)}var o="";0==r?o=t.log:(o=t.log2,e.npc.modify("debi",r));var s=new EvtLog(o);this.dispatchEvent(new ShowEvent(s,"menu")),s&&s.addEventListener("touchTap",this.onLogTap,this)},t.prototype.inuiHandler=function(){var e=this._mc,t=this.selections[0].roll.evt[1],n=t.log,r=new EvtLog(n);this.dispatchEvent(new ShowEvent(r,"menu")),e.npc.modify("inui",1),r&&r.addEventListener("touchTap",this.onLogTap,this)},t.prototype.roaHandler=function(){var e=this,t=this._mc,n=this.selections[0].roll.evt[2],r=n.effect[0].data,i=n.log,a=NetaFactory.getNetaFromObj(r),o=new EvtLog(i);this.dispatchEvent(new ShowEvent(o,"menu")),t.npc.modify("roa",1),o&&o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(n){o.dispose();var r=t.netaBag.modifyNeta(a,"get",!0);r.addEventListener(GameEvents.NETA_INFO_FINISH,function(t){e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)},this)},t.prototype.maimotoHandler=function(){for(var e=this._mc,t=this.selections[0].roll.evt[3],n=t.log,r=0;r<e.buffs.length;r++){var i=e.buffs[r];if("Enjo"==i.ID){i.off(),e.buffs.splice(r,1),n=t.log2;break}}var a=new EvtLog(n);this.dispatchEvent(new ShowEvent(a,"menu")),e.npc.modify("maimoto",1),a&&a.addEventListener("touchTap",this.onLogTap,this)},t.prototype.luluHandler=function(){var e=this._mc,t=this.selections[0].roll.evt[4],n=t.log;e.getBuff(new Sleep(e,1));var r=new EvtLog(n);this.dispatchEvent(new ShowEvent(r,"menu")),e.npc.modify("ruru",1),r&&r.addEventListener("touchTap",this.onLogTap,this)},t.prototype.maoHandler=function(){var e=this,t=this._mc,n=this.selections[0].roll.evt[5],r=n.effect[0].data,i=n.log,a=NetaFactory.getNetaFromObj(r),o=new EvtLog(i);this.dispatchEvent(new ShowEvent(o,"menu")),t.npc.modify("mao",1),o&&o.addEventListener(egret.TouchEvent.TOUCH_TAP,function(n){o.dispose();var r=t.netaBag.modifyNeta(a,"get",!0);r.addEventListener(GameEvents.NETA_INFO_FINISH,function(t){e.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},e)},this)},t}(MapEvent);window.Makai=n,__reflect(n.prototype,"Makai",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onSelected=function(e){var t=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var n=e.data.index,r=this.selections[n].data,i=this.selections[n].log,a=Roll.random(this._mc,"neta"==r?"sense":"luck",!0),o=a.n,s=a.r,c=this.getUpRate(s),l=null,h=null,u=null;egret.Tween.get(this).wait(200).call(function(){t.dispatchEvent(new RollEvent(o,s))}).wait(500).call(function(){switch(r){case"commu|money":var e=1e4*c*(1+t._mc.strength/10);i=t.getLog(s,i,r),l=function(){t._mc.data.commu=c,t._mc.money+=e},u=t.checkIfGetNeta(t.selections[n].evt,s);break;case"neta":switch(i=t.getLog(s,i,"neta"),s){case RollResult.BIG_SUCCESS:u=NetaFactory.getNetaWhichStatBetween(9,-1);break;case RollResult.SUCCESS:u=NetaFactory.getNetaWhichStatBetween(6,-1);break;case RollResult.NORMAL:u=NetaFactory.getNetaWhichStatBetween(6,9);break;case RollResult.FAIL:u=NetaFactory.getNetaWhichStatBetween(-1,6);break;case RollResult.BIG_FAIL:u=NetaFactory.getNetaWhichStatBetween(-1,3)}break;case"random":var a=["commu","talk","strength","sense","sing","game","tech"],o=Roll.random2(a.length),p=a[o];0==c&&(c=.5),i=t.getLog(s,i,p),l=function(){t._mc.data[p]+=c};break;default:i=t.getLog(s,i,""),u=t.checkIfGetNeta(t.selections[n].evt,s),l=function(){t._mc.data[r]+=c}}h=function(){if(u){t._el.dispose(),t._el=null;var e=t._mc.netaBag.modifyNeta(u,"get",!0);e.once(eui.UIEvent.REMOVED_FROM_STAGE,function(e){t._mc=null,t.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},t)}else t.onLogTap()};var d=new EvtLog(i);t.dispatchEvent(new ShowEvent(d,"menu")),t._el=d,l&&l(),d.once("touchTap",function(e){h&&h()},t)})},t.prototype.checkIfGetNeta=function(e,t){if(!e)return null;var n=Roll.random(this._mc,"sense",!1),r=(n.n,n.r);if(r==RollResult.SUCCESS||r==RollResult.BIG_SUCCESS)switch(t){case RollResult.BIG_SUCCESS:case RollResult.SUCCESS:return NetaFactory.getNetaFromObj(e[0].data);case RollResult.NORMAL:return NetaFactory.getNetaFromObj(e[1].data);case RollResult.FAIL:case RollResult.BIG_FAIL:return NetaFactory.getNetaFromObj(e[2].data)}return null},t.prototype.onLogTap=function(e){void 0===e&&(e=null),this._el.dispose(),this._el=null,this._mc=null,this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},t.prototype.getUpRate=function(e){switch(e){case RollResult.BIG_SUCCESS:return 2;case RollResult.SUCCESS:return 1.5;case RollResult.NORMAL:return 1;case RollResult.FAIL:return.5;case RollResult.BIG_FAIL:return.1}},t.prototype.getLog=function(e,t,n){void 0===n&&(n="");var r="",i="",a=RES.getRes("words_json");switch(n){case"":return r=a.log_prop[e],t.replace("{result}",r);case"neta":return r=a.log_neta[e],e==RollResult.BIG_FAIL?r:t.replace("{result}",r);case"commu|money":var o=a.log_baito[e];return r=o[0],i=o[1],t.replace("{result1}",r).replace("{result0}",i);default:return t.replace("{result}",a.propName[n])}},t}(MapEvent);window.NormalReal=n,__reflect(n.prototype,"NormalReal",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.trigger=function(t,n){return this._cell=n,e.prototype.trigger.call(this,t,n)},t.prototype.onSelected=function(e){var t=e.data.ty,n=e.data.index;switch(t){case GameEvents.WATCH:this.onWatch(n);break;case GameEvents.REST:this.onRest(n)}},t.prototype.onWatch=function(e){var t=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));for(var n=Roll.random(this._mc,"",!0),r=n.n,i=n.r,a=[],o=this._mc,s=0,c=this._cell.npcs;s<c.length;s++){var l=c[s];a.push(Liver.allLivers[l])}var h="",u=function(){t.onLogTap()};switch(i){case RollResult.BIG_SUCCESS:h=this.selections[e].evt[4].log;for(var p=0,d=a;p<d.length;p++){var f=d[p];
o.npc.modify(f.ID,1)}u=function(){var e=NetaFactory.getNeta(NetaType.TALK),n=t._mc.netaBag.modifyNeta(e,"get",!0);n&&(t._el&&t._el.dispose(),n.addEventListener(GameEvents.NETA_INFO_FINISH,t.onLogTap,t))};break;case RollResult.SUCCESS:h=this.selections[e].evt[3].log;for(var v=0,m=a;v<m.length;v++){var f=m[v];o.npc.modify(f.ID,1)}break;case RollResult.NORMAL:h=this.selections[e].evt[2].log;var _=Math.floor(Math.random()*a.length);o.npc.modify(a[_].ID,1),h=h.replace("{result}",a[_].name);break;case RollResult.FAIL:h=this.selections[e].evt[1].log;var g=Math.floor(Math.random()*a.length);o.npc.modify(a[g].ID,.5),h=h.replace("{result}",a[g].name);break;case RollResult.BIG_FAIL:h=this.selections[e].evt[0].log;for(var E=0,y=a;E<y.length;E++){var f=y[E];o.npc.modify(f.ID,.1)}}egret.Tween.get(this).wait(200).call(function(){t.dispatchEvent(new RollEvent(r,i))}).wait(500).call(function(){var e=t._cell.getNpc(t._mc.npc);t.dispatchEvent(new NpcEvent(e));var n=new EvtLog(h);t.dispatchEvent(new ShowEvent(n,"menu")),t._el=n,n.addEventListener("touchTap",function(e){u&&u()},t)})},t.prototype.onRest=function(e){var t=this;this.dispatchEvent(new egret.Event(GameEvents.EVENT_START));var n=this.selections[e].log,r=Roll.random(this._mc,"",!0),i=r.n,a=r.r,o=this.getUpRate(a),s=["commu","talk","strength","sense","sing","game","tech"],c=Math.floor(Math.random()*s.length),l=s[c];0==o&&(o=.5);var h=this.getLog(n,a,l),u=function(){console.log(l+"+"+o),t._mc.data[l]+=o};egret.Tween.get(this).wait(200).call(function(){t.dispatchEvent(new RollEvent(i,""))}).wait(500).call(function(){u();var e=new EvtLog(h);t.dispatchEvent(new ShowEvent(e,"menu")),t._el=e,e.addEventListener("touchTap",function(e){t.onLogTap()},t)})},t.prototype.onLogTap=function(e){void 0===e&&(e=null),this._el&&this._el.dispose(),this._el=null,this._mc=null,this.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},t.prototype.getLog=function(e,t,n){void 0===n&&(n="");var r=RES.getRes("words_json");return e.replace("{result}",r.propName[n])},t.prototype.getUpRate=function(e){switch(e){case RollResult.BIG_SUCCESS:return 2;case RollResult.SUCCESS:return 1.5;case RollResult.NORMAL:return 1;case RollResult.FAIL:return.5;case RollResult.BIG_FAIL:return.1}},t}(MapEvent);window.NormalVirtual=n,__reflect(n.prototype,"NormalVirtual",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onLogTap=function(e){var t=this,n=e.currentTarget;n&&(n.removeEventListener("touchTap",this.onLogTap,this),n.dispose());try{this._mc.money+=this._mc.income;var r=NetaFactory.getNetaFromObj(this.netas[0]),i=this._mc.netaBag.modifyNeta(r,"get",!0);i&&i.once(eui.UIEvent.REMOVED_FROM_STAGE,function(e){t.dispatchEvent(new egret.Event(GameEvents.EVENT_FINISH))},this)}catch(a){console.log(a)}},t}(MapEvent);window.StartPoint=n,__reflect(n.prototype,"StartPoint",[])},function(e,t){var n=function(){function e(){this.objs=RES.getRes("comment_1_json")}return e.prototype.getComment=function(e){var t,n=Math.random()>.5;if(n)switch(e){case StreamType.GAME:t=this.objs.game;break;case StreamType.SING:t=this.objs.sing;default:t=this.objs.normal}else t=this.objs.normal;return t[Math.floor(Math.random()*t.length)]},e.prototype.getEnjoComment=function(){var e=this.objs.enjo;return e[Math.floor(Math.random()*e.length)]},e.prototype.getAccidentComment=function(){var e=this.objs.accident;return e[Math.floor(Math.random()*e.length)]},e}();window.CommentFactory=n,__reflect(n.prototype,"CommentFactory",[])},function(module,exports){var EffectHandler=function(_super){function EffectHandler(){var e=_super.call(this)||this;return e.effect=[],e}return __extends(EffectHandler,_super),EffectHandler.prototype.handle=function(e,t,n){switch(void 0===n&&(n=null),e){case EffectType.STAT_CHANGE:case EffectType.TEMP_STAT_CHANGE:try{this.onStatChange(t,n)}catch(r){console.error(r)}break;case EffectType.GET_NETA:var i=NetaFactory.getNetaFromObj(t);n.bag&&n.bag.modifyNeta(i,"get",!0);break;case EffectType.GET_BUFF:var a=t;if(!a)return;var o=egret.getDefinitionByName(a);if(!o||!n.player&&!n.tgtPlayer)return;if(n.tgtPlayer)for(var s=0,c=n.tgtPlayer;s<c.length;s++){var l=c[s],h=new o(l);l.getBuff(h)}else{var h=new o(n.player);n.player.getBuff(h)}break;case EffectType.REMOVE_BUFF:n.player&&n.player.removeBuff(t);case EffectType.PLAY_BGS:SoundManager.instance.playBgs(t)}},EffectHandler.prototype.onStatChange=function(data,target){for(var changeStr=data,changeArr=changeStr.split(","),_i=0,changeArr_1=changeArr;_i<changeArr_1.length;_i++){var s=changeArr_1[_i],marr=s.match(/\{.+\}/g);if(0!=marr.length){var prop=marr[0],propArr=prop.substr(1,prop.length-2).split(".");if(!target[propArr[0]])return;var ori=target[propArr[0]][propArr[1]],evalS=s.replace(marr[0],ori);target[propArr[0]][propArr[1]]=eval(evalS)}}},EffectHandler.prototype.checkReq=function(data,target){if(!data)return!0;for(var arr=data.split(","),_i=0,arr_1=arr;_i<arr_1.length;_i++){var s=arr_1[_i],marr=s.match(/\{.+\}/g);if(0!=marr.length){var prop=marr[0],propArr=prop.substr(1,prop.length-2).split("."),ori=target[propArr[0]][propArr[1]],evalS=s.replace(marr[0],ori),result=eval(evalS);if(!result)return!1}}return!0},EffectHandler}(BaseObj);window.EffectHandler=EffectHandler,__reflect(EffectHandler.prototype,"EffectHandler",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this)||this;n.ID=egret.getQualifiedClassName(n),n.name=t.name,n.des=t.des,n.type=n.str2type(t.type);var r=t.data;return n.owner=t.owner?t.owner:null,n._times=r.times,n.effect=r.effect?r.effect:[],n.iconUrl=t.iconUrl?t.iconUrl:"netaicons_json#empty",t.value?n.value=t.value:n.type==NetaType.GAME?n.value=5e3:n.type==NetaType.SONG?n.value=500:n.value=0,n.type!=NetaType.DEVICE&&(n.pop=r.pop,n.safe=r.safe,n.meme=r.meme,n._oriData={pop:n.pop,safe:n.safe,meme:n.meme}),n}return __extends(t,e),Object.defineProperty(t.prototype,"times",{get:function(){return this._times},set:function(e){-1>=e&&(e=-1),this._times=e},enumerable:!1,configurable:!0}),t.prototype.onUse=function(e){if(this.effect)for(var t=this.effect,n=0,r=t;n<r.length;n++){var i=r[n];if("use"==i.trigger){if(i.req){var a=this.checkReq(i.req,e);if(!a)continue}this.handle(i.type,i.data,e)}}},t.prototype.onGain=function(e){if(this.effect)for(var t=this.effect,n=0,r=t;n<r.length;n++){var i=r[n];if("get"==i.trigger){if(i.req){var a=this.checkReq(i.req,e);if(!a)continue}this.handle(i.type,i.data,e)}}},t.prototype.reset=function(){var e=this;e.pop=e._oriData.pop,e.meme=e._oriData.meme,e.safe=e._oriData.safe},t.prototype.str2type=function(e){switch(e){case"song":return NetaType.SONG;case"daily":return NetaType.TALK;case"game":return NetaType.GAME;case"spec":return NetaType.SPEC;case"present":return NetaType.PRESENT;case"device":return NetaType.DEVICE}},t}(EffectHandler);window.Neta=n,__reflect(n.prototype,"Neta",[]);var r=function(e){function t(t){var n=e.call(this,t)||this;return n._reduce=t.reduce?t.reduce:5,n._usage=0,n}return __extends(t,e),t.prototype.onUse=function(t){e.prototype.onUse.call(this,t),this._usage++,this._usage==this._reduce&&(console.log(this.name+"效果衰减"),this._oriData.pop=Math.round(this._oriData.pop/2))},t}(n);window.GameNeta=r,__reflect(r.prototype,"GameNeta",[]);var i=function(e){function t(t){var n=e.call(this,t)||this;return n.songReq=t.songReq?t.songReq:1,n.cd=t.cd?t.cd:3,n.curCD=0,n}return __extends(t,e),t.prototype.startCD=function(){this.curCD=this.cd+1},t.prototype.clearCD=function(){this.curCD=0},t.prototype.onCD=function(){this.curCD>0&&this.curCD--},Object.defineProperty(t.prototype,"usable",{get:function(){return 0==this.curCD},enumerable:!1,configurable:!0}),t}(n);window.SongNeta=i,__reflect(i.prototype,"SongNeta",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this,t)||this,r=t.data;return n._trigger=!0,n._useable=r.use?r.use:!1,n.target=r.tgt?r.tgt:EffectTarget.SELF,n}return __extends(t,e),t.prototype.onHold=function(e){if(this.effect&&this._trigger)for(var t=this.effect,n=0,r=t;n<r.length;n++){var i=r[n];if("hold"==i.trigger){if(i.req){var a=this.checkReq(i.req,e);if(!a)continue}console.log(this.name+" 发动效果"),this.handle(i.type,i.data,e)}}},t.prototype.onUse=function(t){e.prototype.onUse.call(this,t),this.dispatchEvent(new egret.Event(GameEvents.DEVICE_FINISH))},Object.defineProperty(t.prototype,"useable",{get:function(){return this._useable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trigger",{get:function(){return this._trigger},set:function(e){this._trigger=e},enumerable:!1,configurable:!0}),t}(Neta);window.Device=n,__reflect(n.prototype,"Device",[]);var r=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(n);window.PC=r,__reflect(r.prototype,"PC",[])},function(e,t){var n=function(){function e(e){void 0===e&&(e=null),this.talk=[],this.game=[],this.song=[],this.spec=[],this.present=[],this.device=[],this.mc=e,this._valueLock=-1}return e.prototype.test=function(){for(var e=["neta_spec_1_json","netas_daily_1_json","netas_game_1_json","netas_present_1_json","netas_song_1_json","device_1_json","device_2_json","device_spec_json"],t=0,n=e;t<n.length;t++){var r=n[t],i=RES.getRes(r);if(i)for(var a=0,o=i;a<o.length;a++){var s=o[a],c=NetaFactory.getNetaFromObj(s);c.type==NetaType.TALK?this.modifyNeta(c,"get",!1,3,!1):this.modifyNeta(c,"get",!1,1,!1)}}},e.prototype.filterNetas2Select=function(e){var t=this.filterNetas0(e),n=t.map(function(e){return{neta:e,selected:!1}});return n},e.prototype.filterNeta2Shop=function(e,t){var n=this.filterNetas0(e),r=t.filterNetas0(e),i=this._valueLock,a=n.map(function(e){for(var t=e.value>i&&-1!=i,n=0,a=r;n<a.length;n++){var o=a[n];if(o.name==e.name)return{neta:e,selected:!1,holded:!0,valueLock:t}}return{neta:e,selected:!1,valueLock:t}});return a},e.prototype.filterNetas0=function(e){switch(e){case NetaType.DEVICE:return this.device;case NetaType.GAME:return this.game;case NetaType.SONG:return this.song;case NetaType.TALK:return this.talk;case NetaType.SPEC:return this.spec;case NetaType.PRESENT:return this.present}},e.prototype.modifyNeta=function(e,t,n,r,i){if(void 0===n&&(n=!1),void 0===r&&(r=1),void 0===i&&(i=!0),e){try{"get"==t?this.add(e,r):"use"==t&&this.minus(e,r)}catch(a){console.log("================"),console.log("modifyNeta Failed : ",e)}var o=null;if("get"==t&&n&&(o=NetaGetPanel.addNetaToShow(e),this.mc.dispatchEvent(new ShowEvent(o,"top"))),"get"==t&&i){var s={bag:this};if(this.mc){var c=this.mc;s=__assign(__assign({},s),{mc:c.ddata,mc2:c.data,mc3:c.edata,player:c})}e.onGain(s);var l=this.mc.checkIfSkillsTriggered(GamePhrase.GET_NETA,Math.random());l.triggerNeta(e)}return o}},e.prototype.lostNeta=function(e,t){if(void 0===t&&(t=-1),e!=NetaType.PRESENT&&e!=NetaType.SPEC){var n=this.filterNetas0(e);if(0!=n.length){var r=Math.floor(Math.random()*n.length),i=n[r];-1!=t&&i.times>t?(console.log("neta "+i.name+" 使用次数减少 "+t),i.times-=t,i.times<=0&&n.splice(r,1)):(console.log("丢失neta ：",i.name),n.splice(r,1))}}},e.prototype.checkDeviceChange=function(){for(var e=this.device.filter(function(e){return void 0!=e.passTurn}),t=0,n=e;t<n.length;t++){var r=n[t],i=r.passTurn();if(i)for(var a=0,o=i;a<o.length;a++){var s=o[a];this.modifyNeta(s.newNeta,"get",!0,s.num),this.modifyNeta(r,"use",!1,s.num)}}},e.prototype.add=function(e,t){void 0===t&&(t=1);var n;switch(e.type){case NetaType.DEVICE:n=this.device;break;case NetaType.TALK:n=this.talk;break;case NetaType.GAME:n=this.game;break;case NetaType.SONG:n=this.song;break;case NetaType.PRESENT:n=this.present;break;case NetaType.SPEC:n=this.spec}for(var r=0,i=n;r<i.length;r++){var a=i[r];if(a.name==e.name){if(-1==a.times)return;return void(a.times+=t)}}-1!=e.times&&(e.times=t),n.push(e)},e.prototype.minus=function(e,t){void 0===t&&(t=1);var n;switch(e.type){case NetaType.DEVICE:n=this.device;break;case NetaType.TALK:n=this.talk;break;case NetaType.GAME:n=this.game;break;case NetaType.SONG:n=this.song;break;case NetaType.PRESENT:n=this.present;break;case NetaType.SPEC:n=this.spec}for(var r=0;r<n.length;r++){var i=n[r];if(i.name==e.name){if(e.type==NetaType.SONG&&e.startCD(),i.times<=-1)return;return i.times-=t,void(i.times<=0&&n.splice(r,1))}}},Object.defineProperty(e.prototype,"valueLock",{set:function(e){this._valueLock=e},enumerable:!1,configurable:!0}),e}();window.NetaBag=n,__reflect(n.prototype,"NetaBag",[])},function(e,t){var n=function(){function e(){}return e.getNeta=function(e){var t,n,r=Neta;switch(e){case NetaType.TALK:n="netas_daily_1_json";break;case NetaType.GAME:n="netas_game_1_json";break;case NetaType.SONG:n="netas_song_1_json",r=SongNeta;break;default:return null}t=RES.getRes(n);var i=t[Math.floor(Math.random()*t.length)];if(i["class"]){var a=egret.getDefinitionByName(i["class"]);a&&(r=a)}return new r(i)},e.getNetaFromObj=function(e){try{var t=Neta;if("device"==e.type?t=Device:"song"==e.type?t=SongNeta:"game"==e.type&&(t=GameNeta),e["class"]){var n=egret.getDefinitionByName(e["class"]);n&&(t=n)}return new t(e)}catch(r){return console.log(r),null}},e.getNetaWhichStatBetween=function(e,t){var n=Neta,r=RES.getRes("netas_daily_1_json");r=r.filter(function(n){var r=n.data,i=r.meme+r.safe+r.pop;return(-1==e||i>e)&&(-1==t||t>=i)});var i=r[Math.floor(Math.random()*r.length)];if(i["class"]){var a=egret.getDefinitionByName(i["class"]);a&&(n=a)}return new n(i)},e.getPresentNeta=function(t){for(var n,r=RES.getRes("netas_present_1_json"),i=0,a=r;i<a.length;i++){var o=a[i];if(o.name==t){n=o;break}}return e.getNetaFromObj(n)},e.getGiftNeta=function(t){for(var n=["device_spec_json","neta_spec_1_json"],r=0,i=n;r<i.length;r++)for(var a=i[r],o=RES.getRes(a),s=0,c=o;s<c.length;s++){var l=c[s];if(l.owner&&l.owner==t)return e.getNetaFromObj(l)}},e.getGiftNeta2=function(t){var n=["device_spec_json","neta_spec_1_json"],r=[];e:for(var i=0,a=n;i<a.length;i++)for(var o=a[i],s=RES.getRes(o),c=0,l=s;c<l.length;c++){var h=l[c];if(h.owner&&t.indexOf(h.owner)>=0&&r.push(h),3==r.length)break e}if(0==r.length)return null;var u=Math.floor(Math.random()*r.length);return e.getNetaFromObj(r[u])},e.getEvtNeta=function(t){for(var n=["neta_spec_2_json"],r=0,i=n;r<i.length;r++)for(var a=i[r],o=RES.getRes(a),s=0,c=o;s<c.length;s++){var l=c[s];if(l.req&&l.req==t)return e.getNetaFromObj(l)}},e}();window.NetaFactory=n,__reflect(n.prototype,"NetaFactory",[])},function(e,t){var n=function(e){function t(t,n,r,i){var a,o=e.call(this)||this;return o.rollCb=null,o.netas=[],o.collaboMems=[],o.mc=t,o.totPop=0,o.totSafe=0,o.totMeme=0,o.pop=0,o.safe=0,o.meme=0,o.shouldGetSpecNeta=0,o.startTurn=n,o.ty=r,o.npcs=i,o.netaNumMap=(a={},a[NetaType.GAME]=0,a[NetaType.SONG]=0,a[NetaType.TALK]=0,a[NetaType.SPEC]=0,a[NetaType.PRESENT]=0,a),o.baseRate=o.getBaseRate(),o.accidentBaseRate=0,o.enjoBaseRate=1,o.ty==StreamType.GAME&&(o.accidentBaseRate=1),o.ty==StreamType.TALK&&(o.enjoBaseRate=1.5),o}return __extends(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this.ty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"streamPreparePanel",{set:function(e){this.panel=e,this.panel.addEventListener(ItemList.ITEM_SELECTED,this.onNetaChanged,this)},enumerable:!1,configurable:!0}),t.prototype.start=function(e){void 0===e&&(e=null);var t=this;t.totPop+=t.netas.length*t.pop,t.totSafe+=t.netas.length*t.safe,t.totMeme+=t.netas.length*t.meme,t.totSubAdd=0,t.totSubSpd=0,t.curIndex=-1,t.accident=0,t.enjo=0,t.superchat=0,t.rollCb=e,t.comment=new CommentFactory;var n=this.mc;t.tgtObj={player:n,stream:t,mc:n.ddata,mc2:n.data,mc3:n.edata};for(var r=0,i=t.mc.buffs;r<i.length;r++){var a=i[r];a.effect(t.tgtObj)}for(var o=0,s=t.mc.netaBag.device;o<s.length;o++){var c=s[o];c.onHold(t.tgtObj)}if(t.getIfCollabo(),t.collaboMems.length>0){console.log("联动配信 ： ",t.collaboMems);var l=t.mc.checkIfSkillsTriggered(GamePhrase.IN_STREAM_COLLABO,Roll.random3());l.triggerStream(this);for(var h=[t.mc.iconUrl],u=0,p=this.npcs;u<p.length;u++){var d=p[u];d.joined&&h.push(d.iconUrl)}t.panel.setCollabo(h)}console.log("===================="),console.log("直播效果基础倍率 : "+t.baseRate),console.log("直播事故基础倍率 : "+t.accidentBaseRate),console.log("炎上发生基础倍率 : "+t.enjoBaseRate),t.panel.setStreamData(t.netas,t.totPop,t.totSafe,t.totMeme,t.netaRequest),t.panel.startStream(t.mc),t.netaCalcTimeout()},t.prototype.netaCalcTimeout=function(){var e=this;setTimeout(function(){e.onNetaCalc()},1e3)},t.prototype.onNetaCalc=function(e){void 0===e&&(e=null);var t=this;if(t.curAccident=!1,t.curEnjo=!1,t.curIndex++,t.curIndex==t.netas.length)return void t.streamFinish();var n=t.netas[t.curIndex],r=t.mc.checkIfSkillsTriggered(GamePhrase.USE_NETA,0,Roll.random3);r.triggerNeta(n,this);var i=Roll.random(t.mc),a=i.n,o=i.r;t.rollCb&&t.rollCb(a,o),n.onUse(t.tgtObj),n.type==NetaType.SONG&&n.startCD(),t.mc.netaBag.modifyNeta(n,"use");var s=t.getIfAccident(),c=s||o==RollResult.BIG_SUCCESS?!1:t.getIfEnjo(n.safe),l=t.baseRate+t.getNetaRate(n),h=t.getRollRate(o),u=Math.round(500*n.pop*l*h),p=Math.round(10*n.meme*l*h);if(s){var d=t.mc.checkIfSkillsTriggered(GamePhrase.STREAM_ACCIDENT,Roll.random3());d.triggerStream(this)}if(c){var f=t.mc.buffs.filter(function(e){return e.ID.indexOf("EnjoGuard")>=0});f.length>0&&(console.log("炎上被Buff防止"),c=!1)}if(c){var f=t.mc.netaBag.device.filter(function(e){return"灭火筒"==e.name});if(f.length>0){console.log("炎上被灭火筒防止");var v=f[0];t.mc.netaBag.modifyNeta(v,"use"),c=!1}}if(c){var d=t.mc.checkIfSkillsTriggered(GamePhrase.STREAM_ENJO,Roll.random3());d.triggerStream(this)}t.curAccident=s,t.curEnjo=c,t.curAccident&&(o==RollResult.NORMAL?(u=Math.round(u/2),p=Math.round(p/2)):(o==RollResult.FAIL||o==RollResult.BIG_FAIL)&&(u=0,p=0),t.accident++,t.mc.anti+=5,SoundManager.instance.playBgs("dededon_short_mp3"),this.dispatchEvent(new egret.Event(GameEvents.STREAM_ACCIDENT))),t.curEnjo&&(t.mc.getBuff(new Enjo(t.mc)),t.mc.anti+=10,this.dispatchEvent(new egret.Event(GameEvents.STREAM_ENJO))),t.curEnjo||t.curAccident||(o==RollResult.SUCCESS?t.shouldGetSpecNeta++:o==RollResult.BIG_SUCCESS&&(t.shouldGetSpecNeta+=3)),t.totSubAdd+=u,t.totSubSpd+=p,t.superchat+=100*Math.round(u/100),console.log("========================="),console.log("neta : ",n.name),console.log("pop:"+(n.pop+t.pop)+"  safe:"+(n.safe+t.safe)+"  meme:"+(n.meme+t.meme)),console.log("增长率 : ",u,p),t.setComments(10,s,c),t.panel.streamPanel.useNeta(t.curIndex,t.totSubAdd,u,t.totSubSpd,p,s,c,t.netaCalcTimeout,t),n.reset()},t.prototype.setComments=function(e,t,n){void 0===e&&(e=20),void 0===t&&(t=!1),void 0===n&&(n=!1);for(var r=[],i=this,a=0;e>a;a++){var o=void 0;o=t?i.comment.getAccidentComment():n?i.comment.getEnjoComment():i.comment.getComment(i.ty),o.indexOf("{liver}")>=0&&(o=o.replace("{liver}",i.mc.name)),r.push(o)}i.panel.showComment(r)},t.prototype.streamFinish=function(){var e=this,t=e.mc.checkIfSkillsTriggered(GamePhrase.AFTER_STREAM,Roll.random3());t.triggerStream(e),e.panel.finishStream();for(var n=0,r=e.collaboMems;n<r.length;n++){var i=r[n];e.mc.npc.modify(i,1)}e.mc.subscribe+=e.totSubAdd,e.mc.money+=e.superchat,e.mc.increase+=e.totSubSpd;for(var a=0,o=e.mc.buffs;a<o.length;a++){var s=o[a];s.streamCD()}var c={isLong:e.isLong,ty:e.ty,startTurn:e.startTurn,totPop:e.totPop,totSafe:e.totSafe,totMeme:e.totMeme,totSub:e.totSubAdd,accident:e.accident,enjo:e.enjo,sc:e.superchat};e.mc.stream.push(c);var l=new egret.Event(GameEvents.STREAM_END);if(l.data=c,e.shouldGetSpecNeta>=3&&e.collaboMems.length>0){var h=NetaFactory.getGiftNeta2(e.collaboMems);if(h){var u=e.mc.netaBag.modifyNeta(h,"get",!0);u.once(eui.UIEvent.REMOVED_FROM_STAGE,function(t){e.dispatchEvent(new egret.Event(GameEvents.STREAM_END))},this)}else e.dispatchEvent(new egret.Event(GameEvents.STREAM_END))}else e.dispatchEvent(new egret.Event(GameEvents.STREAM_END))},t.prototype.getBaseRate=function(){var e=this,t=1,n="";switch(e.ty){case StreamType.GAME:t+=e.mc.game/10,n="StreamBuffGame";break;case StreamType.TALK:t+=e.mc.talk/10,n="StreamBuffTalk";break;case StreamType.SING:t+=e.mc.sing/10,n="StreamBuffSing";break;case StreamType.PRESENT:t=1.25+e.mc.tech/10}t+=e.mc.strength/50;for(var r=0,i=e.mc.buffs;r<i.length;r++){var a=i[r];if(a.ID==n){t+=.2;break}"StreamBuffCollabo"==a.ID&&e.collaboMems.length>0&&(t+=.2)}return t},t.prototype.getNetaRate=function(e){var t=this.mc,n=1;switch(e.type){case NetaType.GAME:n=t.game/10;break;case NetaType.SONG:n=t.sing/10;var r=e;t.sing<r.songReq&&(console.log(t.name+"的歌力"+t.sing+"未达到歌曲"+r.name+"的要求"+r.songReq),n/=2);break;case NetaType.TALK:n=t.talk/10;break;case NetaType.SPEC:n=t.sense/10;break;case NetaType.PRESENT:n=2+t.tech/10}return n},t.prototype.getRollRate=function(e){var t=1;switch(e){case RollResult.BIG_SUCCESS:t=2;break;case RollResult.SUCCESS:t=1.5;case RollResult.NORMAL:break;case RollResult.FAIL:t=.5;break;case RollResult.BIG_FAIL:t=.1}return t},t.prototype.getIfCollabo=function(){var e=this.type==StreamType.PRESENT;this.collaboMems=[];for(var t=this.mc.commu,n=0,r=this.npcs;n<r.length;n++){var i=r[n],a=i.favor,o=Roll.random2(100),s=10*a*(1+t/5);(s>o||e)&&(this.collaboMems.push(i.ID),i.joined=!0)}},t.prototype.getIfAccident=function(){var e=Roll.random2(10-this.accidentBaseRate+this.mc.tech);return 1>=e},t.prototype.getIfEnjo=function(e){if(-1==e)return!1;var t=Roll.random2(100+this.totSafe),n=e>0?this.totSafe/(e*this.netas.length)*this.enjoBaseRate+5:5;return n>t},t.prototype.getIfBan=function(){},t.prototype.onNetaChanged=function(e){var t=this,n=e.data;if(n.neta.type==NetaType.SONG){var r=n.neta;if(!r.usable&&t.panel)return void t.panel.setNeta(n.neta)}n.selected=!n.selected;var i=n.selected?1:-1;if(t.netaNumMap[n.neta.type]+=i,t.totPop+=n.neta.pop*i,t.totMeme+=n.neta.meme*i,-1!=n.neta.safe&&(t.totSafe+=n.neta.safe*i),n.selected){var a=!1;t.ty==StreamType.GAME?a=t.checkUniqueNeta(StreamType.GAME,NetaType.GAME,n.neta):t.ty==StreamType.PRESENT&&(a=t.checkUniqueNeta(StreamType.PRESENT,NetaType.PRESENT,n.neta)),a||t.netas.push(n.neta)}else{var o=t.netas.indexOf(n.neta);o>=0&&t.netas.splice(o,1)}t.panel&&(t.panel.setNeta(n.neta),t.panel.setStreamData(t.netas,t.totPop,t.totSafe,t.totMeme,t.netaRequest))},t.prototype.checkUniqueNeta=function(e,t,n){var r=this;if(r.ty==e&&n.type==t){if(r.netas.length>0&&r.netas[0].type==t){var i=r.netas[0];r.totPop-=i.pop,-1!=i.safe&&(r.totSafe-=i.safe),r.totMeme-=i.meme,r.netaNumMap[i.type]--,r.netas[0]=n}else r.netas.unshift(n);return!0}return!1},Object.defineProperty(t.prototype,"netaRequest",{get:function(){switch(this.ty){case StreamType.PRESENT:return 1==this.netaNumMap[NetaType.PRESENT];case StreamType.SING:return this.netaNumMap[NetaType.SONG]>=3;case StreamType.TALK:return this.netaNumMap[NetaType.TALK]+this.netaNumMap[NetaType.SPEC]>=3;case StreamType.GAME:return 1==this.netaNumMap[NetaType.GAME]}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalPop",{get:function(){return this.totPop},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalSafe",{get:function(){return this.totSafe},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalMeme",{get:function(){return this.totMeme},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totSubAdd",{get:function(){return this._totSubAdd},set:function(e){this._totSubAdd=e,this.panel&&this.panel.streamPanel.setTotSub(this._totSubAdd)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totSubSpd",{get:function(){return this._totSubSpd},set:function(e){this._totSubSpd=e,this.panel&&this.panel.streamPanel.setSubSpd(this._totSubSpd)},enumerable:!1,configurable:!0}),t}(egret.EventDispatcher);window.Stream=n,__reflect(n.prototype,"Stream",[])},function(e,t){var n=function(e){function t(t,n){var r=e.call(this)||this;return r._r=t,r._v=n,r.npcs=[],r}return __extends(t,e),t.prototype.getNpc=function(e){for(var t=[],n=0,r=this.npcs;n<r.length;n++){var i=r[n],a=Liver.allLivers[i],o=e[a.ID];t.push({ID:a.ID,name:a.name,des:a.des,iconUrl:a.iconUrl,favor:o})}return t},t.prototype.trigger=function(e,t){var n=this.getEvent(e);if(this._curE=n,this._events)for(var r=0,i=this._events;r<i.length;r++){var a=i[r];n.addEventListener(a,this.onEvent,this)}return n.trigger(t,this)},t.prototype.addEventListener=function(t,n,r,i,a){this._events||(this._events=[]),this._events.push(t),e.prototype.addEventListener.call(this,t,n,r,i,a)},t.prototype.removeEventListener=function(t,n,r,i){this._curE&&this._curE.removeEventListener(t,this.onEvent,this),e.prototype.removeEventListener.call(this,t,n,r,i)},t.prototype.onEvent=function(e){this.dispatchEvent(e)},t.prototype.getEvent=function(e){return e?this._v:this._r},Object.defineProperty(t.prototype,"r",{get:function(){return this._r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"v",{get:function(){return this._v},enumerable:!1,configurable:!0}),t}(egret.EventDispatcher);window.CellData=n,__reflect(n.prototype,"CellData",[]);var r=function(){function e(){this.len=4*WorldData.cellNum-4,this.createR(),this.createV();for(var e=[],t=0;t<this.len;t++){var r=new n(this.r[this.rI[t]],this.v[this.vI[t]]);e.push(r)}this.datas=e}return e.prototype.getCell=function(e){return this.datas[e]},e.prototype.createR=function(){var e=this,t=RES.getRes("events_real_1_json");t=t.filter(function(e){return!e.disable});for(var n=[],r=[],i=[],a=[],o=0;o<t.length;o++){var s=t[o],c=MapEvent;s["class"]&&(c=egret.getDefinitionByName(s["class"]),c||(c=MapEvent)),n.push(new c(t[o])),i.push(o)}for(var l=0;l<e.len;l++)0!=l?(r.push(-1),a.push(l)):(r.push(0),i.splice(0,1));for(var h=1;h<e.len/4;h++)r[h]=1;a.splice(0,e.len/4-1);for(var u=0;u<i.length;){var p=a.splice(Math.floor(Math.random()*a.length),1)[0];r[p]=i[u],t[i[u]].times&&(t[i[u]].times--,0==t[i[u]].times)?i.splice(u,1):u++}for(;a.length>0;){var p=a.splice(Math.floor(Math.random()*a.length),1)[0],d=Math.random()<.6,f=d?0:Math.floor(Math.random()*i.length);r[p]=i[f],t[i[f]].times&&(t[i[f]].times--,0==t[i[f]].times)&&i.splice(f,1)}e.r=n,e.rI=r},e.prototype.createV=function(){var e=this,t=RES.getRes("events_virtual_1_json");t=t.filter(function(e){return!e.disable});for(var n=[],r=[],i=[],a=[],o=0;o<t.length;o++){var s=t[o],c=MapEvent;s["class"]&&(c=egret.getDefinitionByName(s["class"]),c||(c=MapEvent)),n.push(new c(t[o])),i.push(o)}for(var l=0;l<e.len;l++)0!=l?(r.push(-1),a.push(l)):(r.push(0),i.splice(0,1));for(var h=1;h<e.len/4;h++)r[h]=1;a.splice(0,e.len/4-1);for(var u=0;u<i.length;){var p=a.splice(Math.floor(Math.random()*a.length),1)[0];r[p]=i[u],t[i[u]].times&&(t[i[u]].times--,0==t[i[u]].times)?i.splice(u,1):u++}for(;a.length>0;){var p=a.splice(Math.floor(Math.random()*a.length),1)[0],d=Math.random()<=.5,f=d?0:Math.floor(Math.random()*i.length);r[p]=i[f],t[i[f]].times&&(t[i[f]].times--,0==t[i[f]].times)&&i.splice(f,1)}e.v=n,e.vI=r},e.prototype.shuffleLiver=function(){var e=this,t=e.datas;e.getAllNpcsList();for(var n=0,r=t;n<r.length;n++){var i=r[n];i.npcs=[]}for(var a=0;a<e.allNpcIndexes.length;a++){var o=Math.floor(Math.random()*e.allNpcIndexes.length),s=e.allNpcIndexes[o];e.allNpcIndexes[o]=e.allNpcIndexes[a],e.allNpcIndexes[a]=s}for(var a=0;a<e.len;a++)t[a].npcs.push(e.allNpcIndexes[a]);for(var a=e.len;a<e.allNpcIndexes.length;a++){var c=Math.floor(Math.random()*(e.len-1))+1;t[c].npcs.length>=3||t[c].npcs.push(e.allNpcIndexes[a])}},e.prototype.getAllNpcsList=function(){if(!this.allNpcIndexes){for(var e=[],t=0;t<Liver.allLivers.length;t++)e.push(t);this.allNpcIndexes=e}},e}();window.MapData=r,__reflect(r.prototype,"MapData",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this,GameEvents.STAT_CHANGE)||this;return n.data={type:"skill",skill:t},n}return __extends(t,e),t}(egret.Event);window.SkillEvent=n,__reflect(n.prototype,"SkillEvent",[]);var r=function(e){function t(){var t=e.call(this,GameEvents.STAT_CHANGE)||this;return t.data={type:"skip"},t}return __extends(t,e),t}(egret.Event);window.SkipEvent=r,__reflect(r.prototype,"SkipEvent",[]);var i=function(e){function t(){var t=e.call(this,GameEvents.STAT_CHANGE)||this;return t.data={type:"subscribe"},t}return __extends(t,e),t}(egret.Event);window.SubscribeEvent=i,__reflect(i.prototype,"SubscribeEvent",[]);var a=function(e){function t(){var t=e.call(this,GameEvents.STAT_CHANGE)||this;return t.data={type:"money"},t}return __extends(t,e),t}(egret.Event);window.MoneyEvent=a,__reflect(a.prototype,"MoneyEvent",[]);var o=function(e){function t(t,n){var r=e.call(this,GameEvents.STAT_CHANGE)||this;return r.data={type:"npc",npc:t,callback:n},r}return __extends(t,e),t}(egret.Event);window.NpcEvent=o,__reflect(o.prototype,"NpcEvent",[]);var s=function(e){function t(t,n){void 0===n&&(n="");var r=e.call(this,GameEvents.STAT_CHANGE)||this;return r.data={type:"roll",number:t,result:n},r}return __extends(t,e),t}(egret.Event);window.RollEvent=s,__reflect(s.prototype,"RollEvent",[]);var c=function(e){function t(t,n){var r=e.call(this,GameEvents.STAT_CHANGE)||this;return r.data={type:"show",disp:t,layer:n},r}return __extends(t,e),t}(egret.Event);window.ShowEvent=c,__reflect(c.prototype,"ShowEvent",[]);var l=function(e){function t(t){var n=e.call(this,GameEvents.STAT_CHANGE)||this;return n.data={type:"neta",disp:t},n}return __extends(t,e),t}(egret.Event);window.GetNetaEvent=l,__reflect(l.prototype,"GetNetaEvent",[])},function(e,t){var n=function(){function e(){}return e.random=function(t,n,r){void 0===n&&(n="luck"),void 0===r&&(r=!1),n&&""!=n||(n="luck");var i=Math.floor(Math.random()*(4+t.data[n]))+1;window.roll&&(i=window.roll);var a="";if(i>=10?a=RollResult.BIG_SUCCESS:i>=6?a=RollResult.SUCCESS:i>=3?a=RollResult.NORMAL:2==i?a=RollResult.FAIL:1==i&&(a=RollResult.BIG_FAIL),r){var o=t.checkIfSkillsTriggered(GamePhrase.ROLL_RESULT,e.random3());a=o.triggerRollResult(a)}return{n:i,r:a}},e.random2=function(e){return void 0===e&&(e=6),Math.round(Math.random()*e)},e.random3=function(){return Math.random()},e}();window.Roll=n,__reflect(n.prototype,"Roll",[])},function(e,t){var n=function(){function e(){}return e}();window.Score=n,__reflect(n.prototype,"Score",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=10);var r=e.call(this)||this;return r.stageMode=[!0,!0,!0,!0],r.stage=t,r.stageMode=[!0,!0,!0,!0],r.curTurn=1,r._maxTurn=n,window.testPlay=function(){r.testPlay()},r}return __extends(t,e),t.prototype.initMap=function(){this.cellDatas=new MapData;var e=new WorldMap(this.cellDatas);e.addEventListener(GameEvents.START_ROLL,this.onStartRoll,this),e.addEventListener(GameEvents.VR_SWITCH,this.onVRSwitch,this),e.addEventListener(GameEvents.SHOW_LIVER_DETAIL,this.onShowLiver,this),e.addEventListener(GameEvents.SHOW_NETA_BAG,this.onShowNetaBag,this),this.map=e,this.stage.addChild(e)},t.prototype.initPlayer=function(e){var t=[];this.chessCellIndexes=[0,0,0,0];for(var n=[],r=[],i=0;i<e.length;i++){var a=RES.getRes(e[i]);n.push(a),r.push(a.id)}Liver.init(r);for(var i=0;i<n.length;i++){var a=n[i],o=new MainCharacter(a,i);t.push(o),this.map.addChess(o.dispObj,o.index)}this.players=t,this.currentPlayer=0;var s=this.players[0];this.map.subs.setNum(s.subscribe),this.map.money.setNum(s.money),this.map.focusTo(0),s.addEventListener(GameEvents.STAT_CHANGE,this.onLiverStatChange,this),s.addEventListener(GameEvents.PLAYER_READY,this.onPlayerReady,this),s.onTurnStart(),this.cellDatas.shuffleLiver()},t.prototype.initUI=function(){this.menus=[],this.map.liverMenu.setPlayers(this.players),this.stage.addEventListener("touchTap",this.onSound,this)},t.prototype.dispose=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){return e=this,e.map.dispose(),e.cPanel&&e.cPanel.dispose(),e.bagPanel&&e.bagPanel.dispose(),SoundManager.instance.stop(),[2]})})},t.prototype.onSound=function(e){this.stage.removeEventListener("touchTap",this.onSound,this),SoundManager.instance.play("vtl1_mp3",!0)},t.prototype.onStartRoll=function(e){var t=this;if(!this._lock){this._lock=!0,this.phrase=GamePhrase.DICE_ROLL;var n=this.curPlayer.checkStepNum();0==n&&(n=Roll.random(this.curPlayer).n),this.map.showRollNum(n,RollResult.NORMAL),this.map.walkChess(this.currentPlayer,n,function(e,n){t.onChessStep(e,n)})}},t.prototype.onChessStep=function(e,t){this.chessCurIndex=e;
var n=this.cellDatas.getCell(e);if(0==e)return n.addEventListener(GameEvents.EVENT_START,this.onEventStart,this),n.addEventListener(GameEvents.STAT_CHANGE,this.onLiverStatChange,this),n.addEventListener(GameEvents.EVENT_FINISH,t?this.onStartPointFinish:this.onStartPoint,this),void n.trigger(this.stageMode[this.currentPlayer],this.curPlayer);if(this.map.onStep(!0,this.map),t){this.menus=[],n.addEventListener(GameEvents.EVENT_START,this.onEventStart,this),n.addEventListener(GameEvents.STAT_CHANGE,this.onLiverStatChange,this),n.addEventListener(GameEvents.EVENT_FINISH,this.onEventFinish,this);var r=n.trigger(this.stageMode[this.currentPlayer],this.curPlayer);if(!r)return void(this._lock=!1);this.showMenu(r)}},t.prototype.showMenu=function(e){e&&(this.phrase=GamePhrase.BEFORE_SELECT,e.addEventListener(GameEvents.ACTION_CONFIRM,this.onActionSelected,this,!1,!0),this.pushMenu({data:e}))},t.prototype.onActionSelected=function(e){if(!this._handling){this._handling=!0;var t=this,n=e.data.ty;t.phrase=GamePhrase.BEFORE_ACTION;var r=t.players[t.currentPlayer].checkIfSkillsTriggered(GamePhrase.BEFORE_ACTION,Roll.random3());switch(r.trigger(),n){case GameEvents.STREAM_PREPARE:var i=t.players[t.currentPlayer],a=e.data.ty2;t.menu&&t.map.removeMenu(t.menu),t.stream=new Stream(i,t.curTurn,a,t.cellDatas.getCell(t.chessCurIndex).getNpc(i.npc)),t.stream.addEventListener(GameEvents.STREAM_END,t.onStreamEnd,t);var o=new StreamPreparePanel(i.netaBag,a);o.addEventListener(GameEvents.STREAM_START,t.onStreamStart,t),o.addEventListener(GameEvents.MENU_CANCEL,function(e){t._handling=!1,t.popMenu()},t),t.stream.streamPreparePanel=o,t.pushMenu({data:o})}}},t.prototype.onStreamStart=function(e){void 0===e&&(e=null);var t=this;t.stream.type==StreamType.PRESENT?SoundManager.instance.play("vtl3_mp3",!1):SoundManager.instance.play("vtl2_mp3",!1);var n=t.players[t.currentPlayer].checkIfSkillsTriggered(GamePhrase.BEFORE_STREAM,Roll.random3());n.triggerStream(t.stream),t.phrase=GamePhrase.IN_STREAM,t.stream.start(function(e,n){t.map.showRollNum(e,n)})},t.prototype.onStreamEnd=function(e){var t=this;void 0===e&&(e=null),this._handling=!1,this.phrase=GamePhrase.AFTER_STREAM;for(var n=0,r=this.menus;n<r.length;n++){var i=r[n];i.dispose()}this.menus=[],setTimeout(function(){SoundManager.instance.play("vtl1_mp3",!0),t.nextPlayer()},2e3)},t.prototype.onEventStart=function(e){this.popMenu()},t.prototype.onEventFinish=function(e){var t=e.target;if(t){var n=t.getEvent(this.stageMode[this.currentPlayer]);console.log(n.name+"事件处理结束")}this._handling=!1,this.nextPlayer()},t.prototype.onStartPoint=function(e){console.log("起点事件处理结束"),e.target.removeEventListener(GameEvents.EVENT_FINISH,this.onStartPoint,this),this.map.onStep(!0,this.map)},t.prototype.onStartPointFinish=function(e){console.log("踏正起点事件处理结束"),this.map.onStep(!0,this.map),e.target.removeEventListener(GameEvents.EVENT_FINISH,this.onStartPointFinish,this),this.nextPlayer()},t.prototype.nextPlayer=function(){this._handling=!1,this._shouldSkip=!1;var e=this.cellDatas.getCell(this.chessCurIndex);e.removeEventListener(GameEvents.EVENT_START,this.onEventStart,this),e.removeEventListener(GameEvents.STAT_CHANGE,this.onLiverStatChange,this),e.removeEventListener(GameEvents.EVENT_FINISH,this.onEventFinish,this);var t=this;t.onHideBag(null),t.onHideLiver(null);var n=t.players[t.currentPlayer];n.removeEventListener(GameEvents.STAT_CHANGE,this.onLiverStatChange,this),n.removeEventListener(GameEvents.PLAYER_READY,this.onPlayerReady,this),n.onTurnEnd(),t.currentPlayer++;for(var r=0,i=t.menus;r<i.length;r++){var a=i[r];a&&a.dispose()}if(t.menus=[],t.menu=null,t.currentPlayer==t.players.length){if(t.currentPlayer=0,t.curTurn==t._maxTurn)return void t.onGameFinish();t.curTurn++,t.map.setTurnNum(t.curTurn,t.curTurn==t._maxTurn),t.cellDatas.shuffleLiver()}var o=t.players[t.currentPlayer],s=t.stageMode[t.currentPlayer];t.phrase=GamePhrase.TURN_START,t.map.subs.setNum(o.subscribe),t.map.money.setNum(o.money),t.map.setMode(s);for(var c=0,l=t.players;c<l.length;c++){var h=l[c];h.setMode(s)}t.map.liverMenu.current=t.currentPlayer,t.map.focusToLiver(t.currentPlayer,!0),o.addEventListener(GameEvents.STAT_CHANGE,this.onLiverStatChange,this),o.addEventListener(GameEvents.PLAYER_READY,this.onPlayerReady,this),o.onTurnStart()},t.prototype.onGameFinish=function(){for(var e=new egret.Event(GameEvents.GAME_FINISH),t=[],n=0,r=this.players;n<r.length;n++){var i=r[n];t.push({name:i.name,iconUrl:i.dispObj.vurl,sub:i.subscribe,stream:i.stream.length})}t=t.sort(function(e,t){return t.sub-e.sub}),e.data={score:t},this.dispatchEvent(e)},t.prototype.onPlayerReady=function(e){var t=this,n=e.data.moveable;return n?void(this._lock=!1):void setTimeout(function(){t.nextPlayer()},1e3)},t.prototype.onLiverStatChange=function(e){void 0===e&&(e=null);var t=e.data.type;switch(t){case"money":this.map.money.setTween2Num(this.curPlayer.money);break;case"subscribe":this.map.subs.setTween2Num(this.curPlayer.subscribe);break;case"skip":this._shouldSkip=!0;break;case"skill":this.map.showSkillBar(e.data.skill);break;case"npc":this.map.showNpcPanel(e.data.npc);break;case"roll":this.map.showRollNum(e.data.number,e.data.result);break;case"show":this.map.addCompenent(e.data.disp,e.data.layer);break;case"neta":this.map.showGetNeta(e.data.neta)}},t.prototype.pushMenu=function(e){void 0===e&&(e=null);var t=this,n=e.data;t.map.addMenu(n),t.menus.push(n),t.menu=n},t.prototype.popMenu=function(e){void 0===e&&(e=null);var t=this;return 0==t.menus.length?!1:(t.menus.pop(),t.menu&&t.menu.dispose(),t.menus.length>0&&(t.menu=t.menus[t.menus.length-1],t.map.addMenu(t.menu)),!0)},t.prototype.onShowLiver=function(e){var t=this;if(t.cPanel)return t.cPanel.dispose(),void(t.cPanel=null);var n=new CharaterPanel(t.players[t.currentPlayer]);n.x=(t.stage.stageWidth-n.width)/2,n.y=(t.stage.stageHeight-n.height)/2,n.addEventListener(GameEvents.MENU_CANCEL,t.onHideLiver,t),t.cPanel=n,t.stage.addChild(n)},t.prototype.onHideLiver=function(e){this.cPanel&&(this.cPanel.removeEventListener(GameEvents.MENU_CANCEL,this.onHideLiver,this),this.cPanel.dispose(),this.cPanel=null)},t.prototype.onShowNetaBag=function(e){var t=this;if(t.bagPanel)return t.bagPanel.dispose(),void(t.bagPanel=null);var n=new StreamPreparePanel(t.players[t.currentPlayer].netaBag,"",PanelType.NORMAL);n.addEventListener(GameEvents.MENU_CANCEL,t.onHideBag,t),n.addEventListener(GameEvents.NETA_CONFIRM,t.onUseNeta,t),t.bagPanel=n,t.stage.addChild(n)},t.prototype.onUseNeta=function(e){var t=this;if(!t._handling&&!t._handlingDevice){var n=e.data.neta,r=(this.bagPanel,t.curPlayer);switch(n.addEventListener(GameEvents.STAT_CHANGE,t.onLiverStatChange,t),n.addEventListener(GameEvents.DEVICE_FINISH,t.onUseFinish,t),t._handlingDevice=n,n.target){case EffectTarget.SELF:n.onUse({player:r,mc:r.ddata,mc2:r.data});break;case EffectTarget.SELF_ROLL:t.onHideBag(null),n.onUse({player:r,mc:r.ddata,mc2:r.data});break;case EffectTarget.SELECT_ONE:case EffectTarget.ALL_SELECT_ONE:this.map.setMenuLayerVisible(!1);var i=t.currentPlayer;n.target==EffectTarget.ALL_SELECT_ONE&&(i=-1);var a=t.map.showPlayerSelect(t.players,i);a.addEventListener(GameEvents.PLAYER_SELECTED,t.onSelectPlayer,t),a.addEventListener(GameEvents.PLAYER_SELECT_CANCEL,t.onCancelSelectPlayer,t),this.stage.removeChild(this.bagPanel),t.map.addChild(a),t.playerSelectPanel=a;break;case EffectTarget.OTHER_ALL:this.map.setMenuLayerVisible(!1),t.onHideBag(null);for(var o=[],s=0,c=this.players;s<c.length;s++){var l=c[s];l!=r&&o.push(l)}n.onUse({player:r,mc:r.ddata,mc2:r.data,tgtPlayer:o});break;case EffectTarget.RANDOM_ONE_NPC:var h=t.cellDatas.getCell(t.chessCurIndex),u=h.npcs,p=void 0;p=0==u.length?Math.floor(Math.random()*Liver.allLivers.length):u[Math.floor(Math.random()*u.length)];var d=Liver.allLivers[p];n.onUse({player:r,mc:r.ddata,mc2:r.data,npc:d})}}},t.prototype.onSelectPlayer=function(e){if(this._handlingDevice){this.playerSelectPanel&&this.playerSelectPanel.dispose();var t=e.data.index,n=this.curPlayer,r=[this.players[t]];this._handlingDevice.onUse({player:n,mc:n.ddata,mc2:n.data,tgtPlayer:r})}},t.prototype.onCancelSelectPlayer=function(e){this.map.setMenuLayerVisible(!0),this.playerSelectPanel&&this.playerSelectPanel.dispose(),this.bagPanel&&this.stage.addChild(this.bagPanel)},t.prototype.onUseFinish=function(e){var t=e.target;t.removeEventListener(GameEvents.STAT_CHANGE,this.onLiverStatChange,this),t.removeEventListener(GameEvents.DEVICE_FINISH,this.onUseFinish,this);var n=this.curPlayer;this.menu&&this.map.addMenu(this.menu),n.netaBag.modifyNeta(t,"use",!1,1,!1),this.bagPanel&&(this.bagPanel.setNeta(t),this.bagPanel.netaSelectPanel.refresh({neta:t,selected:!1})),this._handlingDevice=null,this.map.setMenuLayerVisible(!0),this._shouldSkip&&this.nextPlayer()},t.prototype.onHideBag=function(e){this.bagPanel&&(this.bagPanel.removeEventListener(GameEvents.MENU_CANCEL,this.onHideBag,this),this.bagPanel.removeEventListener(GameEvents.NETA_CONFIRM,this.onUseNeta,this),this.bagPanel.dispose(),this.bagPanel=null)},t.prototype.onMenuClosed=function(e){e.target.dispose(),e.target.removeEventListener(GameEvents.MENU_CANCEL,this.onMenuClosed,this),e.target==this.bagPanel?this.bagPanel=null:e.target==this.cPanel&&(this.cPanel=null)},t.prototype.onVRSwitch=function(e){var t=this;if(!this._lock){this._lock=!0;var n=this;n.stageMode[n.currentPlayer]=!n.stageMode[n.currentPlayer];var r=n.stageMode[n.currentPlayer];n.map.setMode(r);for(var i=0,a=n.players;i<a.length;i++){var o=a[i];o.setMode(r)}setTimeout(function(){t._lock=!1},500)}},Object.defineProperty(t.prototype,"curPlayer",{get:function(){return this.players[this.currentPlayer]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chessCurIndex",{get:function(){return this.chessCellIndexes[this.currentPlayer]},set:function(e){this.chessCellIndexes[this.currentPlayer]=e},enumerable:!1,configurable:!0}),t.prototype.testPlay=function(){this.curPlayer.testPlay()},t}(egret.EventDispatcher);window.WorldController=n,__reflect(n.prototype,"WorldController",["IDisposable"])},function(e,t){var n=function(){function e(){}return e.VIRTUAL=!0,e.REAL=!1,e.cellSize=200,e.cellNum=8,e}();window.WorldData=n,__reflect(n.prototype,"WorldData",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this)||this;return r.ID=egret.getQualifiedClassName(r),r.time=[n,"E"],r.mc=t,r}return __extends(t,e),Object.defineProperty(t.prototype,"desStr",{get:function(){var e="";switch(this.time[1]){case"S":e="次直播";break;case"T":e="回合";break;case"E":e="次生效"}return this.des+"\n持续:"+this.time[0]+e},enumerable:!1,configurable:!0}),t.prototype.turnCD=function(){"T"==this.time[1]&&this.cd()},t.prototype.streamCD=function(){"S"==this.time[1]&&this.cd()},t.prototype.cd=function(){this.time[0]--;var e=0;"T"==this.time[1]&&(e=-1),this.time[0]<=e&&(this.off(),this.overed=!0)},t.prototype.on=function(){},t.prototype.off=function(){},t.prototype.effect=function(e){},t.prototype.add=function(e){this.time[0]+=e.time[0]},t}(BaseObj);window.Buff=n,__reflect(n.prototype,"Buff",[])},function(module,exports){var Skill=function(_super){function Skill(e,t){var n=_super.call(this)||this;return n.name=t.name,n.des=t.des,n.effect=t.effect?t.effect:[],n.rate=t.rate,n.phrase=t.phrase,t.always?n.always=t.always:n.always=t.phrase.indexOf("USE_")>=0,n.type=t.type,n.req=t.req,n.mc=e,n._cd=0,n}return __extends(Skill,_super),Skill.prototype.cd=function(){this.triggered=!1,0!=this._cd&&this._cd--},Skill.prototype.shouldTrigger=function(phrase,v){if(void 0===v&&(v=0),!this.effect)return!1;if(this._cd>0)return!1;if(this.triggered&&!this.always)return!1;if(this.phrase.indexOf(phrase)<0)return!1;try{var mc=this.mc,re=new RegExp(/\{mc.*\}/),rateStr=this.rate,arr=re.exec(rateStr);if(arr)for(var _i=0,arr_1=arr;_i<arr_1.length;_i++){var i=arr_1[_i],prop=i.substring(4,i.length-1);rateStr=rateStr.replace(i,mc.data[prop])}var r=eval(rateStr);return r>v}catch(err){return console.error(err),!1}},Skill.prototype.reset=function(){this.triggered=!1},Skill.prototype.trigger=function(){console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),this.triggered=!0;for(var e={player:this.mc,mc:this.mc.ddata,bag:this.mc.netaBag},t=0,n=this.effect;t<n.length;t++){var r=n[t],i=r.type,a=r.data;this.handle(i,a,e)}},Skill.prototype.triggerAction=function(){},Skill.prototype.triggerNeta=function(e,t){if(!(this.phrase.indexOf("NETA")<0)){var n={player:this.mc,neta:e,mc:this.mc.ddata,stream:t,bag:this.mc.netaBag};console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),this.triggered=!0;for(var r=0,i=this.effect;r<i.length;r++){var a=i[r],o=a.type,s=a.data;this.handle(o,s,n)}}},Skill.prototype.triggerStream=function(e){if(!(this.phrase.indexOf("STREAM")<0)){var t={player:this.mc,stream:e,mc:this.mc.ddata,mc2:this.mc.data,mc3:this.mc.edata};if(this.checkReq(this.req,t)){console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),this.triggered=!0;for(var n=0,r=this.effect;n<r.length;n++){var i=r[n],a=i.type,o=i.data;this.handle(a,o,t)}}}},Skill.prototype.triggerBag=function(e){console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),this.triggered=!0},Skill.prototype.triggerRollResult=function(e){return console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),this.triggered=!0,e},Skill}(EffectHandler);window.Skill=Skill,__reflect(Skill.prototype,"Skill",[])},function(e,t){var n=function(){function e(){this._arr=[]}return e.prototype.add=function(e){this._arr.push(e)},e.prototype.trigger=function(){for(var e=0,t=this._arr;e<t.length;e++){var n=t[e];n.trigger()}},e.prototype.triggerNeta=function(e,t){for(var n=0,r=this._arr;n<r.length;n++){var i=r[n];i.triggerNeta(e,t)}},e.prototype.triggerStream=function(e){for(var t=0,n=this._arr;t<n.length;t++){var r=n[t];r.triggerStream(e)}},e.prototype.triggerBag=function(e){for(var t=0,n=this._arr;t<n.length;t++){var r=n[t];r.triggerBag(e)}},e.prototype.triggerRollResult=function(e){for(var t=0,n=this._arr;t<n.length;t++){var r=n[t];e=r.triggerRollResult(e)}return e},e}();window.SkillsTrigger=n,__reflect(n.prototype,"SkillsTrigger",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t,n)||this;return r.name="事故无效",r.time=[n,"E"],r}return __extends(t,e),t}(Buff);window.AccidentGuard=n,__reflect(n.prototype,"AccidentGuard",[])},function(e,t){var n=function(e){function t(t,n,r){void 0===r&&(r=1);var i=e.call(this,t,r)||this;return i._arr=["luck","sense","commu","strength","talk","game","sing","tech"],i._delta=n,i}return __extends(t,e),t.prototype.on=function(){for(var e=this.mc.ddata,t=this._delta,n=0,r=this._arr;n<r.length;n++){var i=r[n];e[i]+=t}},t}(Buff);window.AllStatChange=n,__reflect(n.prototype,"AllStatChange",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=3);var r=e.call(this,t,n)||this;return r.name="胸前运动短裤",r.des="持续时间内能力降低",r.iconUrl="icons_json#cupon",r.time=[n,"T"],r}return __extends(t,e),t.prototype.on=function(){this.mc.ddata.sense-=3},t}(Buff);window.CuPon=n,__reflect(n.prototype,"CuPon",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=3);var r=e.call(this,t,n)||this;return r.name="炎上",r.des="炎上期间粉丝停止自然增长",r.iconUrl="icons_json#fire",r.time=[n,"T"],r._sw=!1,r}return __extends(t,e),t.prototype.add=function(e){this.time[0]+=1},t.prototype.on=function(){this._sw||(this._sw=!0,this.mc.dispObj.showFire(!0))},t.prototype.off=function(){this._sw=!1,this.mc.dispObj.showFire(!1)},t}(Buff);window.Enjo=n,__reflect(n.prototype,"Enjo",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t,n)||this;return r.name="神的加运(炎)",r.des="直播中不会发生炎上",r.iconUrl="icons_json#fireguard",r.time=[n,"S"],r}return __extends(t,e),t}(Buff);window.EnjoGuard=n,__reflect(n.prototype,"EnjoGuard",[]);var r=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t,n)||this;return r.name="防火盾",r.des="直播中防止一次炎上",r.iconUrl="",r.time=[n,"E"],r}return __extends(t,e),t}(Buff);window.EnjoGuardLite=r,__reflect(r.prototype,"EnjoGuardLite",[])},function(e,t){var n=function(e){function t(t,n,r){void 0===n&&(n=1e4),void 0===r&&(r=1);var i=e.call(this,t)||this;return i.name="炎上对应强化",i.des="直播时发生炎上会增加粉丝",i.iconUrl="icons_json#mic",i.time=[r,"S"],i._up=n,i}return __extends(t,e),t.prototype.streamCD=function(){e.prototype.streamCD.call(this),this._st&&(this._st.removeEventListener(GameEvents.STREAM_ENJO,this.onEnjo,this),this._st=null)},t.prototype.effect=function(e){e.stream&&(this._st=e.stream,this._st.addEventListener(GameEvents.STREAM_ENJO,this.onEnjo,this))},t.prototype.onEnjo=function(e){this._st&&(this._st.totSubAdd+=this._up)},t}(Buff);window.EnjoSubUp=n,__reflect(n.prototype,"EnjoSubUp",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=0);var r=e.call(this,t,n)||this;return r.name="好感度固定",r.des="无法提升NPC好感度",r.time=[n,"T"],r}return __extends(t,e),t.prototype.on=function(){this.mc.npc.lock=!0},t.prototype.off=function(){this.mc.npc.lock=!1},t}(Buff);window.FavorLock=n,__reflect(n.prototype,"FavorLock",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=3);var r=e.call(this,t,n)||this;return r.name="圣光",r.des="没有反应，只是在发光。",r.iconUrl="icons_json#light",r.time=[n,"T"],r._sw=!1,r}return __extends(t,e),t.prototype.add=function(e){this.time[0]+=1},t.prototype.on=function(){this._sw||(this._sw=!0,this.mc.dispObj.showLight(!0))},t.prototype.off=function(){this._sw=!1,this.mc.dispObj.showLight(!1)},t}(Buff);window.Light=n,__reflect(n.prototype,"Light",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t,n)||this;return r.name="晦气诅咒",r.des="被诅咒的状态，印堂发黑，运气大幅降低",r.iconUrl="icons_json#cursed",r.time=[n,"T"],r}return __extends(t,e),t.prototype.on=function(){this.mc.ddata.luck-=5},t}(Buff);window.LuckCursed=n,__reflect(n.prototype,"LuckCursed",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t,n)||this;return r.name="神的加护(运)",r.des="运气大幅提高，效果逐回合降低",r.iconUrl="icons_json#luckbuff",r.time=[n,"T"],r}return __extends(t,e),t.prototype.on=function(){this.mc.ddata.luck+=this.time[0]+1},t}(Buff);window.LuckWish=n,__reflect(n.prototype,"LuckWish",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=3);var r=e.call(this,t,n)||this;return r.name="55kg",r.des="行动时只能前进1格",r.time=[n,"T"],r}return __extends(t,e),t}(Buff);window.Lunpapa=n,__reflect(n.prototype,"Lunpapa",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t,n)||this;return r.name="设备无效",r.des="PC设备的改变直播事故概率的效果无效",r.iconUrl="icons_json#mechlock",r.time=[n,"S"],r}return __extends(t,e),t.prototype.on=function(){for(var e=0,t=this.mc.netaBag.device;e<t.length;e++){var n=t[e],r=n.ID,i=r.indexOf("PC")>=0;i&&(n.trigger=!1)}},t.prototype.off=function(){for(var e=0,t=this.mc.netaBag.device;e<t.length;e++){var n=t[e],r=n.ID,i=r.indexOf("PC")>=0;i&&(n.trigger=!0)}},t}(Buff);window.MechLock=n,__reflect(n.prototype,"MechLock",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t,n)||this;return r.name="睡眠",r.des="跳过一次行动",r.iconUrl="icons_json#sleep",r.time=[n,"T"],r._sw=!1,r}return __extends(t,e),t.prototype.on=function(){this._sw||(this._sw=!0,this.mc.dispObj.showSleep(!0))},t.prototype.off=function(){this._sw=!1,this.mc.dispObj.showSleep(!1)},t}(Buff);window.Sleep=n,__reflect(n.prototype,"Sleep",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t,n)||this;return r.name="急上升",r.des="直播效果明显提升",r.iconUrl="icons_json#raise",r.time=[n,"E"],r}return __extends(t,e),t.prototype.effect=function(e){e.stream&&(e.stream.baseRate*=2),this.time[0]--},t}(Buff);window.SpeedyRaise=n,__reflect(n.prototype,"SpeedyRaise",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t,n)||this;return r.name="满腹",r.des="体力大幅提高，效果逐回合降低",r.iconUrl="icons_json#full",r.time=[n,"T"],r}return __extends(t,e),t.prototype.on=function(){this.mc.ddata.strength+=this.time[0]+1},t}(Buff);window.StomachFull=n,__reflect(n.prototype,"StomachFull",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t,n)||this;return r.name="停止",r.des="跳过一次行动",r.iconUrl="icons_json#stopbuff",r.time=[n,"T"],r}return __extends(t,e),t}(Buff);window.Stop=n,__reflect(n.prototype,"Stop",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t)||this;return r.name="游戏直播强化",r.time=[n,"T"],r}return __extends(t,e),t}(Buff);window.StreamBuffGame=n,__reflect(n.prototype,"StreamBuffGame",[]);var r=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t)||this;return r.name="歌回直播强化",r.time=[n,"T"],r}return __extends(t,e),t}(Buff);window.StreamBuffSing=r,__reflect(r.prototype,"StreamBuffSing",[]);var i=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t)||this;return r.name="直播风险提高",r.time=[n,"T"],r}return __extends(t,e),t}(Buff);window.StreamDebuffBan=i,__reflect(i.prototype,"StreamDebuffBan",[]);var a=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t)||this;return r.name="联动强化",r.time=[n,"T"],r}return __extends(t,e),t}(Buff);window.StreamBuffCollabo=a,__reflect(a.prototype,"StreamBuffCollabo",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t)||this;return r.name="司仪能力强化",r.des="直播时交流力大幅上升",r.iconUrl="icons_json#mic",r.time=[n,"S"],r}return __extends(t,e),t.prototype.effect=function(e){e.mc&&(e.mc.commu+=5)},t}(Buff);window.StreamCommuUp=n,__reflect(n.prototype,"StreamCommuUp",[])},function(e,t){var n=function(e){function t(t,n,r,i){void 0===n&&(n=1),void 0===r&&(r=.2),void 0===i&&(i=null);var a=e.call(this,t,n)||this;return a.name="直播效果强化",a.des="提高直播获得订阅数的基础倍率",a.iconUrl="icons_json#raise",a.time=[n,"E"],a._rate=r,a._tyLimit=i,a}return __extends(t,e),t.prototype.effect=function(e){if(e.stream){if(this._tyLimit&&e.stream.type!=this._tyLimit)return;e.stream.baseRate+=this._rate}this.time[0]--},t.prototype.add=function(e){var t=e;t&&(this._rate+=t.rate,console.log(this.name+"的效果叠加至"+this._rate))},Object.defineProperty(t.prototype,"rate",{get:function(){return this._rate},enumerable:!1,configurable:!0}),t}(Buff);window.StreamRaise=n,__reflect(n.prototype,"StreamRaise",[]);var r=function(e){function t(t,n,r){void 0===n&&(n=1),void 0===r&&(r=.2);var i=e.call(this,t,n,r,StreamType.SING)||this;return i.name="歌回直播效果强化",i.des="提高歌回直播获得订阅数的基础倍率",i}return __extends(t,e),t}(n);window.StreamRaise_SING=r,__reflect(r.prototype,"StreamRaise_SING",[]);var i=function(e){function t(t,n,r){void 0===n&&(n=1),void 0===r&&(r=.2);var i=e.call(this,t,n,r,StreamType.GAME)||this;return i.name="游戏直播效果强化",i.des="提高游戏直播获得订阅数的基础倍率",i}return __extends(t,e),t}(n);window.StreamRaise_GAME=i,__reflect(i.prototype,"StreamRaise_GAME",[]);var a=function(e){function t(t,n,r){void 0===n&&(n=1),void 0===r&&(r=.2);var i=e.call(this,t,n,r,StreamType.TALK)||this;return i.name="杂谈直播效果强化",i.des="提高杂谈直播获得订阅数的基础倍率",i}return __extends(t,e),t}(n);window.StreamRaise_TALK=a,__reflect(a.prototype,"StreamRaise_TALK",[]);var o=function(e){function t(t,n,r){void 0===n&&(n=1),void 0===r&&(r=.2);var i=e.call(this,t,n,r)||this;return i.name="联动效果强化",i.des="直播发生联动时提高获得订阅数的基础倍率",i}return __extends(t,e),t.prototype.effect=function(t){t.stream&&0==t.stream.collaboMems.length||e.prototype.effect.call(this,t)},t}(n);window.StreamRaise_COLLABO=o,__reflect(o.prototype,"StreamRaise_COLLABO",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=1);var r=e.call(this,t,n)||this;return r.name="直播安全",r.des="炎上和事故概率大幅降低",r.iconUrl="icons_json#fireguard",r.time=[n,"S"],r}return __extends(t,e),t.prototype.effect=function(e){if(e.stream){var t=e.stream;t.accidentBaseRate-=30,t.enjoBaseRate-=6.5}this.time[0]--},t}(Buff);window.StreamSafe=n,__reflect(n.prototype,"StreamSafe",[])},function(e,t){var n=function(e){function t(t,n){void 0===n&&(n=3);var r=e.call(this,t,n)||this;return r.name="TA☆WA☆GE☆GA",r.des="品位小幅上升且状态期间anti不会增长",r.iconUrl="icons_json#tawagega",r.time=[n,"T"],r}return __extends(t,e),t.prototype.on=function(){this.mc.ddata.sense+=2,this.mc.antiLock=!0},t.prototype.off=function(){this.mc.ddata.sense-=2,this.mc.antiLock=!1},t}(Buff);window.Tawagega=n,__reflect(n.prototype,"Tawagega",[])},function(e,t){var n=function(e){function t(t,n,r){void 0===n&&(n=1),void 0===r&&(r=999999);var i=e.call(this,t,r)||this;return i.name="树莓",i.des="持有树莓时体力降低",i._d=n,i.time=[r,"T"],i}return __extends(t,e),t.prototype.on=function(){this.mc.ddata.strength-=this._d},t.prototype.off=function(){this.mc.ddata.strength+=this._d},t.prototype.add=function(e){console.log("add : ",this._d),this.mc.ddata.strength+=this._d,this._d++,this.mc.ddata.strength-=this._d},t}(Buff);window.TreeBerry=n,__reflect(n.prototype,"TreeBerry",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this,t)||this;return n._jsonObj=t,n}return __extends(t,e),t.prototype.onGain=function(e){if(e.player){var t=new TreeBerry(e.player);e.player.getBuff(t)}},t.prototype.onUse=function(e){var n=this,r=e.player,i=e.tgtPlayer;if(r&&i){var a=Roll.random(r,"",!0),o=a.n,s=a.r,c=i[0],l=!1;s==RollResult.FAIL||s==RollResult.BIG_FAIL?(s=RollResult.FAIL,c=r,l=!0):s=RollResult.SUCCESS,WorldMap.focusToPlayer(c).wait(100).call(function(){if(n.dispatchEvent(new RollEvent(o,s)),l){var i=new TreeBerry(e.player,n._times+1);r.removeBuff("TreeBerry"),r.getBuff(i);var a=new t(n._jsonObj);c.netaBag.modifyNeta(a,"get",!1,2,!1),SoundManager.instance.playBgs("dededon_short_mp3")}else{if(n._times<=1)r.removeBuff("TreeBerry");else{var h=new TreeBerry(r,n._times-1);r.removeBuff("TreeBerry"),r.getBuff(h)}var i=new TreeBerry(c,1);c.getBuff(i);var a=new t(n._jsonObj);c.netaBag.modifyNeta(a,"get",!1,1,!1)}c.dispObj.showAttacked()}).wait(1e3).call(function(){WorldMap.focusToPlayer(r),n.dispatchEvent(new egret.Event(GameEvents.DEVICE_FINISH))})}},t}(Device);window.AboSpec=n,__reflect(n.prototype,"AboSpec",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onUse=function(e){var t=e.player;if(t){for(var n=this.effect[0].data,r=n.split(","),i=[],a=function(e){var n=e.replace("{mc.npc.","").split("}+"),r=n[0],a=parseFloat(n[1]);t.npc.modify(r,a);var o=t.npc.getF(r),s=Liver.allLivers.filter(function(e){return e.ID==r})[0];if(!s)return"continue";var c=__assign(__assign({},s),{favor:o});i.push(c)},o=0,s=r;o<s.length;o++){var c=s[o];a(c)}this.showChangedNpc(i,0,3)}},t.prototype.showChangedNpc=function(e,t,n){var r=this,i=!1;n>e.length&&(i=!0,n=e.length);var a=e.slice(t,n),o=new NpcPanel2(a);o.addEventListener(eui.UIEvent.REMOVED_FROM_STAGE,function(t){i?r.dispatchEvent(new egret.Event(GameEvents.DEVICE_FINISH)):r.showChangedNpc(e,n,n+3)},this),this.dispatchEvent(new ShowEvent(o,"top"))},t}(Device);window.DebiSpec=n,__reflect(n.prototype,"DebiSpec",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this,t)||this;return n.ELF_NPC=["chaika","elu","eli","gweru"],n}return __extends(t,e),t.prototype.onUse=function(e){var t=e.player;if(t){var n=Math.floor(Math.random()*this.ELF_NPC.length),r=this.ELF_NPC[n];t.npc.modify(r,1);for(var i,a=0,o=Liver.allLivers;a<o.length;a++){var s=o[a];s.ID==r&&(i=[__assign(__assign({},s),{favor:t.npc.getF(r)})])}if(i.length>0){var c=new NpcPanel2(i);c.once(eui.UIEvent.REMOVED_FROM_STAGE,function(e){c.dispose()},this),this.dispatchEvent(new ShowEvent(c,"top")),this.dispatchEvent(new egret.Event(GameEvents.DEVICE_FINISH))}else this.dispatchEvent(new egret.Event(GameEvents.DEVICE_FINISH))}},t}(Device);window.Donguri=n,__reflect(n.prototype,"Donguri",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onUse=function(e){var t=this,n=e.player;if(n){var r,i=Math.random()<=.5;i?(SoundManager.instance.playBgs("success2_mp3"),n.data.game+=3,r=this.effect[0].log2):r=this.effect[0].log;var a=new EvtLog(r);this.dispatchEvent(new ShowEvent(a,"menu")),a.addEventListener("touchTap",function(e){a.dispose(),t.dispatchEvent(new egret.Event(GameEvents.DEVICE_FINISH))},this)}},t}(Device);window.KanaeSpec=n,__reflect(n.prototype,"KanaeSpec",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this,t)||this;return n.target=EffectTarget.SELECT_ONE,n}return __extends(t,e),t.prototype.onUse=function(e){var t=this,n=e.player,r=e.tgtPlayer;if(n&&r){var i,a,o=Roll.random(n,"",!0),s=o.n,c=o.r,l=this.getRate(c);l>0?(i=r[0],a=n):(i=n,a=r[0]),egret.Tween.get(this).call(function(){0>l&&SoundManager.instance.playBgs("dededon_short_mp3"),t.dispatchEvent(new RollEvent(s,c))}).wait(500).call(function(){var e=new Curse;t.dispatchEvent(new ShowEvent(e,"top")),e.play(n,i,function(){t.onCurse(l,i,a),t.dispatchEvent(new egret.Event(GameEvents.DEVICE_FINISH))})})}},t.prototype.onCurse=function(e,t,n){if(void 0===n&&(n=null),t)for(var r=0,i=this.effect;r<i.length;r++){var a=i[r],o=a.count?a.count:1,s=o*Math.abs(e);switch(a.type){case EffectType.GET_BUFF:var c=a.data,l=egret.getDefinitionByName(c);if(!l)return void console.warn("诅咒的buff类型未设置");console.log("对"+t.name+"附加"+s+"回合buff:"+c);var h=new l(t,s+1);t.getBuff(h);break;case EffectType.LOSE_NETA:for(var u=0;s>u;u++)t.netaBag.lostNeta(NetaType.TALK,1);break;case EffectType.STAT_CHANGE:break;case EffectType.SUBS_TRAN:var p=t.subscribe>=s?s:t.subscribe;t.subscribe-=p,n.subscribe+=p}}},t.prototype.getRate=function(e){var t=0;switch(e){case RollResult.BIG_SUCCESS:t=4;break;case RollResult.SUCCESS:t=2;break;case RollResult.NORMAL:t=1;break;case RollResult.FAIL:t=-1;break;case RollResult.BIG_FAIL:t=-2}return t},t}(Device);window.NetaDeviceCurse=n,__reflect(n.prototype,"NetaDeviceCurse",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this,t)||this;return n.counter=3,n}return __extends(t,e),t.prototype.onHold=function(t){return this.counter<=0?void 0:(this.counter--,this.counter<=0&&console.log("NetaDeviceMinePC : 矿机已失效"),e.prototype.onHold.call(this,t))},t}(PC);window.NetaDeviceMinePC=n,__reflect(n.prototype,"NetaDeviceMinePC",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(Device);window.NetaDeviceRotion=n,__reflect(n.prototype,"NetaDeviceRotion",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this,t)||this;n.TURN_2_CHANGE=5,n.counters=[];for(var r=0;r<n._times;r++)n.counters.push(n.TURN_2_CHANGE);return n}return __extends(t,e),Object.defineProperty(t.prototype,"times",{get:function(){return this._times},set:function(e){this.counters.push(this.TURN_2_CHANGE),this._times=e},enumerable:!1,configurable:!0}),t.prototype.passTurn=function(){this.counters=this.counters.map(function(e){return e-=1});var e=this.counters.filter(function(e){return 0==e});if(!(e.length>0))return[];var t=[];try{for(var n=0,r=this.effect;n<r.length;n++){var i=r[n];if(i.type==EffectType.GET_NETA){var a=NetaFactory.getNetaFromObj(i.data);t.push({newNeta:a,num:e.length})}}return t}catch(o){return console.log(this.name+" 变化数据出错 : "+o),[]}},t}(Device);window.NetaDeviceUnchi=n,__reflect(n.prototype,"NetaDeviceUnchi",["ChangeableDevice"])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onUse=function(e){var t=this,n=e.player,r=e.tgtPlayer;if(n&&r){var i=r[0];WorldMap.focusToPlayer(i).wait(100).call(function(){var e=new Stop(i);i.getBuff(e),i.dispObj.showAttacked()}).wait(1e3).call(function(){WorldMap.focusToPlayer(n),t.dispatchEvent(new egret.Event(GameEvents.DEVICE_FINISH))})}},t}(Device);window.RTVSpec=n,__reflect(n.prototype,"RTVSpec",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onUse=function(e){var t=e.player,n=e.tgtPlayer;t&&n&&(this._index=0,this._mc=t,this._tgt=n,this.effectHandler())},t.prototype.effectHandler=function(){var e=this;if(this._index>=this._tgt.length)return WorldMap.focusToPlayer(this._mc),void this.dispatchEvent(new egret.Event(GameEvents.DEVICE_FINISH));var t=this._tgt[this._index],n=WorldMap.focusToPlayer(t);
n?n.wait(100).call(function(){SoundManager.instance.playBgs("sword_mp3"),t.netaBag.lostNeta(NetaType.TALK),t.netaBag.lostNeta(NetaType.TALK),t.dispObj.showAttacked()}).wait(1e3).call(function(){e._index++,e.effectHandler()}):(this._index++,this.effectHandler())},t}(Device);window.RionSpec=n,__reflect(n.prototype,"RionSpec",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onUse=function(e){var t=e.player,n=e.npc;if(t&&n){var r=t.npc.modify(n.ID,5),i=__assign(__assign({},n),{favor:r});this.dispatchEvent(new NpcEvent([i])),this.dispatchEvent(new egret.Event(GameEvents.DEVICE_FINISH))}},t}(Device);window.SasakiSpec=n,__reflect(n.prototype,"SasakiSpec",[])},function(e,t){var n=function(e){function t(t){var n=e.call(this,t)||this;return n.effectType=[1,2,3,4,5,6],n}return __extends(t,e),t.prototype.onUse=function(e){var t=this,n=e.player;if(n){this._mc=n;var r=new EvtLog(this.effect[0].data);this.dispatchEvent(new ShowEvent(r,"menu")),r.addEventListener("touchTap",function(e){r.dispose(),t.roll()},this)}},t.prototype.roll=function(){var e,t=this,n=Math.floor(Math.random()*this.effectType.length),r=this.effectType[n];switch(r){case 1:e=new StreamRaise(this._mc,3,1),this._mc.getBuff(e);break;case 2:e=new StomachFull(this._mc,3),this._mc.getBuff(e);break;case 3:e=new Sleep(this._mc,1),this._mc.getBuff(e);break;case 4:e=new AllStatChange(this._mc,1,1),this._mc.getBuff(e);break;case 5:e=new AllStatChange(this._mc,-1,1),this._mc.getBuff(e);break;case 6:e=new Light(this._mc,1),this._mc.getBuff(e),SoundManager.instance.playBgs("success2_mp3")}this.effectType.splice(n,1),egret.Tween.get(this).call(function(){t.dispatchEvent(new RollEvent(r,""))}).wait(1e3).call(function(){var e=t.rollAgain(t._mc);e&&t.effectType.length>0?t.roll():t.dispatchEvent(new egret.Event(GameEvents.DEVICE_FINISH))})},t.prototype.rollAgain=function(e){var t=Roll.random(e),n=(t.n,t.r);return n==RollResult.SUCCESS||n==RollResult.BIG_SUCCESS},t}(Device);window.TamakiSpec=n,__reflect(n.prototype,"TamakiSpec",[])},function(e,t){var n=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.onUse=function(e){if(e.stream&&e.player){for(var t,n=e.player.netaBag,r=0,i=n.device;r<i.length;r++){var a=i[r];if("NetaDeviceRotion"==a.ID){t=a;break}}if(t){var o=t.times;console.log("使用"+t.times+"个"+t.name+"提升"+this.name+"直播效果"),n.modifyNeta(t,"use",!1,o),e.stream.baseRate+=.2*o}}},t}(Neta);window.RotionSports=n,__reflect(n.prototype,"RotionSports",[])},function(e,t){var n=function(e){function t(t,n){for(var r=e.call(this,t,n)||this,i=[],a=0,o=Liver.allLivers;a<o.length;a++){var s=o[a];s.tag&&s.tag.indexOf("resist")>=0&&i.push(s.ID)}return r.resistLivers=i,r}return __extends(t,e),t.prototype.triggerStream=function(t){for(var n=0,r=0,i=t.collaboMems;r<i.length;r++){var a=i[r];this.resistLivers.indexOf(a)>=0&&n++}0!=n&&e.prototype.triggerStream.call(this,t)},t}(Skill);window.ChaikaSkill1=n,__reflect(n.prototype,"ChaikaSkill1",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.triggerNeta=function(e,t){e.pop>2||(e.meme=0,console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)))},t}(Skill);window.ChaikaSkill3=n,__reflect(n.prototype,"ChaikaSkill3",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.triggerBag=function(t){var n=Roll.random(this.mc).n;this.setHalfValue(t.game,n),this.setHalfValue(t.song,n),this.setHalfValue(t.device,n),e.prototype.triggerBag.call(this,t)},t.prototype.setHalfValue=function(e,t){if(e)for(var n=0,r=e;n<r.length;n++){var i=r[n],a=Roll.random2(10);t>=a&&(console.log(i.name+"价格减半"),i.value/=2)}},t}(Skill);window.LizeSkill2=n,__reflect(n.prototype,"LizeSkill2",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.triggerRollResult=function(t){return this.mc.currentMode?(console.log("<虚拟>不触发"+this.name),t):t!=RollResult.NORMAL&&t!=RollResult.FAIL?t:(t=RollResult.BIG_FAIL,e.prototype.triggerRollResult.call(this,t),t)},t}(Skill);window.LizeSkill3=n,__reflect(n.prototype,"LizeSkill3",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.triggerStream=function(e){console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),e.curAccident=!1},t}(Skill);window.MitoSkill2=n,__reflect(n.prototype,"MitoSkill2",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.triggerStream=function(e){this.phrase.indexOf("STREAM")<0||(console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),e.totSubAdd+=1e4*e.collaboMems.length)},t}(Skill);window.RionSkill1=n,__reflect(n.prototype,"RionSkill1",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.triggerNeta=function(t,n){var r=t.name;r.match(/(半泽直树)|(鬼灭之刃)|(原神)|(塞尔达传说)|(东京复仇者)|(热门动画)/g)&&e.prototype.triggerNeta.call(this,t,n)},t}(Skill);window.RionSkill2=n,__reflect(n.prototype,"RionSkill2",[])},function(e,t){var n=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.niceClip=0,r.clipTurn=0,r}return __extends(t,e),t.prototype.shouldTrigger=function(t,n){return void 0===n&&(n=0),0==this.niceClip?!1:t==GamePhrase.TURN_START?3==this.clipTurn?!0:(this.clipTurn++,!1):e.prototype.shouldTrigger.call(this,t)},t.prototype.trigger=function(){console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),this.mc.subscribe+=5e3*this.niceClip,this.clipTurn=0},t.prototype.triggerStream=function(e){this.phrase.indexOf("STREAM")<0||(console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),this.niceClip++)},t}(Skill);window.RionSkill5=n,__reflect(n.prototype,"RionSkill5",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.triggerNeta=function(t,n){var r=t.name;r.match(/(塞尔达)|(宝可梦)|(卡比)|(马里奥)/g)&&e.prototype.triggerNeta.call(this,t,n)},t}(Skill);window.SasakiSkill1=n,__reflect(n.prototype,"SasakiSkill1",[])},function(e,t){var n=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.upNum=0,r}return __extends(t,e),t.prototype.shouldTrigger=function(e,t){return void 0===t&&(t=0),e==GamePhrase.TURN_START||e==GamePhrase.AFTER_STREAM?!0:!1},t.prototype.trigger=function(){console.log("skill : ",this.name),0==this.upNum&&this.dispatchEvent(new SkillEvent(this)),this.upNum++,this.mc.ddata.strength+=this.upNum},t.prototype.triggerStream=function(e){this.upNum=0},t}(Skill);window.SasakiSkill2=n,__reflect(n.prototype,"SasakiSkill2",[])},function(e,t){var n=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.counter=0,r}return __extends(t,e),t.prototype.shouldTrigger=function(e,t){return void 0===t&&(t=0),e==GamePhrase.STREAM_ACCIDENT||e==GamePhrase.STREAM_ENJO?this.startCounting?!1:.85>=t?(console.warn("SasakiSkill5 开始计数"),this.startCounting=!0,this.counter=0,!1):!1:e==GamePhrase.TURN_START&&this.startCounting?(this.counter++,!1):e==GamePhrase.BEFORE_STREAM&&this.startCounting?!0:void 0},t.prototype.triggerStream=function(e){console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),this.mc.subscribe+=1e4*this.counter,this.startCounting=!1,this.counter=0},t}(Skill);window.SasakiSkill5=n,__reflect(n.prototype,"SasakiSkill5",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.triggerStream=function(e){e.baseRate+=this.mc.luck/10,console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),this.triggered=!0},t}(Skill);window.SiinaSkill1=n,__reflect(n.prototype,"SiinaSkill1",[])},function(e,t){var n=function(e){function t(t,n){for(var r=e.call(this,t,n)||this,i=[],a=0,o=Liver.allLivers;a<o.length;a++){var s=o[a];s.tag&&s.tag.indexOf("resist")>=0&&i.push(s.ID)}return r.resistLivers=i,r}return __extends(t,e),t.prototype.triggerStream=function(t){for(var n=0,r=0,i=t.collaboMems;r<i.length;r++){var a=i[r];this.resistLivers.indexOf(a)>=0&&n++}0!=n&&e.prototype.triggerStream.call(this,t)},t}(Skill);window.SiinaSkill2=n,__reflect(n.prototype,"SiinaSkill2",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.triggerRollResult=function(t){switch(t){case RollResult.BIG_FAIL:t=RollResult.FAIL;break;case RollResult.FAIL:t=RollResult.NORMAL;break;case RollResult.NORMAL:t=RollResult.SUCCESS;break;case RollResult.SUCCESS:t=RollResult.BIG_SUCCESS;break;case RollResult.BIG_SUCCESS:return t}return e.prototype.triggerRollResult.call(this,t),t},t}(Skill);window.SiinaSkill5=n,__reflect(n.prototype,"SiinaSkill5",[])},function(e,t){var n=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.MAX_CD=3,r._cd=r.MAX_CD,r}return __extends(t,e),t.prototype.cd=function(){},t.prototype.shouldTrigger=function(e,t){return void 0===t&&(t=0),e==GamePhrase.TURN_START?0==this._cd?(this._cd=this.MAX_CD,!0):(this._cd--,!1):!1},t}(Skill);window.ToyaSkill1=n,__reflect(n.prototype,"ToyaSkill1",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.triggerStream=function(t){var n=Math.min(t.totalPop,t.totalMeme);n>10||e.prototype.triggerStream.call(this,t)},t}(Skill);window.ToyaSkill2=n,__reflect(n.prototype,"ToyaSkill2",[])},function(e,t){var n=function(e){function t(t,n){for(var r=e.call(this,t,n)||this,i=[],a=0,o=Liver.allLivers;a<o.length;a++){var s=o[a];s.tag&&s.tag.indexOf("loli")>=0&&i.push(s.ID)}return r.loliLivers=i,r}return __extends(t,e),t.prototype.triggerStream=function(t){for(var n=0,r=0,i=t.collaboMems;r<i.length;r++){var a=i[r];this.loliLivers.indexOf(a)>=0&&n++}0!=n&&e.prototype.triggerStream.call(this,t)},t}(Skill);window.ToyaSkill5=n,__reflect(n.prototype,"ToyaSkill5",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.triggerStream=function(e){e.collaboMems.length<2||(e.baseRate+=2,console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),this.triggered=!0)},t}(Skill);window.UmeoSkill2=n,__reflect(n.prototype,"UmeoSkill2",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.triggerBag=function(t){var n=Roll.random(this.mc).r,r=99999;switch(n){case RollResult.BIG_FAIL:r=4999;break;case RollResult.FAIL:r=9999}t.valueLock=r,e.prototype.triggerBag.call(this,t)},t}(Skill);window.UmeoSkill3=n,__reflect(n.prototype,"UmeoSkill3",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.shouldTrigger=function(e,t){return void 0===t&&(t=0),this.effect?this._cd>0?!1:this.triggered&&!this.always?!1:this.phrase.indexOf(e)<0?!1:!0:!1},t.prototype.triggerStream=function(e){var t=10;e.totalPop>=t||(this.mc.anti+=50,e.accidentBaseRate+=2,console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),this.triggered=!0)},t}(Skill);window.UmeoSkill4=n,__reflect(n.prototype,"UmeoSkill4",[])},function(e,t){var n=function(e){function t(t,n){return e.call(this,t,n)||this}return __extends(t,e),t.prototype.trigger=function(){for(var e=this.mc.netaBag.song,t=!1,n=0,r=e;n<r.length;n++){var i=r[n];i.usable||(t=!0,i.clearCD())}t&&(console.log("skill : ",this.name),this.dispatchEvent(new SkillEvent(this)),this.triggered=!0)},t}(Skill);window.UmeoSkill5=n,__reflect(n.prototype,"UmeoSkill5",[])},function(e,t){var n=function(){function e(){}return e.getRotation=function(e,t,n,r){var i=Math.atan((r-t+.1)/(n-e+.1)),a=i/(Math.PI/180);return e>n&&(a=-(180-a)),a},e.getSinCos=function(e,t,n,r){var i=egret.Point.distance(new egret.Point(e,t),new egret.Point(n,r)),a=(r-t+.01)/i,o=(n-e+.01)/i;return{sin:a,cos:o}},e.getDistance=function(e,t,n,r){return egret.Point.distance(new egret.Point(e,t),new egret.Point(n,r))},e.random=function(e,t){return Math.random()*(t-e)+e},e.getMc=function(e,t){void 0===t&&(t=-1);var n=RES.getRes(e+"_json"),r=RES.getRes(e+"_png"),i=new egret.MovieClipDataFactory(n,r),a=new egret.MovieClip(i.generateMovieClipData());return a},e.createBitmapByName=function(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t},e.loadImage=function(e,t,n,r){var i=new egret.ImageLoader;i.crossOrigin="anonymous",i.load(e),i.once(egret.Event.COMPLETE,n,t),i.once(egret.IOErrorEvent.IO_ERROR,r,t)},e.httpReq=function(e,t,n,r,i,a,o,s){"GET"==n&&(e=e+"?"+t);var c=new egret.HttpRequest;c.open(e,n),c.setRequestHeader("Accept","*/*"),s&&c.setRequestHeader("Authorization",s),c.setRequestHeader("Content-Type",o),"GET"==n?c.send():c.send(t),c.addEventListener(egret.Event.COMPLETE,i,r),null!=a&&(c.addEventListener(egret.IOErrorEvent.IO_ERROR,a,r),c.addEventListener(egret.HTTPStatusEvent.CLOSE,a,r))},e.Loaded=function(){window.parent.postMessage({isLoadComplete:!0,url:window.location.href},"*")},e.Curry=function(e){return function t(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.length>n.length?function(){return t.apply(null,n.concat([].slice.call(arguments)))}:e.apply(null,n)}},e}();window.GlobalMethod=n,__reflect(n.prototype,"GlobalMethod",[])},function(e,t){var n=function(){function e(){}return e.regist=function(){e.map.ticker=new r(function(){egret.ticker.pause()},function(){egret.ticker.resume()}),egret.lifecycle.onPause=this.onPause,egret.lifecycle.onResume=this.onResume},e.addFunc=function(t,n,i){e.map[t]=new r(n,i)},e.removeFunc=function(t){delete e.map[t]},e.onPause=function(){for(var t in e.map)e.map[t].onPause()},e.onResume=function(){for(var t in e.map)e.map[t].onResume()},e.map={},e}();window.LifecycleCallback=n,__reflect(n.prototype,"LifecycleCallback",[]);var r=function(){function e(e,t){this.onPause=e,this.onResume=t}return e}();window.LcyObj=r,__reflect(r.prototype,"LcyObj",[])},function(e,t){var n=function(){function e(e){this._arr=[],this._func=e}return e.prototype.getOne=function(){for(var e=null,t=0,n=this._arr;t<n.length;t++){var r=n[t];if(!r.activate){e=r;break}}return e||(e=this._func(),this._arr.push(e)),e.activate=!0,e},e.prototype.recycle=function(e){void 0===e&&(e=null);var t=e.target;t.activate=!1},e.prototype.dispose=function(){this._arr=null,this._func=null},e}();window.Pool=n,__reflect(n.prototype,"Pool",[])},function(e,t){var n=function(){function e(){var e=this;LifecycleCallback.addFunc("bgm",function(){e.pause()},function(){e.resume()}),this._bgs={},this._defaultVolume=.5}return e.prototype.play=function(e,t){void 0===t&&(t=!0),this._bgm&&this._bgmChannel.stop(),this._bgm=RES.getRes(e),this._bgm.type=egret.Sound.MUSIC;try{if(this._isPausing)return;this._bgmChannel=this._bgm.play(0,t?0:1),this._bgmChannel.volume=this._defaultVolume}catch(n){console.error(n)}},e.prototype.playBgs=function(e){var t;t=this._bgs[e]?this._bgs[e]:RES.getRes(e),t&&t.play(0,1)},e.prototype.resume=function(){this._isPausing=!1,this._bgm&&this._bgmChannel&&(this._bgmChannel=this._bgm.play(this._bgmPosition,1),this._bgmChannel.volume=this._defaultVolume,this._bgmChannel.addEventListener(egret.Event.SOUND_COMPLETE,this.onResumeOver,this))},e.prototype.onResumeOver=function(e){this._bgm&&this._bgmChannel&&(this._bgmChannel=this._bgm.play(0,0),this._bgmChannel.volume=this._defaultVolume)},e.prototype.pause=function(){this._isPausing=!0,this._bgm&&this._bgmChannel&&(this._bgmPosition=this._bgmChannel.position,this._bgmChannel.stop())},e.prototype.stop=function(){this._bgm&&this._bgmChannel&&(this._bgmChannel.stop(),this._bgmChannel=null,this._bgm=null)},Object.defineProperty(e,"instance",{get:function(){return e._ins||(e._ins=new e),e._ins},enumerable:!1,configurable:!0}),e}();window.SoundManager=n,__reflect(n.prototype,"SoundManager",[])}]);